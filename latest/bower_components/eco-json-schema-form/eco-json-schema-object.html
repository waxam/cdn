<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="../iron-flex-layout/iron-flex-layout-classes.html"><link rel="import" href="../app-localize-behavior/app-localize-behavior.html"><link rel="prefetch" href="../polymer/polymer-mini.html"><link rel="prefetch" href="../polymer/polymer-micro.html"><link rel="prefetch" href="../iron-ajax/iron-ajax.html"><link rel="prefetch" href="../iron-ajax/iron-request.html"><link rel="prefetch" href="../intl-messageformat/dist/intl-messageformat.min.js"><link rel="prefetch" href="../iron-icons/iron-icons.html"><link rel="prefetch" href="../iron-icon/iron-icon.html"><link rel="prefetch" href="../iron-meta/iron-meta.html"><link rel="prefetch" href="../iron-flex-layout/iron-flex-layout.html"><link rel="prefetch" href="../iron-iconset-svg/iron-iconset-svg.html"><link rel="prefetch" href="../iron-icons/editor-icons.html"><link rel="prefetch" href="../paper-icon-button/paper-icon-button.html"><link rel="prefetch" href="../paper-behaviors/paper-inky-focus-behavior.html"><link rel="prefetch" href="../iron-behaviors/iron-button-state.html"><link rel="prefetch" href="../iron-a11y-keys-behavior/iron-a11y-keys-behavior.html"><link rel="prefetch" href="../iron-behaviors/iron-control-state.html"><link rel="prefetch" href="../paper-behaviors/paper-ripple-behavior.html"><link rel="prefetch" href="../paper-ripple/paper-ripple.html"><link rel="prefetch" href="../paper-styles/default-theme.html"><link rel="prefetch" href="../paper-styles/color.html"><link rel="prefetch" href="../paper-tooltip/paper-tooltip.html"><link rel="prefetch" href="../paper-collapse-item/paper-collapse-item.html"><link rel="prefetch" href="../iron-collapse/iron-collapse.html"><link rel="prefetch" href="../iron-resizable-behavior/iron-resizable-behavior.html"><link rel="prefetch" href="../paper-item/paper-item-body.html"><link rel="prefetch" href="../paper-styles/typography.html"><link rel="prefetch" href="../font-roboto/roboto.html"><link rel="prefetch" href="../paper-styles/paper-styles.html"><link rel="prefetch" href="../paper-styles/shadow.html"><link rel="prefetch" href="../paper-collapse-item/simple-paper-item.html"><link rel="prefetch" href="../paper-item/paper-item-behavior.html"><link rel="prefetch" href="../paper-item/paper-item-shared-styles.html"><link rel="prefetch" href="../paper-collapse-item/paper-collapse-group.html"><link rel="prefetch" href="../paper-checkbox/paper-checkbox.html"><link rel="prefetch" href="../paper-behaviors/paper-checked-element-behavior.html"><link rel="prefetch" href="../iron-checked-element-behavior/iron-checked-element-behavior.html"><link rel="prefetch" href="../iron-validatable-behavior/iron-validatable-behavior.html"><link rel="prefetch" href="../iron-form-element-behavior/iron-form-element-behavior.html"><link rel="prefetch" href="../paper-dropdown-menu/paper-dropdown-menu.html"><link rel="prefetch" href="../paper-input/paper-input.html"><link rel="prefetch" href="../iron-input/iron-input.html"><link rel="prefetch" href="../iron-a11y-announcer/iron-a11y-announcer.html"><link rel="prefetch" href="../paper-input/paper-input-behavior.html"><link rel="prefetch" href="../paper-input/paper-input-char-counter.html"><link rel="prefetch" href="../paper-input/paper-input-addon-behavior.html"><link rel="prefetch" href="../paper-input/paper-input-container.html"><link rel="prefetch" href="../paper-input/paper-input-error.html"><link rel="prefetch" href="../paper-menu-button/paper-menu-button.html"><link rel="prefetch" href="../iron-dropdown/iron-dropdown.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-overlay-behavior.html"><link rel="prefetch" href="../iron-fit-behavior/iron-fit-behavior.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-overlay-manager.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-overlay-backdrop.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-scroll-manager.html"><link rel="prefetch" href="../iron-overlay-behavior/iron-focusables-helper.html"><link rel="prefetch" href="../neon-animation/neon-animation-runner-behavior.html"><link rel="prefetch" href="../neon-animation/neon-animatable-behavior.html"><link rel="prefetch" href="../iron-dropdown/iron-dropdown-scroll-manager.html"><link rel="prefetch" href="../neon-animation/animations/fade-in-animation.html"><link rel="prefetch" href="../neon-animation/neon-animation-behavior.html"><link rel="prefetch" href="../neon-animation/animations/fade-out-animation.html"><link rel="prefetch" href="../paper-menu-button/paper-menu-button-animations.html"><link rel="prefetch" href="../paper-dropdown-menu/paper-dropdown-menu-icons.html"><link rel="prefetch" href="../paper-dropdown-menu/paper-dropdown-menu-shared-styles.html"><link rel="prefetch" href="../paper-menu/paper-menu.html"><link rel="prefetch" href="../iron-menu-behavior/iron-menu-behavior.html"><link rel="prefetch" href="../iron-selector/iron-multi-selectable.html"><link rel="prefetch" href="../iron-selector/iron-selectable.html"><link rel="prefetch" href="../iron-selector/iron-selection.html"><link rel="prefetch" href="../paper-menu/paper-menu-shared-styles.html"><link rel="prefetch" href="../paper-item/paper-item.html"><link rel="prefetch" href="eco-json-schema-object.html"><link rel="prefetch" href="../paper-button/paper-button.html"><link rel="prefetch" href="../paper-behaviors/paper-button-behavior.html"><link rel="prefetch" href="../paper-styles/element-styles/paper-material-styles.html"><link rel="prefetch" href="../iron-icons/communication-icons.html"><link rel="prefetch" href="../geo-location/geo-location.html"><link rel="prefetch" href="../google-map/google-map.html"><link rel="prefetch" href="../google-apis/google-maps-api.html"><link rel="prefetch" href="../iron-jsonp-library/iron-jsonp-library.html"><link rel="prefetch" href="../iron-selector/iron-selector.html"><link rel="prefetch" href="../google-map/google-map-marker.html"></head><body><dom-module id="eco-json-schema-object"><link rel="import" href="./eco-json-schema-array.html"><link rel="import" href="./eco-json-schema-boolean.html"><link rel="import" href="./eco-json-schema-enum.html"><link rel="import" href="./eco-json-schema-file.html"><link rel="import" href="./eco-json-schema-geolocation.html"><link rel="import" href="./eco-json-schema-input.html"><template><style is="custom-style" include="iron-flex iron-flex-alignment">div.layout{height:auto;}#form{display:block;@apply (--eco-json-schema-object-form);@apply (--layout-vertical);@apply (--layout-wrap);}</style><template is="dom-if" if="{{!wizard}}"><div class="header" hidden$="[[!label]]">[[label]]</div></template><div class="layout vertical flex start-justified"><div id="form" class="layout horizontal flex start-justified"></div></div></template><script>Polymer({is:'eco-json-schema-object',behaviors:[Polymer.AppLocalizeBehavior],properties:{language:{value:'en'},resources:{value:function(){return{}}},schema:{type:Object,observer:'_schemaChanged'},label:{type:String},value:{type:Object,notify:!0,value:function(){return{}}},error:{type:Object,observer:'_errorChanged'},wizard:{type:Boolean,notify:!0}},detached:function(){this._clearForm()},_buildSchemaProperties:function(){var a=this;this._schemaProperties=Object.keys(this.schema.properties||[]).map(function(b){var c=a.schema.properties[b],d={property:b,label:c.title||b,schema:c,component:c.component||{}};if(d.component.valueProperty||(d.component.valueProperty='value'),d.component.slot||(d.component.slot=''),a._isSchemaEnum(c))d.component.name=d.component.name||'eco-json-schema-enum',babelHelpers.typeof(c.value)==='undefined'&&(c.value=''),d.value=c.value;else if(a._isSchemaGeo(c.type))d.component.name=d.component.name||'eco-json-schema-geolocation',babelHelpers.typeof(c.value)==='undefined'&&(c.value={}),d.value=c.value,d.map=!0,void 0!==c.zoom&&(d.zoom=c.zoom);else if(a._isSchemaBoolean(c.type))d.component.name=d.component.name||'eco-json-schema-boolean',babelHelpers.typeof(c.value)==='undefined'&&(c.value=!1),d.value=c.value;else if(a._isSchemaFile(c.type))d.component.name=d.component.name||'eco-json-schema-file',babelHelpers.typeof(c.value)==='undefined'&&(c.value={}),d.value=c.value;else if(a._isSchemaValue(c.type))d.component.name=d.component.name||'eco-json-schema-input',babelHelpers.typeof(c.value)==='undefined'&&(c.value=''),d.value=c.value;else if(a._isSchemaObject(c.type))d.component.name=d.component.name||'eco-json-schema-object',babelHelpers.typeof(c.value)==='undefined'&&(c.value={}),d.value=c.value;else if(a._isSchemaArray(c.type))d.component.name=d.component.name||'eco-json-schema-array',babelHelpers.typeof(c.value)==='undefined'&&(c.value=[]),d.value=c.value;else return console.error('Unknown property type %s',c.type);return d})},_schemaPropertyChanged:function(a,b){if(!(b.path&&/\.length$/.test(b.path))){var c=this,d=a.target.schemaProperty,e=['value',d.property];if(b.path&&/\.splices$/.test(b.path)){for(var f=b.path.split('.').slice(1,-1);f.length;)e.push(f.shift()),d.keyMap&&d.keyMap[e.join('.')]&&(e=d.keyMap[e.join('.')].split('.'));b.value.keySplices&&d.keyMap&&b.value.keySplices.forEach(function(a){a.removed.forEach(function(a){delete d.keyMap[e.concat([a]).join('.')]})}),b.value&&b.value.indexSplices.forEach(function(a){var b=[e.join('.'),a.index,a.removed.length];if(a.addedCount)for(var f=0,g=a.addedCount;f<g;f++)a.addedKeys&&a.addedKeys[f]&&(d.keyMap=d.keyMap||{},d.keyMap[e.concat([a.addedKeys[f]]).join('.')]=e.concat([f+a.index]).join('.')),b.push(c._deepClone(a.object[f+a.index]));c.splice.apply(c,b)})}else if(b.path){var f=b.path.split('.').slice(1),g=this.value;for(g.hasOwnProperty(d.property)||this.set('value.'+d.property,{});f.length;){var h=f.shift();e.push(h),d.keyMap&&d.keyMap[e.join('.')]&&(e=d.keyMap[e.join('.')].split('.'))}this.set(e.join('.'),this._deepClone(b.value))}else d.value=b.value,this.set(e,this._deepClone(b.value))}},_setValue:function(){var a=this,b={};this._schemaProperties.forEach(function(c){babelHelpers.typeof(c.value)!=='undefined'&&(b[c.property]=a._deepClone(c.value))}),this.value=b},_buildForm:function(){var a=this;this._schemaProperties.forEach(function(b){var c=a.create(b.component.name,{label:b.label,schema:b.schema,schemaProperty:b,language:this.language,resources:this.resources});for(var d in c.setAttribute('name',b.property),c.className='flex start-justified',c[b.component.valueProperty]=b.value,b.component.attributes)c.setAttribute(d,b.component.attributes[d]);for(var e in b.component.properties)c[e]=b.component.properties[e];if(a.listen(c,b.component.valueProperty.replace(/([A-Z])/g,'-$1').toLowerCase()+'-changed','_schemaPropertyChanged'),Polymer.dom(a.$.form).appendChild(c),''!=b.component.slot){var f=document.createElement('template');f.innerHTML=b.component.slot,Polymer.dom(c).appendChild(f.content)}})},_removePropertyEl:function(a){babelHelpers.typeof(a.schemaProperty)!=='undefined'&&this.unlisten(a,a.schemaProperty.component.valueProperty.replace(/([A-Z])/g,'-$1').toLowerCase()+'-changed','_schemaPropertyChanged'),a.schemaProperty=null,Polymer.dom(this.$.form).removeChild(a)},_clearForm:function(){for(var a=Polymer.dom(this.$.form);a.firstChild;)this._removePropertyEl(a.firstChild)},_schemaChanged:function(){this._clearForm(),this._buildSchemaProperties(),this._buildForm(),this._setValue()},_errorChanged:function(){var a=this;Polymer.dom(this.$.form).childNodes.forEach(function(b){var c=b.getAttribute('name');b.error=a.error&&a.error[c]?a.error[c]:null})},_deepClone:function(a){return JSON.parse(JSON.stringify(a))},_isSchemaValue:function(a){return this._isSchemaBoolean(a)||this._isSchemaNumber(a)||this._isSchemaString(a)||this._isSchemaFile(a)},_isSchemaFile:function(a){return Array.isArray(a)?-1!==a.indexOf('file'):'file'===a},_isSchemaBoolean:function(a){return Array.isArray(a)?-1!==a.indexOf('boolean'):'boolean'===a},_isSchemaEnum:function(a){return!!a.enum},_isSchemaNumber:function(a){return Array.isArray(a)?-1!==a.indexOf('number')||-1!==a.indexOf('integer'):'number'===a||'integer'===a},_isSchemaString:function(a){return Array.isArray(a)?-1!==a.indexOf('string'):'string'===a},_isSchemaGeo:function(a){return'geolocation'===a},_isSchemaObject:function(a){return'object'===a},_isSchemaArray:function(a){return'array'===a}});</script></dom-module></body></html>