'object'===('undefined'===typeof module?'undefined':babelHelpers.typeof(module))?ICAL=module.exports:'object'!==('undefined'===typeof ICAL?'undefined':babelHelpers.typeof(ICAL))&&(this.ICAL={}),ICAL.foldLength=75,ICAL.newLineChar='\r\n',ICAL.helpers={updateTimezones:function(e){var t,a,n,r,o,i;if(!e||'vcalendar'!==e.name)return e;for(t=e.getAllSubcomponents(),a=[],n={},o=0;o<t.length;o++)'vtimezone'===t[o].name?(i=t[o].getFirstProperty('tzid').getFirstValue(),n[i]=t[o]):a=a.concat(t[o].getAllProperties());for(r={},o=0;o<a.length;o++)(i=a[o].getParameter('tzid'))&&(r[i]=!0);for(o in n)n.hasOwnProperty(o)&&!r[o]&&e.removeSubcomponent(n[o]);for(o in r)r.hasOwnProperty(o)&&!n[o]&&ICAL.TimezoneService.has(o)&&e.addSubcomponent(ICAL.TimezoneService.get(o).component);return e},isStrictlyNaN:function(e){return'number'===typeof e&&isNaN(e)},strictParseInt:function(e){var t=parseInt(e,10);if(ICAL.helpers.isStrictlyNaN(t))throw new Error('Could not extract integer from "'+e+'"');return t},formatClassType:function(e,t){return'undefined'===typeof e?void 0:e instanceof t?e:new t(e)},unescapedIndexOf:function(e,t,a){for(;-1!==(a=e.indexOf(t,a));)if(0<a&&'\\'===e[a-1])a+=1;else return a;return-1},binsearchInsert:function(e,t,a){if(!e.length)return 0;for(var n,r,o=0,i=e.length-1;o<=i;)if(n=o+Math.floor((i-o)/2),r=a(t,e[n]),0>r)i=n-1;else if(0<r)o=n+1;else break;return 0>r?n:0<r?n+1:n},dumpn:function(){ICAL.debug&&(ICAL.helpers.dumpn='undefined'!==typeof console&&'log'in console?function(e){console.log(e)}:function(e){dump(e+'\n')},ICAL.helpers.dumpn(arguments[0]))},clone:function(e,t){if(!e||'object'!=('undefined'===typeof e?'undefined':babelHelpers.typeof(e)))return e;if(e instanceof Date)return new Date(e.getTime());if('clone'in e)return e.clone();if(Array.isArray(e)){for(var a=[],n=0;n<e.length;n++)a.push(t?ICAL.helpers.clone(e[n],!0):e[n]);return a}var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=t?ICAL.helpers.clone(e[o],!0):e[o]);return r},foldline:function(e){for(var t='',a=e||'';a.length;)t+=ICAL.newLineChar+' '+a.substr(0,ICAL.foldLength),a=a.substr(ICAL.foldLength);return t.substr(ICAL.newLineChar.length+1)},pad2:function(e){'string'!==typeof e&&('number'===typeof e&&(e=parseInt(e)),e=e+'');var t=e.length;return 0===t?'00':1===t?'0'+e:e},trunc:function(e){return 0>e?Math.ceil(e):Math.floor(e)},inherits:function(e,t,a){function n(){}n.prototype=e.prototype,t.prototype=new n,a&&ICAL.helpers.extend(a,t.prototype)},extend:function(e,t){for(var a in e){var n=Object.getOwnPropertyDescriptor(e,a);n&&!Object.getOwnPropertyDescriptor(t,a)&&Object.defineProperty(t,a,n)}return t}},ICAL.design=function(){'use strict';function e(e,t){var n={matches:/.*/,fromICAL:function(t,n){return a(t,e,n)},toICAL:function(e,a){var n=t;return a&&(n=new RegExp(n.source+'|'+a)),e.replace(n,function(e){return'\\'===e?'\\\\':';'===e?'\\;':','===e?'\\,':'\n'===e?'\\n':e})}};return n}function t(e){return'\\\\'===e?'\\':'\\;'===e?';':'\\,'===e?',':'\\n'===e||'\\N'===e?'\n':e}function a(e,a,n){return-1===e.indexOf('\\')?e:(n&&(a=new RegExp(a.source+'|\\\\'+n)),e.replace(a,t))}var n=/\\\\|\\;|\\,|\\[Nn]/g,r=/\\|;|,|\n/g,o=/\\\\|\\,|\\[Nn]/g,i=/\\|,|\n/g,s={defaultType:'text'},d={defaultType:'text',multiValue:','},u={defaultType:'text',structuredValue:';'},l={defaultType:'integer'},m={defaultType:'date-time',allowedTypes:['date-time','date']},c={defaultType:'date-time'},p={defaultType:'uri'},y={defaultType:'utc-offset'},h={defaultType:'recur'},T={defaultType:'date-and-or-time',allowedTypes:['date-time','date','text']},f={categories:d,url:p,version:s,uid:s},_={boolean:{values:['TRUE','FALSE'],fromICAL:function(e){return'TRUE'===e||'FALSE'!==e&&!1},toICAL:function(e){return e?'TRUE':'FALSE'}},float:{matches:/^[+-]?\d+\.\d+$/,fromICAL:function(e){var t=parseFloat(e);return ICAL.helpers.isStrictlyNaN(t)?0:t},toICAL:function(e){return e+''}},integer:{fromICAL:function(e){var t=parseInt(e);return ICAL.helpers.isStrictlyNaN(t)?0:t},toICAL:function(e){return e+''}},"utc-offset":{toICAL:function(e){return 7>e.length?e.substr(0,3)+e.substr(4,2):e.substr(0,3)+e.substr(4,2)+e.substr(7,2)},fromICAL:function(e){return 6>e.length?e.substr(0,3)+':'+e.substr(3,2):e.substr(0,3)+':'+e.substr(3,2)+':'+e.substr(5,2)},decorate:function(e){return ICAL.UtcOffset.fromString(e)},undecorate:function(e){return e.toString()}}},D={cutype:{values:['INDIVIDUAL','GROUP','RESOURCE','ROOM','UNKNOWN'],allowXName:!0,allowIanaToken:!0},"delegated-from":{valueType:'cal-address',multiValue:',',multiValueSeparateDQuote:!0},"delegated-to":{valueType:'cal-address',multiValue:',',multiValueSeparateDQuote:!0},encoding:{values:['8BIT','BASE64']},fbtype:{values:['FREE','BUSY','BUSY-UNAVAILABLE','BUSY-TENTATIVE'],allowXName:!0,allowIanaToken:!0},member:{valueType:'cal-address',multiValue:',',multiValueSeparateDQuote:!0},partstat:{values:['NEEDS-ACTION','ACCEPTED','DECLINED','TENTATIVE','DELEGATED','COMPLETED','IN-PROCESS'],allowXName:!0,allowIanaToken:!0},range:{values:['THISLANDFUTURE']},related:{values:['START','END']},reltype:{values:['PARENT','CHILD','SIBLING'],allowXName:!0,allowIanaToken:!0},role:{values:['REQ-PARTICIPANT','CHAIR','OPT-PARTICIPANT','NON-PARTICIPANT'],allowXName:!0,allowIanaToken:!0},rsvp:{values:['TRUE','FALSE']},"sent-by":{valueType:'cal-address'},tzid:{matches:/^\//},value:{values:['binary','boolean','cal-address','date','date-time','duration','float','integer','period','recur','text','time','uri','utc-offset'],allowXName:!0,allowIanaToken:!0}},g=ICAL.helpers.extend(_,{text:e(n,r),uri:{},binary:{decorate:function(e){return ICAL.Binary.fromString(e)},undecorate:function(e){return e.toString()}},"cal-address":{},date:{decorate:function(e,t){return ICAL.Time.fromDateString(e,t)},undecorate:function(e){return e.toString()},fromICAL:function(e){return e.substr(0,4)+'-'+e.substr(4,2)+'-'+e.substr(6,2)},toICAL:function(e){return 11<e.length?e:e.substr(0,4)+e.substr(5,2)+e.substr(8,2)}},"date-time":{fromICAL:function(e){var t=e.substr(0,4)+'-'+e.substr(4,2)+'-'+e.substr(6,2)+'T'+e.substr(9,2)+':'+e.substr(11,2)+':'+e.substr(13,2);return e[15]&&'Z'===e[15]&&(t+='Z'),t},toICAL:function(e){if(19>e.length)return e;var t=e.substr(0,4)+e.substr(5,2)+e.substr(8,5)+e.substr(14,2)+e.substr(17,2);return e[19]&&'Z'===e[19]&&(t+='Z'),t},decorate:function(e,t){return ICAL.Time.fromDateTimeString(e,t)},undecorate:function(e){return e.toString()}},duration:{decorate:function(e){return ICAL.Duration.fromString(e)},undecorate:function(e){return e.toString()}},period:{fromICAL:function(e){var t=e.split('/');return t[0]=g['date-time'].fromICAL(t[0]),ICAL.Duration.isValueString(t[1])||(t[1]=g['date-time'].fromICAL(t[1])),t},toICAL:function(e){return e[0]=g['date-time'].toICAL(e[0]),ICAL.Duration.isValueString(e[1])||(e[1]=g['date-time'].toICAL(e[1])),e.join('/')},decorate:function(e,t){return ICAL.Period.fromJSON(e,t)},undecorate:function(e){return e.toJSON()}},recur:{fromICAL:function(e){return ICAL.Recur._stringToData(e,!0)},toICAL:function(e){var t='';for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var n=e[a];'until'==a?10<n.length?n=g['date-time'].toICAL(n):n=g.date.toICAL(n):'wkst'==a?'number'===typeof n&&(n=ICAL.Recur.numericDayToIcalDay(n)):Array.isArray(n)&&(n=n.join(',')),t+=a.toUpperCase()+'='+n+';'}return t.substr(0,t.length-1)},decorate:function(e){return ICAL.Recur.fromData(e)},undecorate:function(e){return e.toJSON()}},time:{fromICAL:function(e){if(6>e.length)return e;var t=e.substr(0,2)+':'+e.substr(2,2)+':'+e.substr(4,2);return'Z'===e[6]&&(t+='Z'),t},toICAL:function(e){if(8>e.length)return e;var t=e.substr(0,2)+e.substr(3,2)+e.substr(6,2);return'Z'===e[8]&&(t+='Z'),t}}}),Y=ICAL.helpers.extend(f,{action:s,attach:{defaultType:'uri'},attendee:{defaultType:'cal-address'},calscale:s,class:s,comment:s,completed:c,contact:s,created:c,description:s,dtend:m,dtstamp:c,dtstart:m,due:m,duration:{defaultType:'duration'},exdate:{defaultType:'date-time',allowedTypes:['date-time','date'],multiValue:','},exrule:h,freebusy:{defaultType:'period',multiValue:','},geo:{defaultType:'float',structuredValue:';'},"last-modified":c,location:s,method:s,organizer:{defaultType:'cal-address'},"percent-complete":l,priority:l,prodid:s,"related-to":s,repeat:l,rdate:{defaultType:'date-time',allowedTypes:['date-time','date','period'],multiValue:',',detectType:function(e){return-1===e.indexOf('/')?-1===e.indexOf('T')?'date':'date-time':'period'}},"recurrence-id":m,resources:d,"request-status":u,rrule:h,sequence:l,status:s,summary:s,transp:s,trigger:{defaultType:'duration',allowedTypes:['duration','date-time']},tzoffsetfrom:y,tzoffsetto:y,tzurl:p,tzid:s,tzname:s}),O=ICAL.helpers.extend(_,{text:e(o,i),uri:e(o,i),date:{decorate:function(e){return ICAL.VCardTime.fromDateAndOrTimeString(e,'date')},undecorate:function(e){return e.toString()},fromICAL:function(e){return 8==e.length?g.date.fromICAL(e):'-'==e[0]&&6==e.length?e.substr(0,4)+'-'+e.substr(4):e},toICAL:function(e){return 10==e.length?g.date.toICAL(e):'-'==e[0]&&7==e.length?e.substr(0,4)+e.substr(5):e}},time:{decorate:function(e){return ICAL.VCardTime.fromDateAndOrTimeString('T'+e,'time')},undecorate:function(e){return e.toString()},fromICAL:function(e){var t=O.time._splitZone(e,!0),a=t[0],n=t[1];return 6==n.length?n=n.substr(0,2)+':'+n.substr(2,2)+':'+n.substr(4,2):4==n.length&&'-'!=n[0]?n=n.substr(0,2)+':'+n.substr(2,2):5==n.length&&(n=n.substr(0,3)+':'+n.substr(3,2)),5==a.length&&('-'==a[0]||'+'==a[0])&&(a=a.substr(0,3)+':'+a.substr(3)),n+a},toICAL:function(e){var t=O.time._splitZone(e),a=t[0],n=t[1];return 8==n.length?n=n.substr(0,2)+n.substr(3,2)+n.substr(6,2):5==n.length&&'-'!=n[0]?n=n.substr(0,2)+n.substr(3,2):6==n.length&&(n=n.substr(0,3)+n.substr(4,2)),6==a.length&&('-'==a[0]||'+'==a[0])&&(a=a.substr(0,3)+a.substr(4)),n+a},_splitZone:function(e,t){var a,n,r=e.length-1,o=e.length-(t?5:6),i=e[o];return'Z'==e[r]?(a=e[r],n=e.substr(0,r)):6<e.length&&('-'==i||'+'==i)?(a=e.substr(o),n=e.substr(0,o)):(a='',n=e),[a,n]}},"date-time":{decorate:function(e){return ICAL.VCardTime.fromDateAndOrTimeString(e,'date-time')},undecorate:function(e){return e.toString()},fromICAL:function(e){return O['date-and-or-time'].fromICAL(e)},toICAL:function(e){return O['date-and-or-time'].toICAL(e)}},"date-and-or-time":{decorate:function(e){return ICAL.VCardTime.fromDateAndOrTimeString(e,'date-and-or-time')},undecorate:function(e){return e.toString()},fromICAL:function(e){var t=e.split('T');return(t[0]?O.date.fromICAL(t[0]):'')+(t[1]?'T'+O.time.fromICAL(t[1]):'')},toICAL:function(e){var t=e.split('T');return O.date.toICAL(t[0])+(t[1]?'T'+O.time.toICAL(t[1]):'')}},timestamp:g['date-time'],"language-tag":{matches:/^[a-zA-Z0-9-]+$/}}),b=ICAL.helpers.extend(f,{adr:{defaultType:'text',structuredValue:';',multiValue:','},anniversary:T,bday:T,caladruri:p,caluri:p,clientpidmap:u,email:s,fburl:p,fn:s,gender:u,geo:p,impp:p,key:p,kind:s,lang:{defaultType:'language-tag'},logo:p,member:p,n:{defaultType:'text',structuredValue:';',multiValue:','},nickname:d,note:s,org:{defaultType:'text',structuredValue:';'},photo:p,related:p,rev:{defaultType:'timestamp'},role:s,sound:p,source:p,tel:{defaultType:'uri',allowedTypes:['uri','text']},title:s,tz:{defaultType:'text',allowedTypes:['text','utc-offset','uri']},xml:s}),A=ICAL.helpers.extend(_,{binary:g.binary,date:O.date,"date-time":O['date-time'],"phone-number":{},uri:g.uri,text:g.text,time:g.time,vcard:g.text,"utc-offset":{toICAL:function(e){return e.substr(0,7)},fromICAL:function(e){return e.substr(0,7)},decorate:function(e){return ICAL.UtcOffset.fromString(e)},undecorate:function(e){return e.toString()}}}),N=ICAL.helpers.extend(f,{fn:s,n:{defaultType:'text',structuredValue:';',multiValue:','},nickname:d,photo:{defaultType:'binary',allowedTypes:['binary','uri']},bday:{defaultType:'date-time',allowedTypes:['date-time','date'],detectType:function(e){return-1===e.indexOf('T')?'date':'date-time'}},adr:{defaultType:'text',structuredValue:';',multiValue:','},label:s,tel:{defaultType:'phone-number'},email:s,mailer:s,tz:{defaultType:'utc-offset',allowedTypes:['utc-offset','text']},geo:{defaultType:'float',structuredValue:';'},title:s,role:s,logo:{defaultType:'binary',allowedTypes:['binary','uri']},agent:{defaultType:'vcard',allowedTypes:['vcard','text','uri']},org:u,note:d,prodid:s,rev:{defaultType:'date-time',allowedTypes:['date-time','date'],detectType:function(e){return-1===e.indexOf('T')?'date':'date-time'}},"sort-string":s,sound:{defaultType:'binary',allowedTypes:['binary','uri']},class:s,key:{defaultType:'binary',allowedTypes:['binary','text']}}),E={value:g,param:D,property:Y},I={value:O,param:{type:{valueType:'text',multiValue:','},value:{values:['text','uri','date','time','date-time','date-and-or-time','timestamp','boolean','integer','float','utc-offset','language-tag'],allowXName:!0,allowIanaToken:!0}},property:b},C={value:A,param:{type:{valueType:'text',multiValue:','},value:{values:['text','uri','date','date-time','phone-number','time','boolean','integer','float','utc-offset','vcard','binary'],allowXName:!0,allowIanaToken:!0}},property:N},x={defaultSet:E,defaultType:'unknown',components:{vcard:I,vcard3:C,vevent:E,vtodo:E,vjournal:E,valarm:E,vtimezone:E,daylight:E,standard:E},icalendar:E,vcard:I,vcard3:C,getDesignSet:function(e){var t=e&&e in x.components;return t?x.components[e]:x.defaultSet}};return x}(),ICAL.stringify=function(){'use strict';function e(a){'string'==typeof a[0]&&(a=[a]);for(var n=0,r=a.length,o='';n<r;n++)o+=e.component(a[n])+t;return o}var t='\r\n',a='unknown',n=ICAL.design,r=ICAL.helpers;e.component=function(a,r){var o=a[0].toUpperCase(),i='BEGIN:'+o+t,s=a[1],d=0,u=s.length,l=a[0];for('vcard'===l&&0<a[1].length&&('version'!==a[1][0][0]||'4.0'!==a[1][0][3])&&(l='vcard3'),r=r||n.getDesignSet(l);d<u;d++)i+=e.property(s[d],r)+t;for(var m=a[2]||[],c=0,p=m.length;c<p;c++)i+=e.component(m[c],r)+t;return i+='END:'+o,i},e.property=function(t,r,o){var i,s=t[0].toUpperCase(),d=t[0],u=t[1],l=s;for(i in u){var m=u[i];if(u.hasOwnProperty(i)){var c=i in r.param&&r.param[i].multiValue;c&&Array.isArray(m)?(r.param[i].multiValueSeparateDQuote&&(c='"'+c+'"'),m=m.map(e._rfc6868Unescape),m=e.multiValue(m,c,'unknown',null,r)):m=e._rfc6868Unescape(m),l+=';'+i.toUpperCase(),l+='='+e.propertyValue(m)}}if(3===t.length)return l+':';var p=t[2];r||(r=n.defaultSet);var y,c=!1,h=!1,T=!1;return d in r.property?(y=r.property[d],'multiValue'in y&&(c=y.multiValue),'structuredValue'in y&&Array.isArray(t[3])&&(h=y.structuredValue),'defaultType'in y?p===y.defaultType&&(T=!0):p===a&&(T=!0)):p===a&&(T=!0),T||(l+=';VALUE='+p.toUpperCase()),l+=':',l+=c&&h?e.multiValue(t[3],h,p,c,r,h):c?e.multiValue(t.slice(3),c,p,null,r,!1):h?e.multiValue(t[3],h,p,null,r,h):e.value(t[3],p,r,!1),o?l:ICAL.helpers.foldline(l)},e.propertyValue=function(e){return-1===r.unescapedIndexOf(e,',')&&-1===r.unescapedIndexOf(e,':')&&-1===r.unescapedIndexOf(e,';')?e:'"'+e+'"'},e.multiValue=function(t,a,n,r,o,s){for(var d='',u=t.length,l=0;l<u;l++)d+=r&&Array.isArray(t[l])?e.multiValue(t[l],r,n,null,o,s):e.value(t[l],n,o,s),l!==u-1&&(d+=a);return d},e.value=function(e,t,a,n){return t in a.value&&'toICAL'in a.value[t]?a.value[t].toICAL(e,n):e},e._rfc6868Unescape=function(e){return e.replace(/[\n^"]/g,function(e){return o[e]})};var o={'"':'^\'',"\n":'^n',"^":'^^'};return e}(),ICAL.parse=function(){'use strict';function e(e){this.message=e,this.name='ParserError';try{throw new Error}catch(a){if(a.stack){var t=a.stack.split('\n');t.shift(),this.stack=t.join('\n')}}}function t(a){var n={},r=n.component=[];if(n.stack=[r],t._eachLine(a,function(e,a){t._handleContentLine(a,n)}),1<n.stack.length)throw new e('invalid ical body. component began but did not end');return n=null,1==r.length?r[0]:r}var a=/[^ \t]/,n=':',r=';',o=ICAL.design,i=ICAL.helpers;e.prototype=Error.prototype,t.property=function(e,a){var n={component:[[],[]],designSet:a||o.defaultSet};return t._handleContentLine(e,n),n.component[1][0]},t.component=function(e){return t(e)},t.ParserError=e,t._handleContentLine=function(a,i){var s,d,u,l,m=a.indexOf(n),c=a.indexOf(r),p={};-1!==c&&-1!==m&&c>m&&(c=-1);var y;if(-1!==c){if(u=a.substring(0,c).toLowerCase(),y=t._parseParameters(a.substring(c),0,i.designSet),-1==y[2])throw new e('Invalid parameters in \''+a+'\'');if(p=y[0],s=y[1].length+y[2]+c,-1!==(d=a.substring(s).indexOf(n)))l=a.substring(s+d+1);else throw new e('Missing parameter value in \''+a+'\'')}else if(-1!==m){if(u=a.substring(0,m).toLowerCase(),l=a.substring(m+1),'begin'===u){var h=[l.toLowerCase(),[],[]];return 1===i.stack.length?i.component.push(h):i.component[2].push(h),i.stack.push(i.component),i.component=h,void(i.designSet||(i.designSet=o.getDesignSet(i.component[0])))}if('end'===u)return void(i.component=i.stack.pop())}else throw new e('invalid line (no token ";" or ":") "'+a+'"');var T,f,_=!1,D=!1;u in i.designSet.property&&(f=i.designSet.property[u],'multiValue'in f&&(_=f.multiValue),'structuredValue'in f&&(D=f.structuredValue),l&&'detectType'in f&&(T=f.detectType(l))),T||('value'in p?T=p.value.toLowerCase():f?T=f.defaultType:T='unknown'),delete p.value;var g;_&&D?(l=t._parseMultiValue(l,D,T,[],_,i.designSet,D),g=[u,p,T,l]):_?(g=[u,p,T],t._parseMultiValue(l,_,T,g,null,i.designSet,!1)):D?(l=t._parseMultiValue(l,D,T,[],null,i.designSet,D),g=[u,p,T,l]):(l=t._parseValue(l,T,i.designSet,!1),g=[u,p,T,l]),'vcard'!==i.component[0]||0!==i.component[1].length||'version'===u&&'4.0'===l||(i.designSet=o.getDesignSet('vcard3')),i.component[1].push(g)},t._parseValue=function(e,t,a,n){return t in a.value&&'fromICAL'in a.value[t]?a.value[t].fromICAL(e,n):e},t._parseParameters=function(a,o,s){for(var d,u,l,m,c,p,y=o,h=0,T={},f=-1;!1!==h&&-1!==(h=i.unescapedIndexOf(a,'=',h+1));){if(d=a.substr(y+1,h-y-1),0==d.length)throw new e('Empty parameter name in \''+a+'\'');u=d.toLowerCase(),m=u in s.param&&s.param[u].valueType?s.param[u].valueType:'text',u in s.param&&(c=s.param[u].multiValue,s.param[u].multiValueSeparateDQuote&&(p=t._rfc6868Escape('"'+c+'"')));var _=a[h+1];if('"'===_){if(f=h+2,h=i.unescapedIndexOf(a,'"',f),c&&-1!=h)for(var D=!0;D;)a[h+1]==c&&'"'==a[h+2]?h=i.unescapedIndexOf(a,'"',h+3):D=!1;if(-1===h)throw new e('invalid line (no matching double quote) "'+a+'"');l=a.substr(f,h-f),y=i.unescapedIndexOf(a,r,h),-1===y&&(h=!1)}else{f=h+1;var g=i.unescapedIndexOf(a,r,f),Y=i.unescapedIndexOf(a,n,f);-1!==Y&&g>Y?(g=Y,h=!1):-1===g?(g=-1===Y?a.length:Y,h=!1):(y=g,h=g),l=a.substr(f,g-f)}if(l=t._rfc6868Escape(l),c){var O=p||c;T[u]=t._parseMultiValue(l,O,m,[],null,s)}else T[u]=t._parseValue(l,m,s)}return[T,l,f]},t._rfc6868Escape=function(e){return e.replace(/\^['n^]/g,function(e){return s[e]})};var s={"^'":'"',"^n":'\n',"^^":'^'};return t._parseMultiValue=function(e,a,n,r,o,s,d){var u,l=0,m=0;if(0===a.length)return e;for(;-1!==(l=i.unescapedIndexOf(e,a,m));)u=e.substr(m,l-m),u=o?t._parseMultiValue(u,o,n,[],null,s,d):t._parseValue(u,n,s,d),r.push(u),m=l+a.length;return u=e.substr(m),u=o?t._parseMultiValue(u,o,n,[],null,s,d):t._parseValue(u,n,s,d),r.push(u),1==r.length?r[0]:r},t._eachLine=function(e,t){var n,r,o,i=e.length,s=e.search(a),d=s;do d=e.indexOf('\n',s)+1,o=1<d&&'\r'===e[d-2]?2:1,0===d&&(d=i,o=0),r=e[s],' '===r||'\t'===r?n+=e.substr(s+1,d-s-(o+1)):(n&&t(null,n),n=e.substr(s,d-s-o)),s=d;while(d!==i);n=n.trim(),n.length&&t(null,n)},t}(),ICAL.Component=function(){'use strict';function e(e,t){'string'===typeof e&&(e=[e,[],[]]),this.jCal=e,this.parent=t||null}var t=1,a=2,n=0;return e.prototype={_hydratedPropertyCount:0,_hydratedComponentCount:0,get name(){return this.jCal[n]},get _designSet(){var e=this.parent&&this.parent._designSet;return e||ICAL.design.getDesignSet(this.name)},_hydrateComponent:function(t){if(this._components||(this._components=[],this._hydratedComponentCount=0),this._components[t])return this._components[t];var n=new e(this.jCal[a][t],this);return this._hydratedComponentCount++,this._components[t]=n},_hydrateProperty:function(e){if(this._properties||(this._properties=[],this._hydratedPropertyCount=0),this._properties[e])return this._properties[e];var a=new ICAL.Property(this.jCal[t][e],this);return this._hydratedPropertyCount++,this._properties[e]=a},getFirstSubcomponent:function(e){if(e){for(var t=0,r=this.jCal[a],o=r.length;t<o;t++)if(r[t][n]===e){var i=this._hydrateComponent(t);return i}}else if(this.jCal[a].length)return this._hydrateComponent(0);return null},getAllSubcomponents:function(e){var t=this.jCal[a].length,r=0;if(e){for(var o=this.jCal[a],i=[];r<t;r++)e===o[r][n]&&i.push(this._hydrateComponent(r));return i}if(!this._components||this._hydratedComponentCount!==t)for(;r<t;r++)this._hydrateComponent(r);return this._components||[]},hasProperty:function(e){for(var a=this.jCal[t],r=a.length,o=0;o<r;o++)if(a[o][n]===e)return!0;return!1},getFirstProperty:function(e){if(e){for(var a=0,r=this.jCal[t],o=r.length;a<o;a++)if(r[a][n]===e){var i=this._hydrateProperty(a);return i}}else if(this.jCal[t].length)return this._hydrateProperty(0);return null},getFirstPropertyValue:function(e){var t=this.getFirstProperty(e);return t?t.getFirstValue():null},getAllProperties:function(e){var a=this.jCal[t].length,r=0;if(e){for(var o=this.jCal[t],i=[];r<a;r++)e===o[r][n]&&i.push(this._hydrateProperty(r));return i}if(!this._properties||this._hydratedPropertyCount!==a)for(;r<a;r++)this._hydrateProperty(r);return this._properties||[]},_removeObjectByIndex:function(e,t,a){if(t=t||[],t[a]){var n=t[a];'parent'in n&&(n.parent=null)}t.splice(a,1),this.jCal[e].splice(a,1)},_removeObject:function(e,t,a){var r=0,o=this.jCal[e],i=o.length,s=this[t];if('string'===typeof a){for(;r<i;r++)if(o[r][n]===a)return this._removeObjectByIndex(e,s,r),!0;}else if(s)for(;r<i;r++)if(s[r]&&s[r]===a)return this._removeObjectByIndex(e,s,r),!0;return!1},_removeAllObjects:function(e,t,a){for(var r=this[t],o=this.jCal[e],s=o.length-1;0<=s;s--)a&&o[s][n]!==a||this._removeObjectByIndex(e,r,s)},addSubcomponent:function(e){this._components||(this._components=[],this._hydratedComponentCount=0),e.parent&&e.parent.removeSubcomponent(e);var t=this.jCal[a].push(e.jCal);return this._components[t-1]=e,this._hydratedComponentCount++,e.parent=this,e},removeSubcomponent:function(e){var t=this._removeObject(a,'_components',e);return t&&this._hydratedComponentCount--,t},removeAllSubcomponents:function(e){var t=this._removeAllObjects(a,'_components',e);return this._hydratedComponentCount=0,t},addProperty:function(e){if(!(e instanceof ICAL.Property))throw new TypeError('must instance of ICAL.Property');this._properties||(this._properties=[],this._hydratedPropertyCount=0),e.parent&&e.parent.removeProperty(e);var a=this.jCal[t].push(e.jCal);return this._properties[a-1]=e,this._hydratedPropertyCount++,e.parent=this,e},addPropertyWithValue:function(e,t){var a=new ICAL.Property(e);return a.setValue(t),this.addProperty(a),a},updatePropertyWithValue:function(e,t){var a=this.getFirstProperty(e);return a?a.setValue(t):a=this.addPropertyWithValue(e,t),a},removeProperty:function(e){var a=this._removeObject(t,'_properties',e);return a&&this._hydratedPropertyCount--,a},removeAllProperties:function(e){var a=this._removeAllObjects(t,'_properties',e);return this._hydratedPropertyCount=0,a},toJSON:function(){return this.jCal},toString:function(){return ICAL.stringify.component(this.jCal,this._designSet)}},e.fromString=function(t){return new e(ICAL.parse.component(t))},e}(),ICAL.Property=function(){'use strict';function e(e,t){this._parent=t||null,'string'===typeof e?(this.jCal=[e,{},o.defaultType],this.jCal[n]=this.getDefaultType()):this.jCal=e,this._updateType()}var t=0,a=1,n=2,r=3,o=ICAL.design;return e.prototype={get type(){return this.jCal[n]},get name(){return this.jCal[t]},get parent(){return this._parent},set parent(e){var t=!this._parent||e&&e._designSet!=this._parent._designSet;return this._parent=e,this.type==o.defaultType&&t&&(this.jCal[n]=this.getDefaultType(),this._updateType()),e},get _designSet(){return this.parent?this.parent._designSet:o.defaultSet},_updateType:function(){var e=this._designSet;if(this.type in e.value){e.value[this.type];this.isDecorated=!!('decorate'in e.value[this.type]),this.name in e.property&&(this.isMultiValue='multiValue'in e.property[this.name],this.isStructuredValue='structuredValue'in e.property[this.name])}},_hydrateValue:function(e){return this._values&&this._values[e]?this._values[e]:this.jCal.length<=r+e?null:this.isDecorated?(this._values||(this._values=[]),this._values[e]=this._decorate(this.jCal[r+e])):this.jCal[r+e]},_decorate:function(e){return this._designSet.value[this.type].decorate(e,this)},_undecorate:function(e){return this._designSet.value[this.type].undecorate(e,this)},_setDecoratedValue:function(e,t){this._values||(this._values=[]),'object'===('undefined'===typeof e?'undefined':babelHelpers.typeof(e))&&'icaltype'in e?(this.jCal[r+t]=this._undecorate(e),this._values[t]=e):(this.jCal[r+t]=e,this._values[t]=this._decorate(e))},getParameter:function(e){return e in this.jCal[a]?this.jCal[a][e]:void 0},setParameter:function(e,t){var n=e.toLowerCase();'string'===typeof t&&n in this._designSet.param&&'multiValue'in this._designSet.param[n]&&(t=[t]),this.jCal[a][e]=t},removeParameter:function(e){delete this.jCal[a][e]},getDefaultType:function(){var e=this.jCal[t],a=this._designSet;if(e in a.property){var n=a.property[e];if('defaultType'in n)return n.defaultType}return o.defaultType},resetType:function(e){this.removeAllValues(),this.jCal[n]=e,this._updateType()},getFirstValue:function(){return this._hydrateValue(0)},getValues:function(){var e=this.jCal.length-r;if(1>e)return[];for(var t=0,a=[];t<e;t++)a[t]=this._hydrateValue(t);return a},removeAllValues:function(){this._values&&(this._values.length=0),this.jCal.length=3},setValues:function(e){if(!this.isMultiValue)throw new Error(this.name+': does not not support mulitValue.\noverride isMultiValue');var t=e.length,a=0;if(this.removeAllValues(),0<t&&'object'===babelHelpers.typeof(e[0])&&'icaltype'in e[0]&&this.resetType(e[0].icaltype),this.isDecorated)for(;a<t;a++)this._setDecoratedValue(e[a],a);else for(;a<t;a++)this.jCal[r+a]=e[a]},setValue:function(e){this.removeAllValues(),'object'===('undefined'===typeof e?'undefined':babelHelpers.typeof(e))&&'icaltype'in e&&this.resetType(e.icaltype),this.isDecorated?this._setDecoratedValue(e,0):this.jCal[r]=e},toJSON:function(){return this.jCal},toICALString:function(){return ICAL.stringify.property(this.jCal,this._designSet,!0)}},e.fromString=function(t,a){return new e(ICAL.parse.property(t,a))},e}(),ICAL.UtcOffset=function(){function e(e){this.fromData(e)}return e.prototype={hours:0,minutes:0,factor:1,icaltype:'utc-offset',clone:function(){return ICAL.UtcOffset.fromSeconds(this.toSeconds())},fromData:function(e){if(e)for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);this._normalize()},fromSeconds:function(e){var t=Math.abs(e);return this.factor=0>e?-1:1,this.hours=ICAL.helpers.trunc(t/3600),t-=3600*this.hours,this.minutes=ICAL.helpers.trunc(t/60),this},toSeconds:function(){return this.factor*(60*this.minutes+3600*this.hours)},compare:function(e){var t=this.toSeconds(),a=e.toSeconds();return(t>a)-(a>t)},_normalize:function(){for(var e=this.toSeconds(),t=this.factor;-43200>e;)e+=97200;for(;50400<e;)e-=97200;this.fromSeconds(e),0==e&&(this.factor=t)},toICALString:function(){return ICAL.design.icalendar.value['utc-offset'].toICAL(this.toString())},toString:function(){return(1==this.factor?'+':'-')+ICAL.helpers.pad2(this.hours)+':'+ICAL.helpers.pad2(this.minutes)}},e.fromString=function(e){var t={factor:'+'===e[0]?1:-1,hours:ICAL.helpers.strictParseInt(e.substr(1,2)),minutes:ICAL.helpers.strictParseInt(e.substr(4,2))};return new ICAL.UtcOffset(t)},e.fromSeconds=function(t){var a=new e;return a.fromSeconds(t),a},e}(),ICAL.Binary=function(){function e(e){this.value=e}return e.prototype={icaltype:'binary',decodeValue:function(){return this._b64_decode(this.value)},setEncodedValue:function(e){this.value=this._b64_encode(e)},_b64_encode:function(e){var t,a,n,o,s,d,u,l,m='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',c=0,i=0,p='',y=[];if(!e)return e;do t=e.charCodeAt(c++),a=e.charCodeAt(c++),n=e.charCodeAt(c++),l=t<<16|a<<8|n,o=63&l>>18,s=63&l>>12,d=63&l>>6,u=63&l,y[i++]=m.charAt(o)+m.charAt(s)+m.charAt(d)+m.charAt(u);while(c<e.length);p=y.join('');var h=e.length%3;return(h?p.slice(0,h-3):p)+'==='.slice(h||3)},_b64_decode:function(e){var t,a,n,r,o,s,d,u,l=String.fromCharCode,m='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',c=0,i=0,p='',y=[];if(!e)return e;e+='';do r=m.indexOf(e.charAt(c++)),o=m.indexOf(e.charAt(c++)),s=m.indexOf(e.charAt(c++)),d=m.indexOf(e.charAt(c++)),u=r<<18|o<<12|s<<6|d,t=255&u>>16,a=255&u>>8,n=255&u,y[i++]=64==s?l(t):64==d?l(t,a):l(t,a,n);while(c<e.length);return p=y.join(''),p},toString:function(){return this.value}},e.fromString=function(t){return new e(t)},e}(),function(){ICAL.Period=function(e){if(this.wrappedJSObject=this,e&&'start'in e){if(e.start&&!(e.start instanceof ICAL.Time))throw new TypeError('.start must be an instance of ICAL.Time');this.start=e.start}if(e&&e.end&&e.duration)throw new Error('cannot accept both end and duration');if(e&&'end'in e){if(e.end&&!(e.end instanceof ICAL.Time))throw new TypeError('.end must be an instance of ICAL.Time');this.end=e.end}if(e&&'duration'in e){if(e.duration&&!(e.duration instanceof ICAL.Duration))throw new TypeError('.duration must be an instance of ICAL.Duration');this.duration=e.duration}},ICAL.Period.prototype={start:null,end:null,duration:null,icalclass:'icalperiod',icaltype:'period',clone:function(){return ICAL.Period.fromData({start:this.start?this.start.clone():null,end:this.end?this.end.clone():null,duration:this.duration?this.duration.clone():null})},getDuration:function(){return this.duration?this.duration:this.end.subtractDate(this.start)},getEnd:function(){if(this.end)return this.end;var e=this.start.clone();return e.addDuration(this.duration),e},toString:function(){return this.start+'/'+(this.end||this.duration)},toJSON:function(){return[this.start.toString(),(this.end||this.duration).toString()]},toICALString:function(){return this.start.toICALString()+'/'+(this.end||this.duration).toICALString()}},ICAL.Period.fromString=function(e,t){var a=e.split('/');if(2!==a.length)throw new Error('Invalid string value: "'+e+'" must contain a "/" char.');var n={start:ICAL.Time.fromDateTimeString(a[0],t)},r=a[1];return ICAL.Duration.isValueString(r)?n.duration=ICAL.Duration.fromString(r):n.end=ICAL.Time.fromDateTimeString(r,t),new ICAL.Period(n)},ICAL.Period.fromData=function(e){return new ICAL.Period(e)},ICAL.Period.fromJSON=function(e,t){return ICAL.Duration.isValueString(e[1])?ICAL.Period.fromData({start:ICAL.Time.fromDateTimeString(e[0],t),duration:ICAL.Duration.fromString(e[1])}):ICAL.Period.fromData({start:ICAL.Time.fromDateTimeString(e[0],t),end:ICAL.Time.fromDateTimeString(e[1],t)})}}(),function(){function e(e,t,a){var n;switch(e){case'P':a.isNegative=t&&'-'===t;break;case'D':n='days';break;case'W':n='weeks';break;case'H':n='hours';break;case'M':n='minutes';break;case'S':n='seconds';break;default:return 0;}if(n){if(!t&&0!==t)throw new Error('invalid duration value: Missing number before "'+e+'"');var r=parseInt(t,10);if(ICAL.helpers.isStrictlyNaN(r))throw new Error('invalid duration value: Invalid number "'+t+'" before "'+e+'"');a[n]=r}return 1}var t=/([PDWHMTS]{1,1})/;ICAL.Duration=function(e){this.wrappedJSObject=this,this.fromData(e)},ICAL.Duration.prototype={weeks:0,days:0,hours:0,minutes:0,seconds:0,isNegative:!1,icalclass:'icalduration',icaltype:'duration',clone:function(){return ICAL.Duration.fromData(this)},toSeconds:function(){var e=this.seconds+60*this.minutes+3600*this.hours+86400*this.days+604800*this.weeks;return this.isNegative?-e:e},fromSeconds:function(e){var t=Math.abs(e);return this.isNegative=0>e,this.days=ICAL.helpers.trunc(t/86400),0==this.days%7?(this.weeks=this.days/7,this.days=0):this.weeks=0,t-=86400*(this.days+7*this.weeks),this.hours=ICAL.helpers.trunc(t/3600),t-=3600*this.hours,this.minutes=ICAL.helpers.trunc(t/60),t-=60*this.minutes,this.seconds=t,this},fromData:function(e){var t=['weeks','days','hours','minutes','seconds','isNegative'];for(var a in t)if(t.hasOwnProperty(a)){var n=t[a];this[n]=e&&n in e?e[n]:0}},reset:function(){this.isNegative=!1,this.weeks=0,this.days=0,this.hours=0,this.minutes=0,this.seconds=0},compare:function(e){var t=this.toSeconds(),a=e.toSeconds();return(t>a)-(t<a)},normalize:function(){this.fromSeconds(this.toSeconds())},toString:function(){if(0==this.toSeconds())return'PT0S';var e='';return this.isNegative&&(e+='-'),e+='P',this.weeks&&(e+=this.weeks+'W'),this.days&&(e+=this.days+'D'),(this.hours||this.minutes||this.seconds)&&(e+='T',this.hours&&(e+=this.hours+'H'),this.minutes&&(e+=this.minutes+'M'),this.seconds&&(e+=this.seconds+'S')),e},toICALString:function(){return this.toString()}},ICAL.Duration.fromSeconds=function(e){return new ICAL.Duration().fromSeconds(e)},ICAL.Duration.isValueString=function(e){return'P'===e[0]||'P'===e[1]},ICAL.Duration.fromString=function(a){for(var n=0,r=Object.create(null),o=0;-1!==(n=a.search(t));){var i=a[n],s=a.substr(0,n);a=a.substr(n+1),o+=e(i,s,r)}if(2>o)throw new Error('invalid duration value: Not enough duration components in "'+a+'"');return new ICAL.Duration(r)},ICAL.Duration.fromData=function(e){return new ICAL.Duration(e)}}(),function(){var e=['tzid','location','tznames','latitude','longitude'];ICAL.Timezone=function(e){this.wrappedJSObject=this,this.fromData(e)},ICAL.Timezone.prototype={tzid:'',location:'',tznames:'',latitude:0,longitude:0,component:null,expandedUntilYear:0,icalclass:'icaltimezone',fromData:function(t){if(this.expandedUntilYear=0,this.changes=[],t instanceof ICAL.Component)this.component=t;else{if(t&&'component'in t)if('string'==typeof t.component){var a=ICAL.parse(t.component);this.component=new ICAL.Component(a)}else this.component=t.component instanceof ICAL.Component?t.component:null;for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];t&&r in t&&(this[r]=t[r])}}return this.component instanceof ICAL.Component&&!this.tzid&&(this.tzid=this.component.getFirstPropertyValue('tzid')),this},utcOffset:function(e){if(this==ICAL.Timezone.utcTimezone||this==ICAL.Timezone.localTimezone)return 0;if(this._ensureCoverage(e.year),!this.changes.length)return 0;for(var t,a={year:e.year,month:e.month,day:e.day,hour:e.hour,minute:e.minute,second:e.second},n=this._findNearbyChange(a),r=-1,o=1;;){t=ICAL.helpers.clone(this.changes[n],!0),t.utcOffset<t.prevUtcOffset?ICAL.Timezone.adjust_change(t,0,0,0,t.utcOffset):ICAL.Timezone.adjust_change(t,0,0,0,t.prevUtcOffset);var i=ICAL.Timezone._compare_change_fn(a,t);if(0<=i?r=n:o=-1,-1==o&&-1!=r)break;if(n+=o,0>n)return 0;if(n>=this.changes.length)break}var s=this.changes[r],d=s.utcOffset-s.prevUtcOffset;if(0>d&&0<r){var u=ICAL.helpers.clone(s,!0);if(ICAL.Timezone.adjust_change(u,0,0,0,u.prevUtcOffset),0>ICAL.Timezone._compare_change_fn(a,u)){var l=this.changes[r-1],m=!1;s.is_daylight!=m&&l.is_daylight==m&&(s=l)}}return s.utcOffset},_findNearbyChange:function(e){var t=ICAL.helpers.binsearchInsert(this.changes,e,ICAL.Timezone._compare_change_fn);return t>=this.changes.length?this.changes.length-1:t},_ensureCoverage:function(e){if(-1==ICAL.Timezone._minimumExpansionYear){var t=ICAL.Time.now();ICAL.Timezone._minimumExpansionYear=t.year}var a=e;if(a<ICAL.Timezone._minimumExpansionYear&&(a=ICAL.Timezone._minimumExpansionYear),a+=ICAL.Timezone.EXTRA_COVERAGE,a>ICAL.Timezone.MAX_YEAR&&(a=ICAL.Timezone.MAX_YEAR),!this.changes.length||this.expandedUntilYear<e){for(var n=this.component.getAllSubcomponents(),r=n.length,o=0;o<r;o++)this._expandComponent(n[o],a,this.changes);this.changes.sort(ICAL.Timezone._compare_change_fn),this.expandedUntilYear=a}},_expandComponent:function(e,t,a){function n(e){return e.factor*(3600*e.hours+60*e.minutes)}function r(){var t={is_daylight:'daylight'==e.name,utcOffset:n(e.getFirstProperty('tzoffsetto').getFirstValue()),prevUtcOffset:n(e.getFirstProperty('tzoffsetfrom').getFirstValue())};return t}if(!e.hasProperty('dtstart')||!e.hasProperty('tzoffsetto')||!e.hasProperty('tzoffsetfrom'))return null;var o,i=e.getFirstProperty('dtstart').getFirstValue();if(!e.hasProperty('rrule')&&!e.hasProperty('rdate'))o=r(),o.year=i.year,o.month=i.month,o.day=i.day,o.hour=i.hour,o.minute=i.minute,o.second=i.second,ICAL.Timezone.adjust_change(o,0,0,0,-o.prevUtcOffset),a.push(o);else{var s=e.getAllProperties('rdate');for(var d in s)if(s.hasOwnProperty(d)){var u=s[d],l=u.getFirstValue();o=r(),o.year=l.year,o.month=l.month,o.day=l.day,l.isDate?(o.hour=i.hour,o.minute=i.minute,o.second=i.second,i.zone!=ICAL.Timezone.utcTimezone&&ICAL.Timezone.adjust_change(o,0,0,0,-o.prevUtcOffset)):(o.hour=l.hour,o.minute=l.minute,o.second=l.second,l.zone!=ICAL.Timezone.utcTimezone&&ICAL.Timezone.adjust_change(o,0,0,0,-o.prevUtcOffset)),a.push(o)}var m=e.getFirstProperty('rrule');if(m){m=m.getFirstValue(),o=r(),m.until&&m.until.zone==ICAL.Timezone.utcTimezone&&(m.until.adjust(0,0,0,o.prevUtcOffset),m.until.zone=ICAL.Timezone.localTimezone);for(var c,p=m.iterator(i);(c=p.next())&&(o=r(),!(c.year>t)&&c);)o.year=c.year,o.month=c.month,o.day=c.day,o.hour=c.hour,o.minute=c.minute,o.second=c.second,o.isDate=c.isDate,ICAL.Timezone.adjust_change(o,0,0,0,-o.prevUtcOffset),a.push(o)}}return a},toString:function(){return this.tznames?this.tznames:this.tzid}},ICAL.Timezone._compare_change_fn=function(e,t){if(e.year<t.year)return-1;return e.year>t.year?1:e.month<t.month?-1:e.month>t.month?1:e.day<t.day?-1:e.day>t.day?1:e.hour<t.hour?-1:e.hour>t.hour?1:e.minute<t.minute?-1:e.minute>t.minute?1:e.second<t.second?-1:e.second>t.second?1:0},ICAL.Timezone.convert_time=function(e,t,a){if(e.isDate||t.tzid==a.tzid||t==ICAL.Timezone.localTimezone||a==ICAL.Timezone.localTimezone)return e.zone=a,e;var n=t.utcOffset(e);return e.adjust(0,0,0,-n),n=a.utcOffset(e),e.adjust(0,0,0,n),null},ICAL.Timezone.fromData=function(e){var t=new ICAL.Timezone;return t.fromData(e)},ICAL.Timezone.utcTimezone=ICAL.Timezone.fromData({tzid:'UTC'}),ICAL.Timezone.localTimezone=ICAL.Timezone.fromData({tzid:'floating'}),ICAL.Timezone.adjust_change=function(e,t,a,n,r){return ICAL.Time.prototype.adjust.call(e,t,a,n,r,e)},ICAL.Timezone._minimumExpansionYear=-1,ICAL.Timezone.MAX_YEAR=2035,ICAL.Timezone.EXTRA_COVERAGE=5}(),ICAL.TimezoneService=function(){var e,t={reset:function(){e=Object.create(null);var t=ICAL.Timezone.utcTimezone;e.Z=t,e.UTC=t,e.GMT=t},has:function(t){return!!e[t]},get:function(t){return e[t]},register:function(t,a){if(t instanceof ICAL.Component&&'vtimezone'===t.name&&(a=new ICAL.Timezone(t),t=a.tzid),a instanceof ICAL.Timezone)e[t]=a;else throw new TypeError('timezone must be ICAL.Timezone or ICAL.Component')},remove:function(t){return delete e[t]}};return t.reset(),t}(),function(){ICAL.Time=function(e,t){this.wrappedJSObject=this;var a=this._time=Object.create(null);a.year=0,a.month=1,a.day=1,a.hour=0,a.minute=0,a.second=0,a.isDate=!1,this.fromData(e,t)},ICAL.Time._dowCache={},ICAL.Time._wnCache={},ICAL.Time.prototype={icalclass:'icaltime',_cachedUnixTime:null,get icaltype(){return this.isDate?'date':'date-time'},zone:null,_pendingNormalization:!1,clone:function(){return new ICAL.Time(this._time,this.zone)},reset:function(){this.fromData(ICAL.Time.epochTime),this.zone=ICAL.Timezone.utcTimezone},resetTo:function(e,t,a,n,r,o,i){this.fromData({year:e,month:t,day:a,hour:n,minute:r,second:o,zone:i})},fromJSDate:function(e,t){return e?t?(this.zone=ICAL.Timezone.utcTimezone,this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()):(this.zone=ICAL.Timezone.localTimezone,this.year=e.getFullYear(),this.month=e.getMonth()+1,this.day=e.getDate(),this.hour=e.getHours(),this.minute=e.getMinutes(),this.second=e.getSeconds()):this.reset(),this._cachedUnixTime=null,this},fromData:function(e,t){if(e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if('icaltype'===a)continue;this[a]=e[a]}if(t&&(this.zone=t),e&&!('isDate'in e)?this.isDate=!('hour'in e):e&&'isDate'in e&&(this.isDate=e.isDate),e&&'timezone'in e){var n=ICAL.TimezoneService.get(e.timezone);this.zone=n||ICAL.Timezone.localTimezone}return e&&'zone'in e&&(this.zone=e.zone),this.zone||(this.zone=ICAL.Timezone.localTimezone),this._cachedUnixTime=null,this},dayOfWeek:function(){var e=(this.year<<9)+(this.month<<5)+this.day;if(e in ICAL.Time._dowCache)return ICAL.Time._dowCache[e];var t=this.day,a=this.month+(3>this.month?12:0),n=this.year-(3>this.month?1:0),r=t+n+ICAL.helpers.trunc(26*(a+1)/10)+ICAL.helpers.trunc(n/4);return r+=6*ICAL.helpers.trunc(n/100)+ICAL.helpers.trunc(n/400),r=(r+6)%7+1,ICAL.Time._dowCache[e]=r,r},dayOfYear:function(){var e=ICAL.Time.isLeapYear(this.year)?1:0,t=ICAL.Time.daysInYearPassedMonth;return t[e][this.month-1]+this.day},startOfWeek:function(e){var t=e||ICAL.Time.SUNDAY,a=this.clone();return a.day-=(this.dayOfWeek()+7-t)%7,a.isDate=!0,a.hour=0,a.minute=0,a.second=0,a},endOfWeek:function(e){var t=e||ICAL.Time.SUNDAY,a=this.clone();return a.day+=(7-this.dayOfWeek()+t-ICAL.Time.SUNDAY)%7,a.isDate=!0,a.hour=0,a.minute=0,a.second=0,a},startOfMonth:function(){var e=this.clone();return e.day=1,e.isDate=!0,e.hour=0,e.minute=0,e.second=0,e},endOfMonth:function(){var e=this.clone();return e.day=ICAL.Time.daysInMonth(e.month,e.year),e.isDate=!0,e.hour=0,e.minute=0,e.second=0,e},startOfYear:function(){var e=this.clone();return e.day=1,e.month=1,e.isDate=!0,e.hour=0,e.minute=0,e.second=0,e},endOfYear:function(){var e=this.clone();return e.day=31,e.month=12,e.isDate=!0,e.hour=0,e.minute=0,e.second=0,e},startDoyWeek:function(e){var t=e||ICAL.Time.SUNDAY,a=this.dayOfWeek()-t;return 0>a&&(a+=7),this.dayOfYear()-a},getDominicalLetter:function(){return ICAL.Time.getDominicalLetter(this.year)},nthWeekDay:function(e,t){var a,n=ICAL.Time.daysInMonth(this.month,this.year),r=t,o=0,i=this.clone();if(0<=r){i.day=1,0!=r&&r--,o=i.day;var s=i.dayOfWeek(),d=e-s;0>d&&(d+=7),o+=d,o-=e,a=e}else{i.day=n;var u=i.dayOfWeek();r++,a=u-e,0>a&&(a+=7),a=n-a}return a+=7*r,o+a},isNthWeekDay:function(e,t){var a=this.dayOfWeek();if(0===t&&a===e)return!0;var n=this.nthWeekDay(e,t);return!(n!==this.day)},weekNumber:function(e){var t=(this.year<<12)+(this.month<<8)+(this.day<<3)+e;if(t in ICAL.Time._wnCache)return ICAL.Time._wnCache[t];var a,n=this.clone();n.isDate=!0;var r=this.year;12==n.month&&25<n.day?(a=ICAL.Time.weekOneStarts(r+1,e),0>n.compare(a)?a=ICAL.Time.weekOneStarts(r,e):r++):(a=ICAL.Time.weekOneStarts(r,e),0>n.compare(a)&&(a=ICAL.Time.weekOneStarts(--r,e)));var o=n.subtractDate(a).toSeconds()/86400,i=ICAL.helpers.trunc(o/7)+1;return ICAL.Time._wnCache[t]=i,i},addDuration:function(e){var t=e.isNegative?-1:1,a=this.second,n=this.minute,r=this.hour,o=this.day;a+=t*e.seconds,n+=t*e.minutes,r+=t*e.hours,o+=t*e.days,o+=7*t*e.weeks,this.second=a,this.minute=n,this.hour=r,this.day=o,this._cachedUnixTime=null},subtractDate:function(e){var t=this.toUnixTime()+this.utcOffset(),a=e.toUnixTime()+e.utcOffset();return ICAL.Duration.fromSeconds(t-a)},subtractDateTz:function(e){var t=this.toUnixTime(),a=e.toUnixTime();return ICAL.Duration.fromSeconds(t-a)},compare:function(e){var t=this.toUnixTime(),a=e.toUnixTime();return t>a?1:a>t?-1:0},compareDateOnlyTz:function(e,t){function n(e){return ICAL.Time._cmp_attr(r,a,e)}var r=this.convertToZone(t),a=e.convertToZone(t),o=0;return 0==(o=n('year'))?0==(o=n('month'))?0==(o=n('day'))?o:o:o:o},convertToZone:function(e){var t=this.clone(),a=this.zone.tzid==e.tzid;return this.isDate||a||ICAL.Timezone.convert_time(t,this.zone,e),t.zone=e,t},utcOffset:function(){return this.zone==ICAL.Timezone.localTimezone||this.zone==ICAL.Timezone.utcTimezone?0:this.zone.utcOffset(this)},toICALString:function(){var e=this.toString();return 10<e.length?ICAL.design.icalendar.value['date-time'].toICAL(e):ICAL.design.icalendar.value.date.toICAL(e)},toString:function(){var e=this.year+'-'+ICAL.helpers.pad2(this.month)+'-'+ICAL.helpers.pad2(this.day);return this.isDate||(e+='T'+ICAL.helpers.pad2(this.hour)+':'+ICAL.helpers.pad2(this.minute)+':'+ICAL.helpers.pad2(this.second),this.zone===ICAL.Timezone.utcTimezone&&(e+='Z')),e},toJSDate:function(){return this.zone==ICAL.Timezone.localTimezone?this.isDate?new Date(this.year,this.month-1,this.day):new Date(this.year,this.month-1,this.day,this.hour,this.minute,this.second,0):new Date(1e3*this.toUnixTime())},_normalize:function(){this._time.isDate;return this._time.isDate&&(this._time.hour=0,this._time.minute=0,this._time.second=0),this.adjust(0,0,0,0),this},adjust:function(e,t,a,n,r){var o,i,s,d,u,l,m,c=0,p=0,y=r||this._time;if(y.isDate||(s=y.second+n,y.second=s%60,o=ICAL.helpers.trunc(s/60),0>y.second&&(y.second+=60,o--),d=y.minute+a+o,y.minute=d%60,i=ICAL.helpers.trunc(d/60),0>y.minute&&(y.minute+=60,i--),u=y.hour+t+i,y.hour=u%24,c=ICAL.helpers.trunc(u/24),0>y.hour&&(y.hour+=24,c--)),12<y.month?p=ICAL.helpers.trunc((y.month-1)/12):1>y.month&&(p=ICAL.helpers.trunc(y.month/12)-1),y.year+=p,y.month-=12*p,l=y.day+e+c,0<l)for(;;){if(m=ICAL.Time.daysInMonth(y.month,y.year),l<=m)break;y.month++,12<y.month&&(y.year++,y.month=1),l-=m}else for(;0>=l;)1==y.month?(y.year--,y.month=12):y.month--,l+=ICAL.Time.daysInMonth(y.month,y.year);return y.day=l,this._cachedUnixTime=null,this},fromUnixTime:function(e){this.zone=ICAL.Timezone.utcTimezone;var t=ICAL.Time.epochTime.clone();t.adjust(0,0,0,e),this.year=t.year,this.month=t.month,this.day=t.day,this.hour=t.hour,this.minute=t.minute,this.second=Math.floor(t.second),this._cachedUnixTime=null},toUnixTime:function(){if(null!==this._cachedUnixTime)return this._cachedUnixTime;var e=this.utcOffset(),t=Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second-e);return this._cachedUnixTime=t/1e3,this._cachedUnixTime},toJSON:function(){for(var e,t=['year','month','day','hour','minute','second','isDate'],a=Object.create(null),n=0,r=t.length;n<r;n++)e=t[n],a[e]=this[e];return this.zone&&(a.timezone=this.zone.tzid),a}},function(){function e(e){Object.defineProperty(ICAL.Time.prototype,e,{get:function(){return this._pendingNormalization&&(this._normalize(),this._pendingNormalization=!1),this._time[e]},set:function(t){return'isDate'===e&&t&&!this._time.isDate&&this.adjust(0,0,0,0),this._cachedUnixTime=null,this._pendingNormalization=!0,this._time[e]=t,t}})}'defineProperty'in Object&&(e('year'),e('month'),e('day'),e('hour'),e('minute'),e('second'),e('isDate'))}(),ICAL.Time.daysInMonth=function(e,t){var a=30;return 1>e||12<e?a:(a=[0,31,28,31,30,31,30,31,31,30,31,30,31][e],2==e&&(a+=ICAL.Time.isLeapYear(t)),a)},ICAL.Time.isLeapYear=function(e){return 1752>=e?0==e%4:0==e%4&&0!=e%100||0==e%400},ICAL.Time.fromDayOfYear=function(e,t){var a=t,n=e,r=new ICAL.Time;r.auto_normalize=!1;var o=ICAL.Time.isLeapYear(a)?1:0;if(1>n)return a--,o=ICAL.Time.isLeapYear(a)?1:0,n+=ICAL.Time.daysInYearPassedMonth[o][12],ICAL.Time.fromDayOfYear(n,a);if(n>ICAL.Time.daysInYearPassedMonth[o][12])return o=ICAL.Time.isLeapYear(a)?1:0,n-=ICAL.Time.daysInYearPassedMonth[o][12],a++,ICAL.Time.fromDayOfYear(n,a);r.year=a,r.isDate=!0;for(var i=11;0<=i;i--)if(n>ICAL.Time.daysInYearPassedMonth[o][i]){r.month=i+1,r.day=n-ICAL.Time.daysInYearPassedMonth[o][i];break}return r.auto_normalize=!0,r},ICAL.Time.fromStringv2=function(e){return new ICAL.Time({year:parseInt(e.substr(0,4),10),month:parseInt(e.substr(5,2),10),day:parseInt(e.substr(8,2),10),isDate:!0})},ICAL.Time.fromDateString=function(e){return new ICAL.Time({year:ICAL.helpers.strictParseInt(e.substr(0,4)),month:ICAL.helpers.strictParseInt(e.substr(5,2)),day:ICAL.helpers.strictParseInt(e.substr(8,2)),isDate:!0})},ICAL.Time.fromDateTimeString=function(e,t){if(19>e.length)throw new Error('invalid date-time value: "'+e+'"');var a;e[19]&&'Z'===e[19]?a='Z':t&&(a=t.getParameter('tzid'));var n=new ICAL.Time({year:ICAL.helpers.strictParseInt(e.substr(0,4)),month:ICAL.helpers.strictParseInt(e.substr(5,2)),day:ICAL.helpers.strictParseInt(e.substr(8,2)),hour:ICAL.helpers.strictParseInt(e.substr(11,2)),minute:ICAL.helpers.strictParseInt(e.substr(14,2)),second:ICAL.helpers.strictParseInt(e.substr(17,2)),timezone:a});return n},ICAL.Time.fromString=function(e){return 10<e.length?ICAL.Time.fromDateTimeString(e):ICAL.Time.fromDateString(e)},ICAL.Time.fromJSDate=function(e,t){var a=new ICAL.Time;return a.fromJSDate(e,t)},ICAL.Time.fromData=function(e,a){var n=new ICAL.Time;return n.fromData(e,a)},ICAL.Time.now=function(){return ICAL.Time.fromJSDate(new Date,!1)},ICAL.Time.weekOneStarts=function(e,a){var n=ICAL.Time.fromData({year:e,month:1,day:1,isDate:!0}),t=n.dayOfWeek(),r=a||ICAL.Time.DEFAULT_WEEK_START;return t>ICAL.Time.THURSDAY&&(n.day+=7),r>ICAL.Time.THURSDAY&&(n.day-=7),n.day-=t-r,n},ICAL.Time.getDominicalLetter=function(e){var t='GFEDCBA',a=(e+(0|e/4)+(0|e/400)-(0|e/100)-1)%7,n=ICAL.Time.isLeapYear(e);return n?t[(a+6)%7]+t[a]:t[a]},ICAL.Time.epochTime=ICAL.Time.fromData({year:1970,month:1,day:1,hour:0,minute:0,second:0,isDate:!1,timezone:'Z'}),ICAL.Time._cmp_attr=function(e,t,a){return e[a]>t[a]?1:e[a]<t[a]?-1:0},ICAL.Time.daysInYearPassedMonth=[[0,31,59,90,120,151,181,212,243,273,304,334,365],[0,31,60,91,121,152,182,213,244,274,305,335,366]],ICAL.Time.SUNDAY=1,ICAL.Time.MONDAY=2,ICAL.Time.TUESDAY=3,ICAL.Time.WEDNESDAY=4,ICAL.Time.THURSDAY=5,ICAL.Time.FRIDAY=6,ICAL.Time.SATURDAY=7,ICAL.Time.DEFAULT_WEEK_START=ICAL.Time.MONDAY}(),function(){ICAL.VCardTime=function(e,t,a){this.wrappedJSObject=this;var n=this._time=Object.create(null);n.year=null,n.month=null,n.day=null,n.hour=null,n.minute=null,n.second=null,this.icaltype=a||'date-and-or-time',this.fromData(e,t)},ICAL.helpers.inherits(ICAL.Time,ICAL.VCardTime,{icalclass:'vcardtime',icaltype:'date-and-or-time',zone:null,clone:function(){return new ICAL.VCardTime(this._time,this.zone,this.icaltype)},_normalize:function(){return this},utcOffset:function(){return this.zone instanceof ICAL.UtcOffset?this.zone.toSeconds():ICAL.Time.prototype.utcOffset.apply(this,arguments)},toICALString:function(){return ICAL.design.vcard.value[this.icaltype].toICAL(this.toString())},toString:function(){var e,t=ICAL.helpers.pad2,a=this.year,n=this.month,r=this.day,o=this.hour,i=this.minute,d=this.second,s=null!==n,u=null!==r,l=null!==o,m=null!==i,c=null!==d,p=(null!==a?t(a)+(s||u?'-':''):s||u?'--':'')+(s?t(n):'')+(u?'-'+t(r):''),y=(l?t(o):'-')+(l&&m?':':'')+(m?t(i):'')+(l||m?'':'-')+(m&&c?':':'')+(c?t(d):'');if(this.zone===ICAL.Timezone.utcTimezone)e='Z';else if(this.zone instanceof ICAL.UtcOffset)e=this.zone.toString();else if(this.zone===ICAL.Timezone.localTimezone)e='';else if(this.zone instanceof ICAL.Timezone){var h=ICAL.UtcOffset.fromSeconds(this.zone.utcOffset(this));e=h.toString()}else e='';switch(this.icaltype){case'time':return y+e;case'date-and-or-time':case'date-time':return p+('--'==y?'':'T'+y+e);case'date':return p;}return null}}),ICAL.VCardTime.fromDateAndOrTimeString=function(e,t){function a(t,a,n){return t?ICAL.helpers.strictParseInt(t.substr(a,n)):null}var n=e.split('T'),r=n[0],i=n[1],s=i?ICAL.design.vcard.value.time._splitZone(i):[],d=s[0],u=s[1],l=ICAL.helpers.strictParseInt,m=r?r.length:0,c=u?u.length:0,p=r&&'-'==r[0]&&'-'==r[1],y=u&&'-'==u[0],h={year:p?null:a(r,0,4),month:p&&(4==m||7==m)?a(r,2,2):7==m?a(r,5,2):10==m?a(r,5,2):null,day:5==m?a(r,3,2):7==m&&p?a(r,5,2):10==m?a(r,8,2):null,hour:y?null:a(u,0,2),minute:y&&3==c?a(u,1,2):4<c?y?a(u,1,2):a(u,3,2):null,second:4==c?a(u,2,2):6==c?a(u,4,2):8==c?a(u,6,2):null};return d='Z'==d?ICAL.Timezone.utcTimezone:d&&':'==d[3]?ICAL.UtcOffset.fromString(d):null,new ICAL.VCardTime(h,d,t)}}(),function(){function e(e,t,a,n){var r=n;if('+'===n[0]&&(r=n.substr(1)),r=ICAL.helpers.strictParseInt(r),void 0!==t&&n<t)throw new Error(e+': invalid value "'+n+'" must be > '+t);if(void 0!==a&&n>a)throw new Error(e+': invalid value "'+n+'" must be < '+t);return r}var t={SU:ICAL.Time.SUNDAY,MO:ICAL.Time.MONDAY,TU:ICAL.Time.TUESDAY,WE:ICAL.Time.WEDNESDAY,TH:ICAL.Time.THURSDAY,FR:ICAL.Time.FRIDAY,SA:ICAL.Time.SATURDAY},a={};for(var n in t)t.hasOwnProperty(n)&&(a[t[n]]=n);ICAL.Recur=function(e){this.wrappedJSObject=this,this.parts={},e&&'object'===('undefined'===typeof e?'undefined':babelHelpers.typeof(e))&&this.fromData(e)},ICAL.Recur.prototype={parts:null,interval:1,wkst:ICAL.Time.MONDAY,until:null,count:null,freq:null,icalclass:'icalrecur',icaltype:'recur',iterator:function(e){return new ICAL.RecurIterator({rule:this,dtstart:e})},clone:function(){return new ICAL.Recur(this.toJSON())},isFinite:function(){return!!(this.count||this.until)},isByCount:function(){return!(!this.count||this.until)},addComponent:function(e,t){var a=e.toUpperCase();a in this.parts?this.parts[a].push(t):this.parts[a]=[t]},setComponent:function(e,t){this.parts[e.toUpperCase()]=t.slice()},getComponent:function(e){var t=e.toUpperCase();return t in this.parts?this.parts[t].slice():[]},getNextOccurrence:function(e,t){var a,n=this.iterator(e);do a=n.next();while(a&&0>=a.compare(t));return a&&t.zone&&(a.zone=t.zone),a},fromData:function(e){for(var t in e){var a=t.toUpperCase();a in d?Array.isArray(e[t])?this.parts[a]=e[t]:this.parts[a]=[e[t]]:this[t]=e[t]}this.interval&&'number'!=typeof this.interval&&s.INTERVAL(this.interval,this),this.wkst&&'number'!=typeof this.wkst&&(this.wkst=ICAL.Recur.icalDayToNumericDay(this.wkst)),this.until&&!(this.until instanceof ICAL.Time)&&(this.until=ICAL.Time.fromString(this.until))},toJSON:function(){var e=Object.create(null);for(var t in e.freq=this.freq,this.count&&(e.count=this.count),1<this.interval&&(e.interval=this.interval),this.parts)if(this.parts.hasOwnProperty(t)){var a=this.parts[t];e[t.toLowerCase()]=Array.isArray(a)&&1==a.length?a[0]:ICAL.helpers.clone(this.parts[t])}return this.until&&(e.until=this.until.toString()),'wkst'in this&&this.wkst!==ICAL.Time.DEFAULT_WEEK_START&&(e.wkst=ICAL.Recur.numericDayToIcalDay(this.wkst)),e},toString:function(){var e='FREQ='+this.freq;for(var t in this.count&&(e+=';COUNT='+this.count),1<this.interval&&(e+=';INTERVAL='+this.interval),this.parts)this.parts.hasOwnProperty(t)&&(e+=';'+t+'='+this.parts[t]);return this.until&&(e+=';UNTIL='+this.until.toICALString()),'wkst'in this&&this.wkst!==ICAL.Time.DEFAULT_WEEK_START&&(e+=';WKST='+ICAL.Recur.numericDayToIcalDay(this.wkst)),e}},ICAL.Recur.icalDayToNumericDay=function(e){return t[e]},ICAL.Recur.numericDayToIcalDay=function(e){return a[e]};var r=/^(SU|MO|TU|WE|TH|FR|SA)$/,o=/^([+-])?(5[0-3]|[1-4][0-9]|[1-9])?(SU|MO|TU|WE|TH|FR|SA)$/,i=['SECONDLY','MINUTELY','HOURLY','DAILY','WEEKLY','MONTHLY','YEARLY'],s={FREQ:function(e,t){if(-1!==i.indexOf(e))t.freq=e;else throw new Error('invalid frequency "'+e+'" expected: "'+i.join(', ')+'"')},COUNT:function(e,t){t.count=ICAL.helpers.strictParseInt(e)},INTERVAL:function(e,t){t.interval=ICAL.helpers.strictParseInt(e),1>t.interval&&(t.interval=1)},UNTIL:function(e,t,a){t.until=10<e.length?ICAL.design.icalendar.value['date-time'].fromICAL(e):ICAL.design.icalendar.value.date.fromICAL(e),a||(t.until=ICAL.Time.fromString(t.until))},WKST:function(e,t){if(r.test(e))t.wkst=ICAL.Recur.icalDayToNumericDay(e);else throw new Error('invalid WKST value "'+e+'"')}},d={BYSECOND:e.bind(this,'BYSECOND',0,60),BYMINUTE:e.bind(this,'BYMINUTE',0,59),BYHOUR:e.bind(this,'BYHOUR',0,23),BYDAY:function(e){if(o.test(e))return e;throw new Error('invalid BYDAY value "'+e+'"')},BYMONTHDAY:e.bind(this,'BYMONTHDAY',-31,31),BYYEARDAY:e.bind(this,'BYYEARDAY',-366,366),BYWEEKNO:e.bind(this,'BYWEEKNO',-53,53),BYMONTH:e.bind(this,'BYMONTH',0,12),BYSETPOS:e.bind(this,'BYSETPOS',-366,366)};ICAL.Recur.fromString=function(e){var t=ICAL.Recur._stringToData(e,!1);return new ICAL.Recur(t)},ICAL.Recur.fromData=function(e){return new ICAL.Recur(e)},ICAL.Recur._stringToData=function(e,t){for(var a=Object.create(null),n=e.split(';'),r=n.length,o=0;o<r;o++){var i=n[o].split('='),u=i[0].toUpperCase(),l=i[0].toLowerCase(),m=t?l:u,c=i[1];if(u in d){for(var p=c.split(','),y=0,h=p.length;y<h;y++)p[y]=d[u](p[y]);a[m]=1==p.length?p[0]:p}else u in s?s[u](c,a,t):a[l]=c}return a}}(),ICAL.RecurIterator=function(){function e(e){this.fromData(e)}return e.prototype={completed:!1,rule:null,dtstart:null,last:null,occurrence_number:0,by_indices:null,initialized:!1,by_data:null,days:null,days_index:0,fromData:function(e){if(this.rule=ICAL.helpers.formatClassType(e.rule,ICAL.Recur),!this.rule)throw new Error('iterator requires a (ICAL.Recur) rule');if(this.dtstart=ICAL.helpers.formatClassType(e.dtstart,ICAL.Time),!this.dtstart)throw new Error('iterator requires a (ICAL.Time) dtstart');this.by_data=e.by_data?e.by_data:ICAL.helpers.clone(this.rule.parts,!0),e.occurrence_number&&(this.occurrence_number=e.occurrence_number),this.days=e.days||[],e.last&&(this.last=ICAL.helpers.formatClassType(e.last,ICAL.Time)),this.by_indices=e.by_indices,this.by_indices||(this.by_indices={BYSECOND:0,BYMINUTE:0,BYHOUR:0,BYDAY:0,BYMONTH:0,BYWEEKNO:0,BYMONTHDAY:0}),this.initialized=e.initialized||!1,this.initialized||this.init()},init:function(){this.initialized=!0,this.last=this.dtstart.clone();var e=this.by_data;if('BYDAY'in e&&this.sort_byday_rules(e.BYDAY,this.rule.wkst),'BYYEARDAY'in e&&('BYMONTH'in e||'BYWEEKNO'in e||'BYMONTHDAY'in e||'BYDAY'in e))throw new Error('Invalid BYYEARDAY rule');if('BYWEEKNO'in e&&'BYMONTHDAY'in e)throw new Error('BYWEEKNO does not fit to BYMONTHDAY');if('MONTHLY'==this.rule.freq&&('BYYEARDAY'in e||'BYWEEKNO'in e))throw new Error('For MONTHLY recurrences neither BYYEARDAY nor BYWEEKNO may appear');if('WEEKLY'==this.rule.freq&&('BYYEARDAY'in e||'BYMONTHDAY'in e))throw new Error('For WEEKLY recurrences neither BYMONTHDAY nor BYYEARDAY may appear');if('YEARLY'!=this.rule.freq&&'BYYEARDAY'in e)throw new Error('BYYEARDAY may only appear in YEARLY rules');if(this.last.second=this.setup_defaults('BYSECOND','SECONDLY',this.dtstart.second),this.last.minute=this.setup_defaults('BYMINUTE','MINUTELY',this.dtstart.minute),this.last.hour=this.setup_defaults('BYHOUR','HOURLY',this.dtstart.hour),this.last.day=this.setup_defaults('BYMONTHDAY','DAILY',this.dtstart.day),this.last.month=this.setup_defaults('BYMONTH','MONTHLY',this.dtstart.month),'WEEKLY'==this.rule.freq)if('BYDAY'in e){var t=this.ruleDayOfWeek(e.BYDAY[0]),a=t[0],n=t[1],r=n-this.last.dayOfWeek();(this.last.dayOfWeek()<n&&0<=r||0>r)&&(this.last.day+=r)}else{var o=ICAL.Recur.numericDayToIcalDay(this.dtstart.dayOfWeek());e.BYDAY=[o]}if('YEARLY'==this.rule.freq){for(;;){if(this.expand_year_days(this.last.year),0<this.days.length)break;this.increment_year(this.rule.interval)}this._nextByYearDay()}if('MONTHLY'==this.rule.freq&&this.has_by_data('BYDAY')){var s=null,d=this.last.clone(),u=ICAL.Time.daysInMonth(this.last.month,this.last.year);for(var l in this.by_data.BYDAY)if(this.by_data.BYDAY.hasOwnProperty(l)){this.last=d.clone();var t=this.ruleDayOfWeek(this.by_data.BYDAY[l]),a=t[0],n=t[1],i=this.last.nthWeekDay(n,a);if(6<=a||-6>=a)throw new Error('Malformed values in BYDAY part');if(i>u||0>=i){if(s&&s.month==d.month)continue;for(;i>u||0>=i;)this.increment_month(),u=ICAL.Time.daysInMonth(this.last.month,this.last.year),i=this.last.nthWeekDay(n,a)}this.last.day=i,(!s||0>this.last.compare(s))&&(s=this.last.clone())}if(this.last=s.clone(),this.has_by_data('BYMONTHDAY')&&this._byDayAndMonthDay(!0),this.last.day>u||0==this.last.day)throw new Error('Malformed values in BYDAY part')}else if(this.has_by_data('BYMONTHDAY')&&0>this.last.day){var u=ICAL.Time.daysInMonth(this.last.month,this.last.year);this.last.day=u+this.last.day+1}},next:function(){var e=this.last?this.last.clone():null;if(this.rule.count&&this.occurrence_number>=this.rule.count||this.rule.until&&0<this.last.compare(this.rule.until))return this.completed=!0,null;if(0==this.occurrence_number&&0<=this.last.compare(this.dtstart))return this.occurrence_number++,this.last;var t;do switch(t=1,this.rule.freq){case'SECONDLY':this.next_second();break;case'MINUTELY':this.next_minute();break;case'HOURLY':this.next_hour();break;case'DAILY':this.next_day();break;case'WEEKLY':this.next_week();break;case'MONTHLY':t=this.next_month();break;case'YEARLY':this.next_year();break;default:return null;}while(!this.check_contracting_rules()||0>this.last.compare(this.dtstart)||!t);if(0==this.last.compare(e))throw new Error('Same occurrence found twice, protecting you from death by recursion');return this.rule.until&&0<this.last.compare(this.rule.until)?(this.completed=!0,null):(this.occurrence_number++,this.last)},next_second:function(){return this.next_generic('BYSECOND','SECONDLY','second','minute')},increment_second:function(e){return this.increment_generic(e,'second',60,'minute')},next_minute:function(){return this.next_generic('BYMINUTE','MINUTELY','minute','hour','next_second')},increment_minute:function(e){return this.increment_generic(e,'minute',60,'hour')},next_hour:function(){return this.next_generic('BYHOUR','HOURLY','hour','monthday','next_minute')},increment_hour:function(e){this.increment_generic(e,'hour',24,'monthday')},next_day:function(){var e='BYDAY'in this.by_data,t='DAILY'==this.rule.freq;return 0==this.next_hour()?0:(t?this.increment_monthday(this.rule.interval):this.increment_monthday(1),0)},next_week:function(){var e=0;if(0==this.next_weekday_by_week())return e;if(this.has_by_data('BYWEEKNO')){++this.by_indices.BYWEEKNO;this.by_indices.BYWEEKNO==this.by_data.BYWEEKNO.length&&(this.by_indices.BYWEEKNO=0,e=1),this.last.month=1,this.last.day=1;var t=this.by_data.BYWEEKNO[this.by_indices.BYWEEKNO];this.last.day+=7*t,e&&this.increment_year(1)}else this.increment_monthday(7*this.rule.interval);return e},normalizeByMonthDayRules:function(e,t,a){for(var n,r=ICAL.Time.daysInMonth(t,e),o=[],i=0,s=a.length;i<s;i++)if(n=a[i],!(Math.abs(n)>r)){if(0>n)n=r+(n+1);else if(0===n)continue;-1===o.indexOf(n)&&o.push(n)}return o.sort(function(e,t){return e-t})},_byDayAndMonthDay:function(e){function t(){for(i=ICAL.Time.daysInMonth(m.last.month,m.last.year),n=m.normalizeByMonthDayRules(m.last.year,m.last.month,m.by_data.BYMONTHDAY),o=n.length;n[d]<=c&&!(e&&n[d]==c)&&d<o-1;)d++}function a(){c=0,m.increment_month(),d=0,t()}var n,r,o,i,s=this.by_data.BYDAY,d=0,u=s.length,l=0,m=this,c=this.last.day;t(),e&&(c-=1);for(var p=48;!l&&p;){if(p--,r=c+1,r>i){a();continue}var y=n[d++];if(y>=r)c=y;else{a();continue}for(var h=0;h<u;h++){var T=this.ruleDayOfWeek(s[h]),f=T[0],_=T[1];if(this.last.day=c,this.last.isNthWeekDay(_,f)){l=1;break}}if(!l&&d===o){a();continue}}if(0>=p)throw new Error('Malformed values in BYDAY combined with BYMONTHDAY parts');return l},next_month:function(){var e='MONTHLY'==this.rule.freq,t=1;if(0==this.next_hour())return t;if(this.has_by_data('BYDAY')&&this.has_by_data('BYMONTHDAY'))t=this._byDayAndMonthDay();else if(this.has_by_data('BYDAY')){var a=ICAL.Time.daysInMonth(this.last.month,this.last.year),n=0,r=0;if(this.has_by_data('BYSETPOS')){for(var o=this.last.day,i=1;i<=a;i++)this.last.day=i,this.is_day_in_byday(this.last)&&(r++,i<=o&&n++);this.last.day=o}t=0;for(var i=this.last.day+1;i<=a;i++)if(this.last.day=i,this.is_day_in_byday(this.last)&&(!this.has_by_data('BYSETPOS')||this.check_set_position(++n)||this.check_set_position(n-r-1))){t=1;break}i>a&&(this.last.day=1,this.increment_month(),this.is_day_in_byday(this.last)?(!this.has_by_data('BYSETPOS')||this.check_set_position(1))&&(t=1):t=0)}else if(this.has_by_data('BYMONTHDAY')){this.by_indices.BYMONTHDAY++,this.by_indices.BYMONTHDAY>=this.by_data.BYMONTHDAY.length&&(this.by_indices.BYMONTHDAY=0,this.increment_month());var a=ICAL.Time.daysInMonth(this.last.month,this.last.year),i=this.by_data.BYMONTHDAY[this.by_indices.BYMONTHDAY];0>i&&(i=a+i+1),i>a?(this.last.day=1,t=this.is_day_in_byday(this.last)):this.last.day=i}else{this.increment_month();var a=ICAL.Time.daysInMonth(this.last.month,this.last.year);this.by_data.BYMONTHDAY[0]>a?t=0:this.last.day=this.by_data.BYMONTHDAY[0]}return t},next_weekday_by_week:function(){var e=0;if(0==this.next_hour())return e;if(!this.has_by_data('BYDAY'))return 1;for(;;){var t=new ICAL.Time;this.by_indices.BYDAY++,this.by_indices.BYDAY==Object.keys(this.by_data.BYDAY).length&&(this.by_indices.BYDAY=0,e=1);var a=this.by_data.BYDAY[this.by_indices.BYDAY],n=this.ruleDayOfWeek(a),r=n[1];r-=this.rule.wkst,0>r&&(r+=7),t.year=this.last.year,t.month=this.last.month,t.day=this.last.day;var o=t.startDoyWeek(this.rule.wkst);if(!(1>r+o)||e){var i=ICAL.Time.fromDayOfYear(o+r,this.last.year);return this.last.year=i.year,this.last.month=i.month,this.last.day=i.day,e}}},next_year:function(){if(0==this.next_hour())return 0;if(++this.days_index==this.days.length){this.days_index=0;do this.increment_year(this.rule.interval),this.expand_year_days(this.last.year);while(0==this.days.length)}return this._nextByYearDay(),1},_nextByYearDay:function(){var e=this.days[this.days_index],t=this.last.year;1>e&&(e+=1,t+=1);var a=ICAL.Time.fromDayOfYear(e,t);this.last.day=a.day,this.last.month=a.month},ruleDayOfWeek:function(e){var t=e.match(/([+-]?[0-9])?(MO|TU|WE|TH|FR|SA|SU)/);if(t){var a=parseInt(t[1]||0,10);return e=ICAL.Recur.icalDayToNumericDay(t[2]),[a,e]}return[0,0]},next_generic:function(e,t,a,n,r){var o=e in this.by_data,i=this.rule.freq==t,s=0;if(r&&0==this[r]())return s;if(o){this.by_indices[e]++;var d=this.by_indices[e],u=this.by_data[e];this.by_indices[e]==u.length&&(this.by_indices[e]=0,s=1),this.last[a]=u[this.by_indices[e]]}else i&&this['increment_'+a](this.rule.interval);return o&&s&&i&&this['increment_'+n](1),s},increment_monthday:function(e){for(var t,a=0;a<e;a++)t=ICAL.Time.daysInMonth(this.last.month,this.last.year),this.last.day++,this.last.day>t&&(this.last.day-=t,this.increment_month())},increment_month:function(){if(this.last.day=1,this.has_by_data('BYMONTH'))this.by_indices.BYMONTH++,this.by_indices.BYMONTH==this.by_data.BYMONTH.length&&(this.by_indices.BYMONTH=0,this.increment_year(1)),this.last.month=this.by_data.BYMONTH[this.by_indices.BYMONTH];else{'MONTHLY'==this.rule.freq?this.last.month+=this.rule.interval:this.last.month++,this.last.month--;var e=ICAL.helpers.trunc(this.last.month/12);this.last.month%=12,this.last.month++,0!=e&&this.increment_year(e)}},increment_year:function(e){this.last.year+=e},increment_generic:function(e,t,a,n){this.last[t]+=e;var r=ICAL.helpers.trunc(this.last[t]/a);this.last[t]%=a,0!=r&&this['increment_'+n](r)},has_by_data:function(e){return e in this.rule.parts},expand_year_days:function(e){var a=new ICAL.Time;this.days=[];var t={},n=['BYDAY','BYWEEKNO','BYMONTHDAY','BYMONTH','BYYEARDAY'];for(var r in n)if(n.hasOwnProperty(r)){var o=n[r];o in this.rule.parts&&(t[o]=this.rule.parts[o])}if('BYMONTH'in t&&'BYWEEKNO'in t){var i=1,s={};a.year=e,a.isDate=!0;for(var d,u=0;u<this.by_data.BYMONTH.length;u++){d=this.by_data.BYMONTH[u],a.month=d,a.day=1;var l=a.weekNumber(this.rule.wkst);a.day=ICAL.Time.daysInMonth(d,e);var m=a.weekNumber(this.rule.wkst);for(u=l;u<m;u++)s[u]=1}for(var c,p=0;p<this.by_data.BYWEEKNO.length&&i;p++)c=this.by_data.BYWEEKNO[p],52>c?i&=s[p]:i=0;i?delete t.BYMONTH:delete t.BYWEEKNO}var y=Object.keys(t).length;if(0==y){var h=this.dtstart.clone();h.year=this.last.year,this.days.push(h.dayOfYear())}else if(1==y&&'BYMONTH'in t){for(var T in this.by_data.BYMONTH)if(this.by_data.BYMONTH.hasOwnProperty(T)){var f=this.dtstart.clone();f.year=e,f.month=this.by_data.BYMONTH[T],f.isDate=!0,this.days.push(f.dayOfYear())}}else if(1==y&&'BYMONTHDAY'in t){for(var _ in this.by_data.BYMONTHDAY)if(this.by_data.BYMONTHDAY.hasOwnProperty(_)){var D=this.dtstart.clone(),g=this.by_data.BYMONTHDAY[_];if(0>g){var Y=ICAL.Time.daysInMonth(D.month,e);g=g+Y+1}D.day=g,D.year=e,D.isDate=!0,this.days.push(D.dayOfYear())}}else if(2==y&&'BYMONTHDAY'in t&&'BYMONTH'in t){for(var T in this.by_data.BYMONTH)if(this.by_data.BYMONTH.hasOwnProperty(T)){var O=this.by_data.BYMONTH[T],Y=ICAL.Time.daysInMonth(O,e);for(var _ in this.by_data.BYMONTHDAY)if(this.by_data.BYMONTHDAY.hasOwnProperty(_)){var g=this.by_data.BYMONTHDAY[_];0>g&&(g=g+Y+1),a.day=g,a.month=O,a.year=e,a.isDate=!0,this.days.push(a.dayOfYear())}}}else if(1==y&&'BYWEEKNO'in t);else if(2==y&&'BYWEEKNO'in t&&'BYMONTHDAY'in t);else if(1==y&&'BYDAY'in t)this.days=this.days.concat(this.expand_by_day(e));else if(2==y&&'BYDAY'in t&&'BYMONTH'in t){for(var T in this.by_data.BYMONTH)if(this.by_data.BYMONTH.hasOwnProperty(T)){var d=this.by_data.BYMONTH[T],Y=ICAL.Time.daysInMonth(d,e);a.year=e,a.month=this.by_data.BYMONTH[T],a.day=1,a.isDate=!0;var b=a.dayOfWeek(),A=a.dayOfYear()-1;a.day=Y;var N=a.dayOfWeek();if(this.has_by_data('BYSETPOS')){for(var E=[],I=1;I<=Y;I++)a.day=I,this.is_day_in_byday(a)&&E.push(I);for(var C=0;C<E.length;C++)(this.check_set_position(C+1)||this.check_set_position(C-E.length))&&this.days.push(A+E[C])}else for(var x in this.by_data.BYDAY)if(this.by_data.BYDAY.hasOwnProperty(x)){var S,P=this.by_data.BYDAY[x],z=this.ruleDayOfWeek(P),v=z[0],B=z[1],M=(B+7-b)%7+1;if(0==v)for(var I=M;I<=Y;I+=7)this.days.push(A+I);else 0<v?(S=M+7*(v-1),S<=Y&&this.days.push(A+S)):(S=Y-(N+7-B)%7+7*(v+1),0<S&&this.days.push(A+S))}}this.days.sort(function(e,t){return e-t})}else if(2==y&&'BYDAY'in t&&'BYMONTHDAY'in t){var L=this.expand_by_day(e);for(var k in L)if(L.hasOwnProperty(k)){var I=L[k],R=ICAL.Time.fromDayOfYear(I,e);0<=this.by_data.BYMONTHDAY.indexOf(R.day)&&this.days.push(I)}}else if(3==y&&'BYDAY'in t&&'BYMONTHDAY'in t&&'BYMONTH'in t){var L=this.expand_by_day(e);for(var k in L)if(L.hasOwnProperty(k)){var I=L[k],R=ICAL.Time.fromDayOfYear(I,e);0<=this.by_data.BYMONTH.indexOf(R.month)&&0<=this.by_data.BYMONTHDAY.indexOf(R.day)&&this.days.push(I)}}else if(2==y&&'BYDAY'in t&&'BYWEEKNO'in t){var L=this.expand_by_day(e);for(var k in L)if(L.hasOwnProperty(k)){var I=L[k],R=ICAL.Time.fromDayOfYear(I,e),c=R.weekNumber(this.rule.wkst);this.by_data.BYWEEKNO.indexOf(c)&&this.days.push(I)}}else if(3==y&&'BYDAY'in t&&'BYWEEKNO'in t&&'BYMONTHDAY'in t);else this.days=1==y&&'BYYEARDAY'in t?this.days.concat(this.by_data.BYYEARDAY):[];return 0},expand_by_day:function(e){var t=[],a=this.last.clone();a.year=e,a.month=1,a.day=1,a.isDate=!0;var n=a.dayOfWeek();a.month=12,a.day=31,a.isDate=!0;var r=a.dayOfWeek(),o=a.dayOfYear();for(var i in this.by_data.BYDAY)if(this.by_data.BYDAY.hasOwnProperty(i)){var s=this.by_data.BYDAY[i],d=this.ruleDayOfWeek(s),u=d[0],l=d[1];if(0==u)for(var m=(l+7-n)%7+1;m<=o;m+=7)t.push(m);else if(0<u){var c;c=l>=n?l-n+1:l-n+8,t.push(c+7*(u-1))}else{var p;u=-u,p=l<=r?o-r+l:o-r+l-7,t.push(p-7*(u-1))}}return t},is_day_in_byday:function(e){for(var t in this.by_data.BYDAY)if(this.by_data.BYDAY.hasOwnProperty(t)){var a=this.by_data.BYDAY[t],n=this.ruleDayOfWeek(a),r=n[0],o=n[1],i=e.dayOfWeek();if(0==r&&o==i||e.nthWeekDay(o,r)==e.day)return 1}return 0},check_set_position:function(e){if(this.has_by_data('BYSETPOS')){var t=this.by_data.BYSETPOS.indexOf(e);return-1!==t}return!1},sort_byday_rules:function(e,t){for(var a=0;a<e.length;a++)for(var n=0;n<a;n++){var r=this.ruleDayOfWeek(e[n])[1],o=this.ruleDayOfWeek(e[a])[1];if(r-=t,o-=t,0>r&&(r+=7),0>o&&(o+=7),r>o){var i=e[a];e[a]=e[n],e[n]=i}}},check_contract_restriction:function(t,a){var n=e._indexMap[t],r=e._expandMap[this.rule.freq][n],o=!1;if(t in this.by_data&&r==e.CONTRACT){var i=this.by_data[t];for(var s in i)if(i.hasOwnProperty(s)&&i[s]==a){o=!0;break}}else o=!0;return o},check_contracting_rules:function(){var e=this.last.dayOfWeek(),t=this.last.weekNumber(this.rule.wkst),a=this.last.dayOfYear();return this.check_contract_restriction('BYSECOND',this.last.second)&&this.check_contract_restriction('BYMINUTE',this.last.minute)&&this.check_contract_restriction('BYHOUR',this.last.hour)&&this.check_contract_restriction('BYDAY',ICAL.Recur.numericDayToIcalDay(e))&&this.check_contract_restriction('BYWEEKNO',t)&&this.check_contract_restriction('BYMONTHDAY',this.last.day)&&this.check_contract_restriction('BYMONTH',this.last.month)&&this.check_contract_restriction('BYYEARDAY',a)},setup_defaults:function(t,a,n){var r=e._indexMap[t],o=e._expandMap[this.rule.freq][r];return o!=e.CONTRACT&&(t in this.by_data||(this.by_data[t]=[n]),this.rule.freq!=a)?this.by_data[t][0]:n},toJSON:function(){var e=Object.create(null);return e.initialized=this.initialized,e.rule=this.rule.toJSON(),e.dtstart=this.dtstart.toJSON(),e.by_data=this.by_data,e.days=this.days,e.last=this.last.toJSON(),e.by_indices=this.by_indices,e.occurrence_number=this.occurrence_number,e}},e._indexMap={BYSECOND:0,BYMINUTE:1,BYHOUR:2,BYDAY:3,BYMONTHDAY:4,BYYEARDAY:5,BYWEEKNO:6,BYMONTH:7,BYSETPOS:8},e._expandMap={SECONDLY:[1,1,1,1,1,1,1,1],MINUTELY:[2,1,1,1,1,1,1,1],HOURLY:[2,2,1,1,1,1,1,1],DAILY:[2,2,2,1,1,1,1,1],WEEKLY:[2,2,2,2,3,3,1,1],MONTHLY:[2,2,2,2,2,3,3,1],YEARLY:[2,2,2,2,2,2,2,2]},e.UNKNOWN=0,e.CONTRACT=1,e.EXPAND=2,e.ILLEGAL=3,e}(),ICAL.RecurExpansion=function(){function e(e){return ICAL.helpers.formatClassType(e,ICAL.Time)}function t(e,t){return e.compare(t)}function a(e){return e.hasProperty('rdate')||e.hasProperty('rrule')||e.hasProperty('recurrence-id')}function n(e){this.ruleDates=[],this.exDates=[],this.fromData(e)}return n.prototype={complete:!1,ruleIterators:null,ruleDates:null,exDates:null,ruleDateInc:0,exDateInc:0,exDate:null,ruleDate:null,dtstart:null,last:null,fromData:function(t){var a=ICAL.helpers.formatClassType(t.dtstart,ICAL.Time);if(!a)throw new Error('.dtstart (ICAL.Time) must be given');else this.dtstart=a;if(t.component)this._init(t.component);else{if(this.last=e(t.last)||a.clone(),!t.ruleIterators)throw new Error('.ruleIterators or .component must be given');this.ruleIterators=t.ruleIterators.map(function(e){return ICAL.helpers.formatClassType(e,ICAL.RecurIterator)}),this.ruleDateInc=t.ruleDateInc,this.exDateInc=t.exDateInc,t.ruleDates&&(this.ruleDates=t.ruleDates.map(e),this.ruleDate=this.ruleDates[this.ruleDateInc]),t.exDates&&(this.exDates=t.exDates.map(e),this.exDate=this.exDates[this.exDateInc]),'undefined'!==typeof t.complete&&(this.complete=t.complete)}},next:function(){for(var e,t,a,n=0;;){if(n++>500)throw new Error('max tries have occured, rule may be impossible to forfill.');if(t=this.ruleDate,e=this._nextRecurrenceIter(this.last),!t&&!e){this.complete=!0;break}if((!t||e&&0<t.compare(e.last))&&(t=e.last.clone(),e.next()),this.ruleDate===t&&this._nextRuleDay(),this.last=t,this.exDate&&(a=this.exDate.compare(this.last),0>a&&this._nextExDay(),0===a)){this._nextExDay();continue}return this.last}},toJSON:function(){function e(e){return e.toJSON()}var t=Object.create(null);return t.ruleIterators=this.ruleIterators.map(e),this.ruleDates&&(t.ruleDates=this.ruleDates.map(e)),this.exDates&&(t.exDates=this.exDates.map(e)),t.ruleDateInc=this.ruleDateInc,t.exDateInc=this.exDateInc,t.last=this.last.toJSON(),t.dtstart=this.dtstart.toJSON(),t.complete=this.complete,t},_extractDates:function(e,a){function n(e){r=ICAL.helpers.binsearchInsert(o,e,t),o.splice(r,0,e)}for(var r,o=[],s=e.getAllProperties(a),d=s.length,u=0;u<d;u++)s[u].getValues().forEach(n);return o},_init:function(e){if(this.ruleIterators=[],this.last=this.dtstart.clone(),!a(e))return this.ruleDate=this.last.clone(),void(this.complete=!0);if(e.hasProperty('rdate')&&(this.ruleDates=this._extractDates(e,'rdate'),this.ruleDates[0]&&0>this.ruleDates[0].compare(this.dtstart)?(this.ruleDateInc=0,this.last=this.ruleDates[0].clone()):this.ruleDateInc=ICAL.helpers.binsearchInsert(this.ruleDates,this.last,t),this.ruleDate=this.ruleDates[this.ruleDateInc]),e.hasProperty('rrule'))for(var n,r,o=e.getAllProperties('rrule'),s=0,i=o.length;s<i;s++)n=o[s].getFirstValue(),r=n.iterator(this.dtstart),this.ruleIterators.push(r),r.next();e.hasProperty('exdate')&&(this.exDates=this._extractDates(e,'exdate'),this.exDateInc=ICAL.helpers.binsearchInsert(this.exDates,this.last,t),this.exDate=this.exDates[this.exDateInc])},_nextExDay:function(){this.exDate=this.exDates[++this.exDateInc]},_nextRuleDay:function(){this.ruleDate=this.ruleDates[++this.ruleDateInc]},_nextRecurrenceIter:function(){var e=this.ruleIterators;if(0===e.length)return null;for(var t,a,n,r=e.length,o=0;o<r;o++){if(t=e[o],a=t.last,t.completed){r--,0!==o&&o--,e.splice(o,1);continue}(!n||0<n.last.compare(a))&&(n=t)}return n}},n}(),ICAL.Event=function(){function e(e,t){e instanceof ICAL.Component||(t=e,e=null),this.component=e?e:new ICAL.Component('vevent'),this._rangeExceptionCache=Object.create(null),this.exceptions=Object.create(null),this.rangeExceptions=[],t&&t.strictExceptions&&(this.strictExceptions=t.strictExceptions),t&&t.exceptions?t.exceptions.forEach(this.relateException,this):this.component.parent&&!this.isRecurrenceException()&&this.component.parent.getAllSubcomponents('vevent').forEach(function(e){e.hasProperty('recurrence-id')&&this.relateException(e)},this)}function t(e,t){return e[0]>t[0]?1:t[0]>e[0]?-1:0}return e.prototype={THISANDFUTURE:'THISANDFUTURE',exceptions:null,strictExceptions:!1,relateException:function(e){if(this.isRecurrenceException())throw new Error('cannot relate exception to exceptions');if(e instanceof ICAL.Component&&(e=new ICAL.Event(e)),this.strictExceptions&&e.uid!==this.uid)throw new Error('attempted to relate unrelated exception');var a=e.recurrenceId.toString();if(this.exceptions[a]=e,e.modifiesFuture()){var n=[e.recurrenceId.toUnixTime(),a],r=ICAL.helpers.binsearchInsert(this.rangeExceptions,n,t);this.rangeExceptions.splice(r,0,n)}},modifiesFuture:function(){if(!this.component.hasProperty('recurrence-id'))return!1;var e=this.component.getFirstProperty('recurrence-id').getParameter('range');return e===this.THISANDFUTURE},findRangeException:function(e){if(!this.rangeExceptions.length)return null;var a=e.toUnixTime(),n=ICAL.helpers.binsearchInsert(this.rangeExceptions,[a],t);if(n-=1,0>n)return null;var r=this.rangeExceptions[n];return a<r[0]?null:r[1]},getOccurrenceDetails:function(e){var t,a=e.toString(),n=e.convertToZone(ICAL.Timezone.utcTimezone).toString(),r={recurrenceId:e};if(a in this.exceptions)t=r.item=this.exceptions[a],r.startDate=t.startDate,r.endDate=t.endDate,r.item=t;else if(n in this.exceptions)t=this.exceptions[n],r.startDate=t.startDate,r.endDate=t.endDate,r.item=t;else{var o,i=this.findRangeException(e);if(i){var s=this.exceptions[i];r.item=s;var d=this._rangeExceptionCache[i];if(!d){var u=s.recurrenceId.clone(),l=s.startDate.clone();u.zone=l.zone,d=l.subtractDate(u),this._rangeExceptionCache[i]=d}var m=e.clone();m.zone=s.startDate.zone,m.addDuration(d),o=m.clone(),o.addDuration(s.duration),r.startDate=m,r.endDate=o}else o=e.clone(),o.addDuration(this.duration),r.endDate=o,r.startDate=e,r.item=this}return r},iterator:function(e){return new ICAL.RecurExpansion({component:this.component,dtstart:e||this.startDate})},isRecurring:function(){var e=this.component;return e.hasProperty('rrule')||e.hasProperty('rdate')},isRecurrenceException:function(){return this.component.hasProperty('recurrence-id')},getRecurrenceTypes:function(){for(var e,t=this.component.getAllProperties('rrule'),a=0,n=t.length,r=Object.create(null);a<n;a++)e=t[a].getFirstValue(),r[e.freq]=!0;return r},get uid(){return this._firstProp('uid')},set uid(e){this._setProp('uid',e)},get startDate(){return this._firstProp('dtstart')},set startDate(e){this._setTime('dtstart',e)},get endDate(){var e=this._firstProp('dtend');if(!e){var t=this._firstProp('duration');e=this.startDate.clone(),t?e.addDuration(t):e.isDate&&(e.day+=1)}return e},set endDate(e){this.component.hasProperty('duration')&&this.component.removeProperty('duration'),this._setTime('dtend',e)},get duration(){var e=this._firstProp('duration');return e?e:this.endDate.subtractDate(this.startDate)},set duration(e){this.component.hasProperty('dtend')&&this.component.removeProperty('dtend'),this._setProp('duration',e)},get location(){return this._firstProp('location')},set location(e){return this._setProp('location',e)},get attendees(){return this.component.getAllProperties('attendee')},get summary(){return this._firstProp('summary')},set summary(e){this._setProp('summary',e)},get description(){return this._firstProp('description')},set description(e){this._setProp('description',e)},get organizer(){return this._firstProp('organizer')},set organizer(e){this._setProp('organizer',e)},get sequence(){return this._firstProp('sequence')},set sequence(e){this._setProp('sequence',e)},get recurrenceId(){return this._firstProp('recurrence-id')},set recurrenceId(e){this._setProp('recurrence-id',e)},_setTime:function(e,t){var a=this.component.getFirstProperty(e);a||(a=new ICAL.Property(e),this.component.addProperty(a)),t.zone===ICAL.Timezone.localTimezone||t.zone===ICAL.Timezone.utcTimezone?a.removeParameter('tzid'):a.setParameter('tzid',t.zone.tzid),a.setValue(t)},_setProp:function(e,t){this.component.updatePropertyWithValue(e,t)},_firstProp:function(e){return this.component.getFirstPropertyValue(e)},toString:function(){return this.component.toString()}},e}(),ICAL.ComponentParser=function(){function e(e){'undefined'===typeof e&&(e={});for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}return e.prototype={parseEvent:!0,parseTimezone:!0,oncomplete:function(){},onerror:function(){},ontimezone:function(){},onevent:function(){},process:function(e){'string'===typeof e&&(e=ICAL.parse(e)),e instanceof ICAL.Component||(e=new ICAL.Component(e));for(var t,a=e.getAllSubcomponents(),n=0,r=a.length;n<r;n++)switch(t=a[n],t.name){case'vtimezone':if(this.parseTimezone){var o=t.getFirstPropertyValue('tzid');o&&this.ontimezone(new ICAL.Timezone({tzid:o,component:t}))}break;case'vevent':this.parseEvent&&this.onevent(new ICAL.Event(t));break;default:continue;}this.oncomplete()}},e}();