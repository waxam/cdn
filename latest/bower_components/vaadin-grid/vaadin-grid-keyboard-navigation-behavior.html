<html><head><link rel="import" href="../iron-a11y-keys-behavior/iron-a11y-keys-behavior.html"><link rel="import" href="../iron-a11y-announcer/iron-a11y-announcer.html"><link rel="prefetch" href="../polymer/polymer.html"><link rel="prefetch" href="../polymer/polymer-mini.html"><link rel="prefetch" href="../polymer/polymer-micro.html"></head><body><dom-module id="vaadin-grid-navigation-themability-styles"><template><style>:host(:focus),
      #table:focus{outline:none;}:host([navigating]:not([interacting])) [focused] > .vaadin-grid-row[focused] > [focused] ::slotted(vaadin-grid-cell-content){box-shadow:inset 0 0 0 3px rgba(0, 0, 0, 0.3);@apply (--vaadin-grid-focused-cell);}</style></template></dom-module><script>window.vaadin=window.vaadin||{},vaadin.elements=vaadin.elements||{},vaadin.elements.grid=vaadin.elements.grid||{},vaadin.elements.grid.TableKeyboardBehaviorImpl={hostAttributes:{role:'application',tabindex:0},keyBindings:{"ctrl+home":'_onCtrlHome',"ctrl+end":'_onCtrlEnd',down:'_onArrowDown',end:'_onEnd',enter:'_onEnter',esc:'_onEscape',f2:'_onF2',home:'_onHome',left:'_onArrowLeft',pagedown:'_onPageDown',pageup:'_onPageUp',right:'_onArrowRight',space:'_onSpace',tab:'_onTab',up:'_onArrowUp'},attached:function(){Polymer.IronA11yAnnouncer.requestAvailability()},properties:{_virtualFocus:{type:Object,observer:'_virtualFocusChanged'},interacting:{type:Boolean,reflectToAttribute:!0,value:!1},navigating:{type:Boolean,reflectToAttribute:!0,value:!1}},listeners:{focus:'_onFocus',"cell-focus":'_onCellFocus',"cell-content-focus":'_onCellContentFocus'},ready:function(){document.addEventListener('keydown',function(a){9===a.keyCode&&(this._tabbed=!0),9===a.keyCode&&a.shiftKey&&(this._shiftTabbed=!0)}.bind(this),!0),document.addEventListener('keyup',function(a){9===a.keyCode&&(this._tabbed=!1),9===a.keyCode&&a.shiftKey&&(this._shiftTabbed=!1)}.bind(this),!0)},_isFooterVisible:function(){return 0<this.$.footer._rows.filter(function(a){return!a.hidden}).length},_onFocus:function(){this._tabbed&&!this._shiftTabbed&&this._activateNavigation()},_activateNavigation:function(){this.$.footerFocusTrap.focus()},_onFocusout:function(){this.navigating=!1,this.interacting=!1},_onFooterFocus:function(){this.navigating=!0,this.interacting=!1,this._virtualFocus=this._virtualFocus||(this._shiftTabbed?this._isFooterVisible()?this.$.footer:this.$.items:this.$.header)},_virtualFocusChanged:function(a,b){b&&(b.focused=!1),a&&(a._focusedCellIndex=a._focusedCellIndex||0,a._focusedRowIndex=a._focusedRowIndex||0,a.focused=!0,a===this.$.items&&this._ensureVirtualFocusInViewport())},_onTab:function(a){if(!this.interacting&&this._virtualFocus)if(!this.navigating)this._activateNavigation(),a.preventDefault();else if(a.detail.keyboardEvent.shiftKey)switch(this._virtualFocus){case this.$.footer:this._virtualFocus=this.$.items,a.preventDefault();break;case this.$.items:this._virtualFocus=this.$.header,a.preventDefault();break;case this.$.header:this.focus(),this._virtualFocus=null;}else switch(this._virtualFocus){case this.$.header:this._virtualFocus=this.$.items,a.preventDefault();break;case this.$.items:this._isFooterVisible()?(this._virtualFocus=this.$.footer,a.preventDefault()):this.async(function(){this._virtualFocus=null},1);break;case this.$.footer:this._virtualFocus=null;}},_isAboveViewport:function(a){return this.firstVisibleIndex>a},_onArrowDown:function(a){this.interacting||(a.preventDefault(),this.navigating=!0,this._virtualFocus.focusDown(),this._ensureVirtualFocusInViewport())},_scrollPageDown:function(){var a=this.$.header.getBoundingClientRect(),b=this.$.footer.getBoundingClientRect();this.$.scroller.$.table.scrollTop+=b.top-a.bottom,this.$.scroller._scrollHandler()},_onPageDown:function(a){if(!this.interacting)if(a.preventDefault(),this.navigating=!0,this._virtualFocus===this.$.items){var b=this.$.scroller.lastVisibleIndex;this._scrollPageDown(),this._virtualFocus._focusedRowIndex+=this.$.scroller.lastVisibleIndex-b||this.$.scroller.lastVisibleIndex-this._virtualFocus._focusedRowIndex,this._ensureVirtualFocusInViewport()}else this._virtualFocus.focusPageDown()},_scrollPageUp:function(){var a=this.$.header.getBoundingClientRect(),b=this.$.footer.getBoundingClientRect();this.$.scroller.$.table.scrollTop-=b.top-a.bottom,this.$.scroller._scrollHandler()},_onPageUp:function(a){if(!this.interacting)if(a.preventDefault(),this.navigating=!0,this._virtualFocus===this.$.items){var b=this.$.scroller.lastVisibleIndex;this._scrollPageUp(),this._virtualFocus._focusedRowIndex-=b-this.$.scroller.lastVisibleIndex||this._virtualFocus._focusedRowIndex,this._ensureVirtualFocusInViewport()}else this._virtualFocus.focusPageUp()},_onArrowUp:function(a){this.interacting||(a.preventDefault(),this.navigating=!0,this._virtualFocus.focusUp(),this._ensureVirtualFocusInViewport())},_onArrowRight:function(a){this.interacting||(a.preventDefault(),this.navigating=!0,this._virtualFocus.focusRight(),this._ensureVirtualFocusInViewport())},_onArrowLeft:function(a){this.interacting||(a.preventDefault(),this.navigating=!0,this._virtualFocus.focusLeft(),this._ensureVirtualFocusInViewport())},_onHome:function(a){this.interacting||(a.preventDefault(),this.navigating=!0,this._virtualFocus.focusHome(),this._ensureVirtualFocusInViewport())},_onEnd:function(a){this.interacting||(a.preventDefault(),this.navigating=!0,this._virtualFocus.focusEnd(),this._ensureVirtualFocusInViewport())},_moveFocusToFocusTarget:function(){var a=this._virtualFocus._focusedCell._cellContent,b=a.querySelector('[focus-target]')||a.firstElementChild;b&&b.focus()},_onEnter:function(a){this.interacting?'input'===a.detail.keyboardEvent.target.localName&&'text'===a.detail.keyboardEvent.target.type&&this.$.footerFocusTrap.focus():(a.preventDefault(),this._moveFocusToFocusTarget())},_onEscape:function(){this.interacting?this.$.footerFocusTrap.focus():this.navigating&&(this.navigating=!1)},_onF2:function(a){a.preventDefault(),this.interacting?this.$.footerFocusTrap.focus():this._moveFocusToFocusTarget()},_onCtrlHome:function(a){this.interacting||(a.preventDefault(),this.navigating=!0,this._virtualFocus.focusFirst(),this._ensureVirtualFocusInViewport())},_onCtrlEnd:function(a){this.interacting||(a.preventDefault(),this.navigating=!0,this._virtualFocus.focusLast(),this._ensureVirtualFocusInViewport())},_onSpace:function(a){if(!this.interacting){a.preventDefault();var b=this._virtualFocus._focusedCell,c=b.getContentChildren(Polymer.Element?'slot':'content')[0].firstElementChild;c?c.click():this.navigating&&this.fire('cell-activate',{model:b.instance})}},_onCellContentFocus:function(a){this.interacting=!0,this._onCellFocus(a)},_onCellFocus:function(a){var b=a.detail.cell,c=b.parentElement,d=c.parentElement,e=Array.prototype.indexOf.call(Polymer.dom(d).children,c);d===this.$.items&&(e=c.index),d._focusedRowIndex=e,d._focusedCellIndex=Array.prototype.indexOf.call(Polymer.dom(c).children,b),this._virtualFocus=d,b.hasAttribute('detailscell')&&(d._focusedCellIndex=0,d._moveFocusToDetailsCell())},_ensureVirtualFocusInViewport:function(){var a=this.$.scroller._vidxOffset+this.$.scroller._virtualStart,b=this._virtualFocus._focusedRowIndex;this._virtualFocus===this.$.items&&(b<a||b>a+this.$.scroller._physicalCount)&&(this.$.scroller.scrollToScaledIndex(b),this._virtualFocus._focusedCellChanged(b,this._virtualFocus._focusedCellIndex)),this._ensureElementInViewport(this._virtualFocus._focusedCell)},_ensureElementInViewport:function(a){var b=a.getBoundingClientRect();if(this._virtualFocus===this.$.items){var c=this.$.footer.getBoundingClientRect().top,d=this.$.header.getBoundingClientRect().bottom;b.bottom>c?this.$.scroller.$.table.scrollTop+=b.bottom-c:b.top<d&&(this.$.scroller.$.table.scrollTop+=b.top-d)}if(!a.hasAttribute('detailscell')){var e=this.$.scroller.$.table.getBoundingClientRect().right,f=this.$.scroller.$.table.getBoundingClientRect().left,g=this._virtualFocus._focusedRow.querySelector('[last-frozen]');g&&(f=g.getBoundingClientRect().right),b.right>e?this.$.scroller.$.table.scrollLeft+=b.right-e:b.left<f&&(this.$.scroller.$.table.scrollLeft+=b.left-f)}}},vaadin.elements.grid.TableKeyboardBehavior=[vaadin.elements.grid.TableKeyboardBehaviorImpl,Polymer.IronA11yKeysBehavior];</script></body></html>