<html><head><link rel="import" href="../iron-scroll-target-behavior/iron-scroll-target-behavior.html"><link rel="prefetch" href="../polymer/polymer.html"><link rel="prefetch" href="../polymer/polymer-mini.html"><link rel="prefetch" href="../polymer/polymer-micro.html"></head><body><dom-module id="vaadin-grid-table-table-scroll-styles"><template><style>#table{position:relative;overflow:auto;-webkit-overflow-scrolling:touch;z-index:-2;}vaadin-grid-table[ios] #table{transform:none;}vaadin-grid-table[fixed-sections] #table{transform:none;}</style></template></dom-module><dom-module id="vaadin-grid-table-scroll-styles"><template><style>vaadin-grid-table{transform:translateZ(0);}vaadin-grid-table-header{position:absolute;top:0;width:100%;}vaadin-grid-table-footer{position:absolute;bottom:0;width:100%;}vaadin-grid-table-body{z-index:-1;}vaadin-grid-table[fixed-sections]{transform:translateZ(0);overflow:hidden;}vaadin-grid-table[fixed-sections] vaadin-grid-table-header,
      vaadin-grid-table[fixed-sections] vaadin-grid-table-footer{position:fixed;}vaadin-grid-table[fixed-sections] vaadin-grid-table-body#items{position:fixed;width:100%;will-change:transform;}</style></template></dom-module><script>window.vaadin=window.vaadin||{},vaadin.elements=vaadin.elements||{},vaadin.elements.grid=vaadin.elements.grid||{},vaadin.elements.grid.TableScrollBehaviorImpl={properties:{_vidxOffset:{type:Number,value:0},ios:{type:Boolean,value:navigator.userAgent.match(/iP(?:hone|ad;(?: U;)? CPU) OS (\d+)/),reflectToAttribute:!0},fixedSections:{type:Boolean,reflectToAttribute:!0,computed:'_hasFixedSections(scrollbarWidth)'},_frozenCells:{type:Array,value:function(){return[]}},scrolling:{type:Boolean,reflectToAttribute:!0}},ready:function(){this.scrollTarget=this.$.table},attached:function(){this.listen(this.scrollTarget,'wheel','_onWheel')},detached:function(){this.unlisten(this.scrollTarget,'wheel','_onWheel')},scrollToScaledIndex:function(a){this._pendingScrollToScaledIndex=null,this.$.items.style.borderTopWidth||(this._pendingScrollToScaledIndex=a),a=Math.min(Math.max(a,0),this.size-1),this.$.table.scrollTop=a/this.size*this.$.table.scrollHeight,this._scrollHandler(),this.scrollToIndex(a-this._vidxOffset),this._resetScrollPosition(this._scrollPosition),this._scrollHandler(),this._vidxOffset+this.lastVisibleIndex===this.size-1&&(this.$.table.scrollTop=this.$.table.scrollHeight-this.$.table.offsetHeight,this._scrollHandler())},_hasFixedSections:function(a){return navigator.userAgent.match(/Edge/)&&0===a},_onWheel:function(a){var b=Math.abs;if(!(a.ctrlKey||this._hasScrolledAncestor(a.target,a.deltaX,a.deltaY))){var c=this.$.table,d=a.deltaY;1===a.deltaMode&&(d*=this._physicalAverage);var e=b(a.deltaX)+b(d);this._canScroll(c,a.deltaX,d)?(a.preventDefault(),c.scrollTop+=d,c.scrollLeft+=a.deltaX,this._scrollHandler(),this._hasResidualMomentum=!0,this._ignoreNewWheel=this.debounce('ignore-new-wheel',function(){this._ignoreNewWheel=null},500)):this._hasResidualMomentum&&e<=this._previousMomentum||this._ignoreNewWheel?a.preventDefault():e>this._previousMomentum&&(this._hasResidualMomentum=!1),this._previousMomentum=e}},_hasScrolledAncestor:function(a,b,c){if(this._canScroll(a,b,c))return!0;return'vaadin-grid-cell-content'!==a.localName&&a!==this&&a.parentElement?this._hasScrolledAncestor(a.parentElement,b,c):void 0},_canScroll:function(a,b,c){return 0<c&&a.scrollTop<a.scrollHeight-a.offsetHeight||0>c&&0<a.scrollTop||0<b&&a.scrollLeft<a.scrollWidth-a.offsetWidth||0>b&&0<a.scrollLeft},_scrollHandler:function(){var a,b,c,d,e,f=Math.max(0,Math.min(this._maxScrollTop,this._scrollTop)),g=f-this._scrollPosition,h=this._ratio,i=0,j=this._hiddenContentSize,k=h,l=[];if(this._scrollPosition=f,this._firstVisibleIndexVal=null,this._lastVisibleIndexVal=null,d=this._scrollBottom,e=this._physicalBottom,Math.abs(g)>this._physicalSize)this._physicalTop+=g,i=Math.round(g/this._physicalAverage);else if(0>g){var m=f-this._physicalTop,n=this._virtualStart;for(c=[],b=this._physicalEnd,k=m/j;k<h&&i<this._physicalCount&&0<n-i&&e-this._getPhysicalSizeIncrement(b)>d;)a=this._getPhysicalSizeIncrement(b),k+=a/j,e-=a,c.push(b),i++,b=0===b?this._physicalCount-1:b-1;l=c,i=-i}else if(0<g){var o=e-d,p=this._virtualEnd,q=this._virtualCount-1;for(c=[],b=this._physicalStart,k=o/j;k<h&&i<this._physicalCount&&p+i<q&&this._physicalTop+this._getPhysicalSizeIncrement(b)<f;)a=this._getPhysicalSizeIncrement(b),k+=a/j,this._physicalTop+=a,c.push(b),i++,b=(b+1)%this._physicalCount}this._virtualCount<this.size&&this._adjustVirtualIndexOffset(g),0===i?(e<d||this._physicalTop>f)&&this._increasePoolIfNeeded():(this._virtualStart+=i,this._physicalStart+=i,this._update(c,l)),this._translateStationaryElements(),this.hasAttribute('reordering')||(this.scrolling=!0),this.debounce('vaadin-grid-scrolling',function(){this.scrolling=!1,this._reorderRows()},100)},_adjustVirtualIndexOffset:function(a){var b=Math.round,c=Math.min;if(1e4<Math.abs(a)){if(this._noScale)return void(this._noScale=!1);var d=b(1e3*(this._scrollPosition/this._scrollHeight))/1e3,e=d*this.size;this._vidxOffset=b(e-d*this._virtualCount),0===this._scrollTop&&this.scrollToIndex(0)}else{var f=this._vidxOffset||0,g=1e3,h=100;0===this._scrollTop?(this._vidxOffset=0,f!==this._vidxOffset&&this.scrollToIndex(0)):this.firstVisibleIndex<g&&0<this._vidxOffset&&(this._vidxOffset-=c(this._vidxOffset,h),this.scrollToIndex(this.firstVisibleIndex+(f-this._vidxOffset)+1),this._noScale=!0);var i=this.size-this._virtualCount;this._scrollTop>=this._maxScrollTop?(this._vidxOffset=i,f!==this._vidxOffset&&this.scrollToIndex(this._virtualCount)):this.firstVisibleIndex>this._virtualCount-g&&this._vidxOffset<i&&(this._vidxOffset+=c(i-this._vidxOffset,h),this.scrollToIndex(this.firstVisibleIndex-(this._vidxOffset-f)),this._noScale=!0)}},_reorderRows:function(){var a=Polymer.dom(this.$.items),b=a.querySelectorAll('.vaadin-grid-row'),c=this._virtualStart+this._vidxOffset,d=b.length-(b[0].index-c);if(d<b.length/2)for(var e=0;e<d;e++)a.appendChild(b[e]);else for(var f=d;f<b.length;f++)a.insertBefore(b[f],b[0])},_frozenCellsChanged:function(){this.debounce('cache-elements',function(){Polymer.dom(this.domHost.root).querySelectorAll('.vaadin-grid-cell').forEach(function(a){a.style.transform=''}),this._frozenCells=Array.prototype.slice.call(Polymer.dom(this.domHost.root).querySelectorAll('[frozen]')),this._translateStationaryElements()}),this._updateLastFrozen()},_updateLastFrozen:function(){if(this.columnTree){var a=this.columnTree[this.columnTree.length-1].slice(0);a.sort(function(c,a){return c._order-a._order});var b=a.reduce(function(a,b,c){return b._lastFrozen=!1,b.frozen&&!b.hidden?c:a},void 0);void 0!==b&&(a[b]._lastFrozen=!0)}},_translateStationaryElements:function(){this.fixedSections?(this.$.items.style.transform=this._getTranslate(-this._scrollLeft||0,-this._scrollTop||0),this.$.footer.style.transform=this.$.header.style.transform=this._getTranslate(-this._scrollLeft||0,0)):this.$.footer.style.transform=this.$.header.style.transform=this._getTranslate(0,this._scrollTop);for(var a=this._getTranslate(this._scrollLeft,0),b=0;b<this._frozenCells.length;b++)this._frozenCells[b].style.transform=a},_getTranslate:function(a,b){return'translate('+a+'px,'+b+'px)'}},vaadin.elements.grid.TableScrollBehavior=[Polymer.IronScrollTargetBehavior,vaadin.elements.grid.TableScrollBehaviorImpl];</script></body></html>