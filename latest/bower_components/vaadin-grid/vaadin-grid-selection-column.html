<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="vaadin-grid-column.html"><link rel="prefetch" href="../polymer/polymer-mini.html"><link rel="prefetch" href="../polymer/polymer-micro.html"><link rel="prefetch" href="vaadin-grid-templatizer.html"></head><body><dom-module id="vaadin-grid-selection-column"><template><template class="header" id="defaultHeaderTemplate"><input aria-label="Select All" hidden$="[[_selectAllHidden]]" type="checkbox" on-click="_onSelectAll" checked="[[_isChecked(selectAll, _indeterminate)]]" indeterminate="[[_indeterminate]]"></template><template id="defaultBodyTemplate"><input aria-label="Select Row" type="checkbox" checked="{{selected::change}}"></template></template><script>Polymer({is:'vaadin-grid-selection-column',behaviors:[vaadin.elements.grid.ColumnBehavior],properties:{width:{type:String,value:'52px'},flexGrow:{type:Number,value:0},selectAll:{type:Boolean,value:!1,notify:!0},autoSelect:{type:Boolean,value:!1},headerTemplate:Object,template:Object,_grid:Object,_indeterminate:Boolean,_previousActiveItem:Object,_selectAllHidden:Boolean},observers:['_onSelectAllChanged(selectAll, _grid)'],_prepareHeaderTemplate:function(){var a=this._prepareTemplatizer(this._findTemplate('template.header')||this.$.defaultHeaderTemplate);return a.templatizer.dataHost=a===this.$.defaultHeaderTemplate?this:this.dataHost,a},_prepareBodyTemplate:function(){var a=this._prepareTemplatizer(this._findTemplate('template:not(.header):not(.footer)')||this.$.defaultBodyTemplate);return a.templatizer.dataHost=a===this.$.defaultBodyTemplate?this:this.dataHost,a},detached:function(){if(this._grid){this.unlisten(this._grid,'active-item-changed','_onActiveItemChanged'),this.unlisten(this._grid,'data-provider-changed','_onDataProviderChanged'),this.unlisten(this._grid,'filter-changed','_onSelectedItemsChanged'),this.unlisten(this._grid,'selected-items-changed','_onSelectedItemsChanged');var a=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);if(a&&window.ShadyDOM&&this.parentElement){var b=this.parentElement,c=this.nextElementSibling;b.removeChild(this),c?b.insertBefore(this,c):b.appendChild(this)}}},attached:function(){this._grid=this._findGrid(this),this._grid&&(this.listen(this._grid,'active-item-changed','_onActiveItemChanged'),this.listen(this._grid,'data-provider-changed','_onDataProviderChanged'),this.listen(this._grid,'filter-changed','_onSelectedItemsChanged'),this.listen(this._grid,'selected-items-changed','_onSelectedItemsChanged'))},_findGrid:function(a){for(;a&&'vaadin-grid'!=a.localName;)a=Polymer.dom(a).parentNode;return a||void 0},_onSelectAllChanged:function(a,b){void 0===a||void 0===b||this._selectAllChangeLock||(b.selectedItems=a&&b.items?b._filter(b.items):[])},_arrayContains:function(c,a){for(var b=0;c&&a&&a[b]&&0<=c.indexOf(a[b]);b++);return b==a.length},_onSelectAll:function(){this.selectAll=this._indeterminate||!this.selectAll},_isChecked:function(a,b){return b||a},_onActiveItemChanged:function(a){var b=a.detail.value;if(this.autoSelect){var c=b||this._previousActiveItem;c&&this._grid._toggleItem(c)}this._previousActiveItem=b},_onSelectedItemsChanged:function(){this._selectAllChangeLock=!0,this._grid.items&&(this._grid.selectedItems.length?this._arrayContains(this._grid.selectedItems,this._grid._filter(this._grid.items))?(this.selectAll=!0,this._indeterminate=!1):(this.selectAll=!1,this._indeterminate=!0):(this.selectAll=!1,this._indeterminate=!1)),this._selectAllChangeLock=!1},_onDataProviderChanged:function(){this._selectAllHidden=!this._grid.items}});</script></dom-module></body></html>