<html><head></head><body><dom-module id="vaadin-grid-data-provider-themability-styles"><template><style>@keyframes vaadin-grid-spin-360{100%{transform:rotate(360deg);}}@-webkit-keyframes vaadin-grid-spin-360{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg);}}#spinner{border:2px solid var(--primary-color, #03A9F4);border-radius:50%;border-right-color:transparent;border-top-color:transparent;content:"";height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px;pointer-events:none;opacity:0;@apply (--vaadin-grid-loading-spinner);}:host([loading]) #spinner{opacity:1;-webkit-animation:vaadin-grid-spin-360 400ms linear infinite;animation:vaadin-grid-spin-360 400ms linear infinite;}:host([loading]) #items{opacity:0.5;}</style></template></dom-module><script>window.vaadin=window.vaadin||{},vaadin.elements=vaadin.elements||{},vaadin.elements.grid=vaadin.elements.grid||{},vaadin.elements.grid.DataProviderBehavior={listeners:{"item-changed":'_templateItemChanged'},properties:{pageSize:{type:Number,value:50,observer:'_pageSizeChanged'},dataProvider:{type:Object,notify:!0,observer:'_dataProviderChanged'},_loading:Boolean,_cache:{type:Object,value:function(){return{}}},_pendingRequests:{type:Object,value:function(){return{}}}},_templateItemChanged:function(a){var b=a.detail.item;Array.prototype.forEach.call(Polymer.dom(this.$.items).children,function(c){c.item===b&&c.iterateCells(function(b){b._templatizer._suppressItemChangeEvent=!0,b.instance.notifyPath('item.'+a.detail.path,a.detail.value),b._templatizer._suppressItemChangeEvent=!1})})},_getCachedItem:function(a){var b=this._getPageForIndex(a),c=this._cache&&this._cache[b];return c?c[a-b*this.pageSize]:null},_getItem:function(a,b){this._updateItem(b,this._getCachedItem(a)),this._eagerlyLoadPages();var c=this._uncachedPagesForPhysicalItems();0<c.length&&(this._loading=!0,this.debounce('load',function(){c.forEach(function(a){this._loadPage(a)}.bind(this))},100))},_cachedPagesForPhysicalItems:function(){return this._pagesForPhysicalItems().filter(function(a){return this._cache!==void 0&&this._cache[a]!==void 0}.bind(this))},_uncachedPagesForPhysicalItems:function(){return this._pagesForPhysicalItems().filter(function(a){return this._cache!==void 0&&this._cache[a]===void 0}.bind(this))},_eagerlyLoadPages:function(){var a=Math.max,b=this._cachedPagesForPhysicalItems().slice(0);if(0<b.length){b.sort(function(c,a){return c>a});var c=a(0,b[0]-1),d=Math.min(b[b.length-1]+1,a(0,Math.floor(this.size/this.pageSize)-1));this._loadPage(c),this._loadPage(d)}},_pagesForPhysicalItems:function(){var a=this._getPageForIndex(this.$.scroller.firstVisibleIndex+this.$.scroller._vidxOffset);return[a].concat(this.$.scroller._physicalItems.filter(function(a){return a.index}).map(function(a){return this._getPageForIndex(a.index)}.bind(this))).reduce(function(a,b){return-1===a.indexOf(b)&&a.push(b),a},[])},_updateItems:function(a,b){for(var c=0;c<this.pageSize;c++){var d=a*this.pageSize+c,e=this.$.scroller._virtualIndexToItem[d];e&&(this._updateItem(e,b[c]),this.debounce('update-heights',function(){this.$.scroller._updateMetrics(),this.$.scroller._positionItems(),this.$.scroller._updateScrollerSize()},1))}},_loadPage:function(a,b){if(b=b||this._updateItems.bind(this),!this._cache[a]&&!this._pendingRequests[a]&&this.dataProvider){this._pendingRequests[a]=!0;var c={page:a,pageSize:this.pageSize,sortOrders:this._mapSorters(),filters:this._mapFilters()};this.dataProvider(c,function(c){this._cache[a]=c,delete this._pendingRequests[a],b(a,c),this._loading=0<this._pendingRequests.length,this.debounce('check-size',this._checkSize,2e3)}.bind(this))}},_getPageForIndex:function(a){return Math.floor(a/this.pageSize)},clearCache:function(){this._cache={},this._pendingRequests={},this.$.scroller.hasData&&this.$.scroller._update(),this._flushItemsDebouncer()},_flushItemsDebouncer:function(){this.flushDebouncer('load')},_pageSizeChanged:function(a,b){b!==void 0&&a!==b&&this.clearCache()},_checkSize:function(){this.size===void 0&&console.warn('The <vaadin-grid> needs a value for "size" property in order to display rows.')},_dataProviderChanged:function(a,b){b!==void 0&&this.clearCache(),this.$.scroller.hasData||(this._loading=!0,this._loadPage(0,function(){this.$.scroller.hasData=!0}.bind(this)))}};</script></body></html>