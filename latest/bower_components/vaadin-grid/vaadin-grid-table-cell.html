<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="vaadin-grid-cell-click-behavior.html"><link rel="prefetch" href="../polymer/polymer-mini.html"><link rel="prefetch" href="../polymer/polymer-micro.html"></head><body><dom-module id="vaadin-grid-table-cell"></dom-module><dom-module id="vaadin-grid-table-header-cell"></dom-module><dom-module id="vaadin-grid-table-footer-cell"></dom-module><dom-module id="vaadin-grid-sizer-cell"></dom-module><script>(function(){var a={properties:{column:Object,expanded:Boolean,flexGrow:Number,colSpan:Number,focused:{type:Boolean,reflectToAttribute:!0},frozen:{type:Boolean,reflectToAttribute:!0},lastFrozen:{type:Boolean,reflectToAttribute:!0},hidden:{type:Boolean,reflectToAttribute:!0},instance:Object,index:Number,item:Object,selected:Boolean,template:Object,target:Object,width:String,order:Number,reorderStatus:{type:String,reflectToAttribute:!0},_childColumns:Array,_cellContent:Object,_insertionPoint:Object,_templatizer:Object},observers:['_columnChanged(column)','_cellAttached(column, isAttached)','_expandedChanged(expanded, instance)','_flexGrowChanged(flexGrow)','_indexChanged(index, instance)','_itemChanged(item, instance)','_instanceChanged(instance, target)','_selectedChanged(selected, instance)','_toggleContent(isAttached, _cellContent, _insertionPoint)','_toggleInstance(isAttached, _templatizer, instance)','_widthChanged(width)','_orderChanged(order)','_visibleChildColumnsChanged(_visibleChildColumns)','_childColumnsChanged(_childColumns)'],ready:function(){this.classList.add('vaadin-grid-cell'),!1===Polymer.Settings.useShadow&&(this.classList.add('style-scope'),this.classList.add('vaadin-grid'))},_columnChanged:function(a){this.flexGrow=a.flexGrow,this.frozen=a.frozen,this.lastFrozen=a._lastFrozen,this.headerTemplate=a.headerTemplate,this.footerTemplate=a.footerTemplate,this.template=a.template,this.width=a.width,this.hidden=a.hidden,this.resizable=a.resizable,this._childColumns=a._childColumns,this.order=a._order,a.colSpan&&(this.colSpan=a.colSpan),this.listen(a,'property-changed','_columnPropChanged')},_cellAttached:function(a,b){void 0===a||void 0===b||(b?this.listen(a,'property-changed','_columnPropChanged'):this.async(function(){this.isAttached||this.unlisten(a,'property-changed','_columnPropChanged')}))},_columnPropChanged:function(a){a.target==this.column&&(this[a.detail.path]=a.detail.value)},_expandedChanged:function(a,b){void 0===a||void 0===b||(b.__expanded__=a,b.expanded=a)},_flexGrowChanged:function(a){this.style.flexGrow=a},_indexChanged:function(a,b){void 0===a||void 0===b||(b.index=a)},_itemChanged:function(a,b){void 0===a||void 0===b||(b.item=a)},_selectedChanged:function(a,b){void 0===a||void 0===b||(b.__selected__=a,b.selected=a)},_childColumnsChanged:function(a){this.colSpan=a.length},_toggleContent:function(a,b,c){void 0===a||void 0===b||void 0===c||(a?(Polymer.dom(b).parentNode!==this.target&&Polymer.dom(this.target).appendChild(b),Polymer.dom(this).appendChild(c)):this.async(function(){this.isAttached||Polymer.dom(b).parentNode!==this.target||Polymer.dom(this.target).removeChild(b)}))},_toggleInstance:function(a,b,c){void 0===a||void 0===b||void 0===c||(a?b.addInstance(c):b.removeInstance(c))},_widthChanged:function(a){this.style.width=a},_orderChanged:function(a){this.style.order=a},_templateChanged:function(a){this.instance=a.templatizer.createInstance(),this._templatizer=a.templatizer},_instanceChanged:function(a,b){if(void 0!==a&&void 0!==b){this.style.height='',this._cellContent=this._cellContent||document.createElement('vaadin-grid-cell-content');var c=vaadin.elements.grid._contentIndex=vaadin.elements.grid._contentIndex+1||0,d='vaadin-grid-cell-content-'+c;this._cellContent.innerHTML='',Polymer.dom(this._cellContent).appendChild(this.instance.root),this._cellContent.setAttribute('id',d),Polymer.Element?(this._cellContent.setAttribute('slot',d),this._insertionPoint=this._insertionPoint||document.createElement('slot'),this._insertionPoint.setAttribute('name',d)):(this._insertionPoint=this._insertionPoint||document.createElement('content'),this._insertionPoint.setAttribute('select','#'+d))}}};Polymer({is:'vaadin-grid-table-cell',behaviors:[a,vaadin.elements.grid.CellClickBehavior],observers:['_templateChanged(template)'],_cellClick:function(a){a.defaultPrevented||this.fire('cell-activate',{model:this.instance})}}),Polymer({is:'vaadin-grid-table-header-cell',properties:{headerTemplate:Object,resizable:Boolean,columnResizing:{type:Boolean,reflectToAttribute:!0}},behaviors:[a,vaadin.elements.grid.CellClickBehavior],observers:['_headerTemplateChanged(headerTemplate)','_isEmptyChanged(_isEmpty, isAttached)','_resizableChanged(resizable)'],listeners:{mousedown:'_cancelMouseDownOnResize',mousemove:'_enableDrag',mouseout:'_disableDrag',touchstart:'_onTouchStart',touchmove:'_onTouchMove',touchend:'_onTouchEnd',contextmenu:'_onContextMenu'},_onContextMenu:function(a){this._reorderGhost&&a.preventDefault()},_onTouchStart:function(a){a.target!==this._resizeHandle&&this.target.columnReorderingAllowed&&(this._startReorderTimeout=setTimeout(this._startReorder.bind(this,a),100))},_startReorder:function(a){this._reorderGhost=this._getGhost(),this._reorderGhost.style.visibility='visible';var b=new CustomEvent('dragstart',{bubbles:!0});this._cellContent.dispatchEvent(b),this._reorderXY={x:a.touches[0].clientX-this.getBoundingClientRect().left,y:a.touches[0].clientY-this.getBoundingClientRect().top},this._updateGhostPosition(a.touches[0].clientX,a.touches[0].clientY)},_onTouchMove:function(a){if(this._reorderGhost){a.preventDefault();var b=new CustomEvent('dragover',{bubbles:!0});b.clientX=a.touches[0].clientX,b.clientY=a.touches[0].clientY;var c=this._contentFromPoint(b.clientX,b.clientY);c&&c.dispatchEvent(b),this._updateGhostPosition(a.touches[0].clientX,a.touches[0].clientY)}else clearTimeout(this._startReorderTimeout)},_updateGhostPosition:function(a,b){var c=a-this._reorderXY.x,d=b-this._reorderXY.y-50,e=parseInt(this._reorderGhost.style.left||0),f=parseInt(this._reorderGhost.style.top||0),g=this._reorderGhost.getBoundingClientRect();this._reorderGhost.style.left=e-(g.left-c)+'px',this._reorderGhost.style.top=f-(g.top-d)+'px'},_onTouchEnd:function(a){if(clearTimeout(this._startReorderTimeout),this._reorderGhost){a.preventDefault();var b=new CustomEvent('dragend',{bubbles:!0});this.dispatchEvent(b),this._reorderGhost.style.visibility='hidden',this._reorderGhost=null}},_contentFromPoint:function(a,b){if(Polymer.Settings.useShadow){var c=this.target.$.scroller;c.toggleAttribute('no-content-pointer-events',!0);var d=this.domHost.root.elementFromPoint(a,b);if(c.toggleAttribute('no-content-pointer-events',!1),d&&d.getContentChildren)return d.getContentChildren(Polymer.Element?'slot':'content')[0]}else return document.elementFromPoint(a,b)},_getGhost:function(){var a=this.target.$.scroller.$.reorderghost;a.innerText=this._cellContent.innerText;var b=window.getComputedStyle(this._cellContent);return['boxSizing','display','width','height','background','alignItems','padding','border','flex-direction','overflow'].forEach(function(c){a.style[c]=b[c]},this),a},_enableDrag:function(){this._cellContent.draggable=this.target.columnReorderingAllowed&&!window.getSelection().toString()},_disableDrag:function(){this._cellContent.draggable=!1},_cancelMouseDownOnResize:function(a){a.target===this._resizeHandle&&a.preventDefault()},_resizableChanged:function(a){a?(this._resizeHandle=document.createElement('div'),this._resizeHandle.classList.add('vaadin-grid-column-resize-handle'),this.listen(this._resizeHandle,'track','_onTrack'),Polymer.dom(this).appendChild(this._resizeHandle)):this._resizeHandle&&(this.unlisten(this._resizeHandle,'track','_onTrack'),Polymer.dom(this).removeChild(this._resizeHandle))},_onTrack:function(a){this.columnResizing=!0;var b=this.column;'vaadin-grid-column-group'===b.localName&&(b=Array.prototype.slice.call(b._childColumns,0).sort(function(c,a){return c._order-a._order}).filter(function(a){return!a.hidden}).pop());var c=this._getHeaderCellByColumn(b);if(c.offsetWidth){var d=window.getComputedStyle(c._cellContent),e=10+parseInt(d.paddingLeft)+parseInt(d.paddingRight);b.width=Math.max(e,c.offsetWidth+a.detail.x-c.getBoundingClientRect().right)+'px',b.flexGrow=0}var f=this.parentElement.parentElement;Array.prototype.slice.call(Polymer.dom(f).querySelectorAll('.vaadin-grid-row:last-child .vaadin-grid-cell')).sort(function(c,a){return c.column._order-a.column._order}).forEach(function(a,b,d){b<d.indexOf(c)&&(a.column.width=a.offsetWidth+'px',a.column.flexGrow=0)}),this.columnResizing&&'end'===a.detail.state&&(this.columnResizing=!1),this.fire('column-resizing')},_getHeaderCellByColumn:function(a){var b=this.parentElement.parentElement;return Array.prototype.filter.call(Polymer.dom(b).querySelectorAll('.vaadin-grid-row:last-child .vaadin-grid-cell'),function(b){return b.column===a})[0]},_headerTemplateChanged:function(a){void 0===a||(null!==a&&(this._isColumnRow||'vaadin-grid-column-group'===this.column.localName)?(this.instance=a.templatizer.createInstance(),this._templatizer=a.templatizer,this._isEmpty=!1):(this.instance={root:document.createElement('div')},this._isEmpty=!0))},_isEmptyChanged:function(a,b){b&&this.fire('cell-empty-changed')}}),Polymer({is:'vaadin-grid-table-footer-cell',properties:{footerTemplate:Object},behaviors:[a,vaadin.elements.grid.CellClickBehavior],observers:['_footerTemplateChanged(footerTemplate)','_isEmptyChanged(_isEmpty, isAttached)'],_footerTemplateChanged:function(a){void 0===a||(null!==a&&(this._isColumnRow||'vaadin-grid-column-group'===this.column.localName)?(this.instance=a.templatizer.createInstance(),this._templatizer=a.templatizer,this._isEmpty=!1):(this.instance={root:document.createElement('div')},this._isEmpty=!0))},_isEmptyChanged:function(a,b){b&&this.fire('cell-empty-changed')}}),Polymer({is:'vaadin-grid-sizer-cell',behaviors:[a]})})();</script></body></html>