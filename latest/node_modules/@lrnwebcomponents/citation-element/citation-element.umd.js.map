{"version":3,"file":"citation-element.umd.js","sources":["citation-element.umd.js"],"sourcesContent":["import { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\nimport \"@lrnwebcomponents/hax-body-behaviors/lib/HAXWiring.js\";\nimport \"@lrnwebcomponents/schema-behaviors/schema-behaviors.js\";\n/**\n `citation-element`\n An element dedicated to presenting and managing a correct citation on the web\n both visually as well as semantically with simple inputs.\n\n@demo demo/index.html\n\n@microcopy - the mental model for this element\n -\n -\n\n*/\nlet CitationElement = Polymer({\n  _template: html`\n    <style>\n      :host {\n        display: block;\n        color: var(\"--license-text-color\");\n      }\n      :host([display-method=\"footnote\"]) {\n        visibility: hidden;\n        opacity: 0;\n      }\n      :host([display-method=\"popup\"]) {\n        display: block;\n      }\n      .license-link {\n        font-size: 16px;\n        line-height: 16px;\n        font-style: italic;\n      }\n      .citation-date {\n        font-size: 16px;\n        line-height: 16px;\n        font-style: italic;\n      }\n      .license-link img {\n        height: 16px;\n        min-width: 16px;\n        margin-right: 8px;\n      }\n    </style>\n    <meta\n      about\\$=\"[[relatedResource]]\"\n      property=\"cc:attributionUrl\"\n      content\\$=\"[[source]]\"\n    />\n    <meta\n      about\\$=\"[[relatedResource]]\"\n      property=\"cc:attributionName\"\n      typeof=\"oer:Text\"\n      content\\$=\"[[title]]\"\n    />\n    <meta\n      rel=\"cc:license\"\n      href\\$=\"[[licenseLink]]\"\n      content\\$=\"License: [[licenseName]]\"\n    />\n    <cite\n      ><a target=\"_blank\" href=\"[[source]]\">[[title]]</a> by [[creator]],\n      licensed under\n      <a class=\"license-link\" target=\"_blank\" href=\"[[licenseLink]]\"\n        ><img\n          alt=\"[[licenseName]] graphic\"\n          src=\"[[licenseImage]]\"\n          hidden&=\"[[!licenseImage]]\"\n        />[[licenseName]]</a\n      >. Accessed <span class=\"citation-date\">[[date]]</span>.</cite\n    >\n  `,\n\n  is: \"citation-element\",\n\n  behaviors: [HAXBehaviors.PropertiesBehaviors, SchemaBehaviors.Schema],\n\n  properties: {\n    /**\n     * Title of the work.\n     */\n    title: {\n      type: String\n    },\n    /**\n     * License scope\n     */\n    scope: {\n      type: String,\n      value: \"sibling\",\n      observer: \"_scopeChanged\"\n    },\n    /**\n     * How to present the citation on the interface.\n     * Can be popup, footnote, or default behavior which is visible\n     */\n    displayMethod: {\n      type: String,\n      reflectToAttribute: true\n    },\n    /**\n     * Person or group that owns / created the work.\n     */\n    creator: {\n      type: String\n    },\n    /**\n     * Original Source of the work in question\n     */\n    source: {\n      type: String\n    },\n    /**\n     * Date the work was accessed.\n     */\n    date: {\n      type: String\n    },\n    /**\n     * License name, calculated or supplied by the end user if we don't have them.\n     */\n    licenseName: {\n      type: String\n    },\n    /**\n     * License link for more details\n     */\n    licenseLink: {\n      type: String\n    },\n    /**\n     * License short hand. Options cc0,\n     */\n    license: {\n      type: String,\n      observer: \"_licenseUpdated\"\n    },\n    /**\n     * About link for semantic meaning\n     */\n    _aboutLink: {\n      type: Object,\n      computed: \"_generateAboutLink(relatedResource, licenseLink)\"\n    },\n    /**\n     * License link object for semantic meaning\n     */\n    _licenseLink: {\n      type: Object,\n      computed: \"_generateLicenseLink(source)\"\n    }\n  },\n  /**\n   * Generate a license link whenever we have a source\n   * @param {href} source\n   */\n  _generateLicenseLink(source) {\n    // remove existing if this is moving around\n    if (this._licenseLink) {\n      document.head.removeChild(this._licenseLink);\n    }\n    let link = document.createElement(\"link\");\n    link.setAttribute(\"typeof\", \"resource\");\n    link.setAttribute(\"rel\", \"license\");\n    link.setAttribute(\"src\", source);\n\n    document.head.appendChild(link);\n    return link;\n  },\n  /**\n   * Generate an about link whenever we have a related resource and license link\n   * @param {uuid / id} relatedResource\n   * @param {href} licenseLink\n   */\n  _generateAboutLink(relatedResource, licenseLink) {\n    // remove existing if this is moving around\n    if (this._aboutLink) {\n      document.head.removeChild(this._aboutLink);\n    }\n    let link = document.createElement(\"link\");\n    link.setAttribute(\"about\", relatedResource);\n    link.setAttribute(\"property\", \"cc:license\");\n    link.setAttribute(\"content\", licenseLink);\n    document.head.appendChild(link);\n    return link;\n  },\n  /**\n   * Notice scope change.\n   */\n  _scopeChanged: function(newValue, oldValue) {\n    // make sure we actually have a sibling first\n    if (newValue === \"sibling\" && dom(this).previousElementSibling !== null) {\n      // find the sibling element in the DOM and associate to it's resource ID\n      // also generate a resource ID if it doesn't have one\n      if (dom(this).previousElementSibling.getAttribute(\"resource\")) {\n        this.relatedResource = dom(this).previousElementSibling.getAttribute(\n          \"resource\"\n        );\n      } else {\n        let uuid = this.generateResourceID();\n        this.relatedResource = uuid;\n        dom(this).previousElementSibling.setAttribute(\"resource\", uuid);\n      }\n      // set prefix on the main element itself\n      dom(this).previousElementSibling.setAttribute(\n        \"prefix\",\n        this.getAttribute(\"prefix\")\n      );\n    } else if (newValue === \"parent\") {\n      // find the parent and associate to it's resource ID, if it doesn't have one\n      // then let's make one dynamically\n      if (dom(this).parentNode.getAttribute(\"resource\")) {\n        this.relatedResource = dom(this).parentNode.getAttribute(\"resource\");\n      } else {\n        let uuid = this.generateResourceID();\n        this.relatedResource = uuid;\n        dom(this).parentNode.setAttribute(\"resource\", uuid);\n      }\n      // set prefix on the main element itself\n      dom(this).parentNode.setAttribute(\"prefix\", this.getAttribute(\"prefix\"));\n    }\n  },\n\n  /**\n   * Attached to the DOM, now fire.\n   */\n  attached: function() {\n    // Establish hax property binding\n    let props = {\n      canScale: false,\n      canPosition: false,\n      canEditSource: false,\n      gizmo: {\n        title: \"Citation\",\n        description: \"A basic citation element with 3 presentation modes\",\n        icon: \"editor:title\",\n        color: \"grey\",\n        groups: [\"Content\", \"Text\", \"Copyright\"],\n        handles: [\n          {\n            type: \"citation\",\n            source: \"source\",\n            title: \"title\",\n            author: \"creator\",\n            license: \"license\",\n            accessDate: \"date\"\n          },\n          {\n            type: \"inline\",\n            text: \"title\"\n          }\n        ],\n        meta: {\n          author: \"LRNWebComponents\"\n        }\n      },\n      settings: {\n        quick: [\n          {\n            property: \"title\",\n            title: \"Title\",\n            description: \"The title of the work being cited.\",\n            inputMethod: \"textfield\",\n            icon: \"editor:title\"\n          }\n        ],\n        configure: [\n          {\n            property: \"title\",\n            title: \"Title\",\n            description: \"The title of the work being cited.\",\n            inputMethod: \"textfield\",\n            icon: \"editor:title\"\n          },\n          {\n            property: \"source\",\n            title: \"Source link\",\n            description: \"The source url for the element this is citing.\",\n            inputMethod: \"textfield\",\n            icon: \"link\",\n            validationType: \"url\"\n          },\n          {\n            property: \"date\",\n            title: \"Date accessed\",\n            description: \"The date this was accessed.\",\n            inputMethod: \"textfield\",\n            icon: \"link\"\n          },\n          {\n            property: \"scope\",\n            title: \"Scope\",\n            description: \"Scope of what to cite.\",\n            inputMethod: \"select\",\n            options: {\n              sibling: \"Sibling element\",\n              parent: \"Parent element\"\n            },\n            icon: \"code\"\n          },\n          {\n            property: \"license\",\n            title: \"License\",\n            description: \"The source url for the element this is citing.\",\n            inputMethod: \"select\",\n            options: this.licenseList(\"select\"),\n            icon: \"link\"\n          },\n          {\n            property: \"creator\",\n            title: \"Creator\",\n            description: \"Who made or owns this.\",\n            inputMethod: \"textfield\",\n            icon: \"link\"\n          }\n        ],\n        advanced: []\n      }\n    };\n    this.setHaxProperties(props);\n  },\n\n  /**\n   * A list of licenses that we support the references for.\n   */\n  licenseList: function(mode = \"full\") {\n    // initial list, PR to add more\n    let list = {\n      by: {\n        name: \"Attribution\",\n        link: \"https://creativecommons.org/licenses/by/4.0/\",\n        image: \"https://i.creativecommons.org/l/by/4.0/88x31.png\"\n      },\n      \"by-sa\": {\n        name: \"Attribution Share a like\",\n        link: \"https://creativecommons.org/licenses/by-sa/4.0/\",\n        image: \"https://i.creativecommons.org/l/by-sa/4.0/88x31.png\"\n      },\n      \"by-nd\": {\n        name: \"Attribution No derivatives\",\n        link: \"https://creativecommons.org/licenses/by-nd/4.0/\",\n        image: \"https://i.creativecommons.org/l/by-nd/4.0/88x31.png\"\n      },\n      \"by-nc\": {\n        name: \"Attribution non-commercial\",\n        link: \"https://creativecommons.org/licenses/by-nc/4.0/\",\n        image: \"https://i.creativecommons.org/l/by-nc/4.0/88x31.png\"\n      },\n      \"by-nc-sa\": {\n        name: \"Attribution non-commercial share a like\",\n        link: \"https://creativecommons.org/licenses/by-nc-sa/4.0/\",\n        image: \"https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png\"\n      },\n      \"by-nc-nd\": {\n        name: \"Attribution Non-commercial No derivatives\",\n        link: \"https://creativecommons.org/licenses/by-nc-nd/4.0/\",\n        image: \"https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png\"\n      }\n    };\n    // support mutating the array into a select list\n    if (mode == \"select\") {\n      var select = {};\n      for (var i in list) {\n        select[i] = list[i].name;\n      }\n      return select;\n    }\n    return list;\n  },\n\n  /**\n   * License was updated, time to update license name and link.\n   */\n  _licenseUpdated: function(newValue, oldValue) {\n    if (typeof newValue !== typeof undefined) {\n      var list = this.licenseList();\n      if (typeof list[newValue] !== typeof undefined) {\n        this.licenseName = list[newValue].name;\n        this.licenseLink = list[newValue].link;\n        this.licenseImage = list[newValue].image;\n      }\n    }\n  }\n});\nexport { CitationElement };\n"],"names":["CitationElement","Polymer","_template","html","is","behaviors","HAXBehaviors","PropertiesBehaviors","SchemaBehaviors","Schema","properties","title","type","String","scope","value","observer","displayMethod","reflectToAttribute","creator","source","date","licenseName","licenseLink","license","_aboutLink","Object","computed","_licenseLink","_generateLicenseLink","this","document","head","removeChild","link","createElement","setAttribute","appendChild","_generateAboutLink","relatedResource","_scopeChanged","newValue","oldValue","dom","previousElementSibling","getAttribute","uuid","generateResourceID","parentNode","attached","props","canScale","canPosition","canEditSource","gizmo","description","icon","color","groups","handles","author","accessDate","text","meta","settings","quick","property","inputMethod","configure","validationType","options","sibling","parent","licenseList","advanced","setHaxProperties","list","by","name","image","select","i","_licenseUpdated","_typeof","licenseImage"],"mappings":"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"}