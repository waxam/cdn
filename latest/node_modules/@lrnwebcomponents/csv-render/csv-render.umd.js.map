{"version":3,"file":"csv-render.umd.js","sources":["csv-render.umd.js"],"sourcesContent":["/**\n * Copyright 2018 The Pennsylvania State University\n * @license Apache-2.0, see License.md for full text.\n */\nimport { html, Polymer } from \"@polymer/polymer/polymer-legacy.js\";\nimport \"@polymer/iron-ajax/iron-ajax.js\";\nimport \"@polymer/paper-button/paper-button.js\";\nimport \"@polymer/paper-spinner/paper-spinner.js\";\nimport \"@polymer/iron-icons/iron-icons.js\";\nimport \"@polymer/iron-icon/iron-icon.js\";\nimport \"@polymer/paper-tooltip/paper-tooltip.js\";\nimport \"@lrnwebcomponents/materializecss-styles/materializecss-styles.js\";\n/**\n * `csv-render`\n * `Remote render a CSV file in place as an accessible table.`\n *\n * @microcopy - language worth noting:\n *  - CSV is comma separated values\n *\n * @customElement\n * @polymer\n * @polymerLegacy\n * @demo demo/index.html\n */\nlet CsvRender = Polymer({\n  _template: html`\n    <style include=\"materializecss-styles-colors\"></style>\n    <style>\n      :host {\n        display: block;\n      }\n      .mdl-data-table {\n        width: 100%;\n        /*position: relative;*/\n        border: 1px solid rgba(0, 0, 0, 0.12);\n        border-collapse: collapse;\n        white-space: nowrap;\n        font-size: 16px;\n        background-color: rgb(255, 255, 255);\n      }\n      .mdl-data-table thead {\n        padding-bottom: 0.16px;\n        position: sticky;\n      }\n      .mdl-data-table caption {\n        background-color: #eee;\n        font-weight: bold;\n        padding: 8px;\n        border: 1px solid rgba(0, 0, 0, 0.12);\n        border-bottom: none;\n      }\n      .mdl-data-table thead th {\n        text-align: center;\n      }\n      .mdl-data-table thead .mdl-data-table__select {\n        margin-top: 0;\n      }\n      .mdl-data-table tbody tr {\n        position: relative;\n        height: 48px;\n        -webkit-transition-duration: 0.28s;\n        transition-duration: 0.28s;\n        -webkit-transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n        transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n        -webkit-transition-property: background-color;\n        transition-property: background-color;\n      }\n      .mdl-data-table tbody tr.is-selected {\n        background-color: #e0e0e0;\n      }\n      .mdl-data-table tbody tr:hover {\n        background-color: #eeeeee;\n      }\n      .mdl-data-table td,\n      .mdl-data-table th {\n        padding: 0 1.125em;\n        text-align: right;\n      }\n      .mdl-data-table td:first-of-type,\n      .mdl-data-table th:first-of-type {\n        padding-left: 24px;\n      }\n      .mdl-data-table td:last-of-type,\n      .mdl-data-table th:last-of-type {\n        padding-right: 24px;\n      }\n      .mdl-data-table td {\n        border-top: 1px solid rgba(0, 0, 0, 0.12);\n        border-bottom: 1px solid rgba(0, 0, 0, 0.12);\n      }\n      .mdl-data-table td .mdl-data-table__select {\n        vertical-align: top;\n        position: absolute;\n        left: 24px;\n      }\n      .mdl-data-table th.mdl-data-table__sort {\n        color: rgba(0, 0, 0, 0.87);\n      }\n      .mdl-data-table th {\n        position: relative;\n        vertical-align: bottom;\n        text-overflow: ellipsis;\n        font-size: 16px;\n        font-weight: bold;\n        line-height: 24px;\n        letter-spacing: 0;\n        color: rgba(0, 0, 0, 0.54);\n        height: 48px;\n        padding-bottom: 8px;\n        box-sizing: border-box;\n      }\n      .mdl-data-table th .mdl-data-table__select {\n        position: relative;\n      }\n      .mdl-data-table__select {\n        width: 16px;\n      }\n      .mdl-data-table td.mdl-data-table__cell--non-numeric {\n        text-align: left;\n      }\n      .mdl-data-table th.mdl-data-table__cell--non-numeric {\n        text-align: left;\n      }\n      #loading {\n        position: absolute;\n        width: 100px;\n        height: 100px;\n        transition: 1.2s all linear;\n        opacity: 0;\n      }\n      #loading[active] {\n        visibility: visible;\n        opacity: 1;\n      }\n      #download paper-button {\n        border-radius: 36px;\n        width: 36px;\n        height: 36px;\n        min-width: unset;\n        padding: 0;\n        margin: 0;\n        display: inline-flex;\n      }\n      iron-icon {\n        display: inline-flex;\n        margin: 0;\n        padding: 0;\n      }\n      #download paper-button:focus,\n      #download paper-button:active {\n        outline: 2px solid grey;\n      }\n    </style>\n    <iron-ajax\n      auto=\"\"\n      url=\"[[dataSource]]\"\n      handle-as=\"text\"\n      last-response=\"{{tableData}}\"\n      on-response=\"handleResponse\"\n    ></iron-ajax>\n    <paper-spinner id=\"loading\" active=\"\"></paper-spinner>\n    <a href=\"[[dataSource]]\" id=\"download\" tabindex=\"-1\">\n      <paper-button class=\"grey-text\"\n        ><iron-icon icon=\"file-download\"></iron-icon\n      ></paper-button> </a\n    ><paper-tooltip for=\"download\" animation-delay=\"200\" offset=\"14\"\n      >Download table data</paper-tooltip\n    >\n    <table class=\"mdl-data-table\" summary=\"[[summary]]\">\n      <template is=\"dom-if\" if=\"[[caption]]\">\n        <caption>\n          [[caption]]\n        </caption>\n      </template>\n      <thead>\n        <tr>\n          <template is=\"dom-repeat\" items=\"[[tableHeadings]]\" as=\"heading\">\n            <th scope=\"col\">[[heading]]</th>\n          </template>\n        </tr>\n      </thead>\n      <tbody>\n        <template is=\"dom-repeat\" items=\"[[table]]\" as=\"row\">\n          <tr>\n            <template is=\"dom-repeat\" items=\"[[row]]\" as=\"col\">\n              <td>[[col]]</td>\n            </template>\n          </tr>\n        </template>\n      </tbody>\n    </table>\n  `,\n\n  is: \"csv-render\",\n\n  properties: {\n    /**\n     * Location of the CSV file.\n     */\n    dataSource: {\n      type: String\n    },\n    /**\n     * Caption for the table to improve accessibility and readability.\n     */\n    caption: {\n      type: String,\n      reflectToAttribute: true\n    },\n    /**\n     * Summary to improve accessibility for screen readers.\n     */\n    summary: {\n      type: String,\n      reflectToAttribute: true\n    },\n    /**\n     * Table busted out as an array.\n     */\n    table: {\n      type: Array,\n      value: []\n    },\n    /**\n     * Headings from the first row of the csv\n     */\n    tableHeadings: {\n      type: Array,\n      value: []\n    },\n    /**\n     * Raw data pulled in from the csv file.\n     */\n    tableData: {\n      type: String,\n      value: \"\"\n    }\n  },\n\n  /**\n   * Convert from csv text to an array in the table function\n   */\n  handleResponse: function(e) {\n    this.table = this.CSVtoArray(this.tableData);\n    this.tableHeadings = this.table.shift();\n    this.$.loading.active = false;\n  },\n\n  /**\n   * Mix of solutions from https://stackoverflow.com/questions/8493195/how-can-i-parse-a-csv-string-with-javascript-which-contains-comma-in-data\n   */\n  CSVtoArray: function(text) {\n    let p = \"\",\n      row = [\"\"],\n      ret = [row],\n      i = 0,\n      r = 0,\n      s = !0,\n      l;\n    for (l in text) {\n      l = text[l];\n      if ('\"' === l) {\n        if (s && l === p) row[i] += l;\n        s = !s;\n      } else if (\",\" === l && s) l = row[++i] = \"\";\n      else if (\"\\n\" === l && s) {\n        if (\"\\r\" === p) row[i] = row[i].slice(0, -1);\n        row = ret[++r] = [(l = \"\")];\n        i = 0;\n      } else row[i] += l;\n      p = l;\n    }\n    return ret;\n  }\n});\nexport { CsvRender };\n"],"names":["CsvRender","Polymer","_template","html","is","properties","dataSource","type","String","caption","reflectToAttribute","summary","table","Array","value","tableHeadings","tableData","handleResponse","e","this","CSVtoArray","shift","$","loading","active","text","l","p","row","ret","i","r","s","slice"],"mappings":"8yLAwBIA,EAAYC,UAAQ,CACtBC,UAAWC,YAwKXC,GAAI,aAEJC,WAAY,CAIVC,WAAY,CACVC,KAAMC,QAKRC,QAAS,CACPF,KAAMC,OACNE,oBAAoB,GAKtBC,QAAS,CACPJ,KAAMC,OACNE,oBAAoB,GAKtBE,MAAO,CACLL,KAAMM,MACNC,MAAO,IAKTC,cAAe,CACbR,KAAMM,MACNC,MAAO,IAKTE,UAAW,CACTT,KAAMC,OACNM,MAAO,KAOXG,eAAgB,SAASC,QAClBN,MAAQO,KAAKC,WAAWD,KAAKH,gBAC7BD,cAAgBI,KAAKP,MAAMS,aAC3BC,EAAEC,QAAQC,QAAS,GAM1BJ,WAAY,SAASK,OAOjBC,EANEC,EAAI,GACNC,EAAM,CAAC,IACPC,EAAM,CAACD,GACPE,EAAI,EACJC,EAAI,EACJC,GAAI,MAEDN,KAAKD,EAEJ,OADJC,EAAID,EAAKC,KAEHM,GAAKN,IAAMC,IAAGC,EAAIE,IAAMJ,GAC5BM,GAAKA,GACI,MAAQN,GAAKM,EAAGN,EAAIE,IAAME,GAAK,GACjC,OAASJ,GAAKM,GACjB,OAASL,IAAGC,EAAIE,GAAKF,EAAIE,GAAGG,MAAM,GAAI,IAC1CL,EAAMC,IAAME,GAAK,CAAEL,EAAI,IACvBI,EAAI,GACCF,EAAIE,IAAMJ,EACjBC,EAAID,SAECG"}