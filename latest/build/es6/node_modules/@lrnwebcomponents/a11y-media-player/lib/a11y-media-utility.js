import{html,Polymer}from"@polymer/polymer/polymer-legacy.js";import"@polymer/iron-resizable-behavior/iron-resizable-behavior.js";window.A11yMediaUtility={},Polymer({is:"a11y-media-utility",properties:{players:{type:Array,value:[]},stickyPlayer:{type:Object,value:null}},created:function(){let a=this;this.__playerLoader=function(b){a.players.push(b.detail)},window.A11yMediaUtility.instance||(window.A11yMediaUtility.instance=this,document.body.addEventListener("a11y-player",a.__playerLoader))},attached:function(){let a=this;this.__stickyManager=function(b){a.setStickyPlayer(b.detail)},this.__scrollChecker=function(){a._checkScroll()},document.body.addEventListener("a11y-player-playing",a.__stickyManager),window.addEventListener("scroll",a.__scrollChecker)},detached:function(){let a=this;document.body.removeEventListener("a11y-player",a.__playerLoader),document.body.removeEventListener("a11y-player-playing",a.__stickyManager),window.removeEventListener("scroll",a.__scrollChecker)},checkConcurrentPlayers:function(){let a=this,b=a.stickyPlayer;for(let d,c=0;c<a.players.length;c++)d=a.players[c],d===b||b.allowConcurrent&&d.allowConcurrent||d.pause()},checkConcurrentPlayers:function(){let a=this,b=a.stickyPlayer;for(let d,c=0;c<a.players.length;c++)d=a.players[c],d===b||b.allowConcurrent&&d.allowConcurrent||d.pause()},setStickyPlayer:function(a){let b=this,c=b._getParentNode(a);b.__playerTop=c.offsetTop,b.__playerUpperMiddle=b.__playerTop+0.9*c.offsetHeight,b.__playerLowerMiddle=b.__playerTop+0.1*c.offsetHeight,a!==b.stickyPlayer&&b.stickyPlayer!==void 0&&null!==b.stickyPlayer&&(b.stickyPlayer.toggleSticky(!1),b.__parent.style.height="unset"),c.style.height=c.offsetHeight+"px",b.__parent=c,b.stickyPlayer=a,a.allowConcurrent||b.checkConcurrentPlayers(),b._checkScroll()},_checkScroll:function(){let a=this,b=window.pageYOffset,c=b+window.innerHeight;a.stickyPlayer!==void 0&&null!==a.stickyPlayer&&(a.stickyPlayer.__playing&&(a.__playerLowerMiddle>c||a.__playerUpperMiddle<b)?a.stickyPlayer.toggleSticky(!0):a.stickyPlayer.toggleSticky(!1))},_getParentNode:function(a){let b=a.parentNode;return void 0!==b&&null!==b&&b.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&(b=b.host),b}}),window.A11yMediaUtility.instance=null,window.A11yMediaUtility.requestAvailability=function(){window.A11yMediaUtility.instance||(window.A11yMediaUtility.instance=document.createElement("a11y-media-utility")),document.body.appendChild(window.A11yMediaUtility.instance)};