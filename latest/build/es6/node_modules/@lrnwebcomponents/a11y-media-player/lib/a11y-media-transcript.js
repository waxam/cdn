import{html,Polymer}from"@polymer/polymer/polymer-legacy.js";import{SimpleColors}from"@lrnwebcomponents/simple-colors/simple-colors.js";import{dom}from"@polymer/polymer/lib/legacy/polymer.dom.js";import"@lrnwebcomponents/responsive-utility/responsive-utility.js";import"./a11y-media-behaviors.js";import"./a11y-media-transcript-cue.js";Polymer({_template:html`
    <style is="custom-style" include="simple-colors">
      :host {
        display: block;
        padding: 15px;
        color: var(--a11y-media-transcript-color);
        background-color: var(--a11y-media-transcript-bg-color);
      }

      :host([hidden]) {
        display: none;
      }
      :host #inner {
        width: 100%;
        display: none;
      }
      :host #inner[active] {
        display: table;
        width: 100%;
      }
      :host #inner[active][hideTimestamps] {
        display: block;
      }
      :host .sr-only:not(:focus) {
        position: absolute;
        left: -99999;
        top: 0;
        height: 0;
        width: 0;
        overflow: hidden;
      }
      @media print {
        :host {
          padding: 0 15px 5px;
          color: #000;
          background-color: #ffffff;
          border-top: 1px solid #aaa;
        }
      }
    </style>
    <a id="transcript-desc" href="#bottom" class="sr-only"
      >[[skipTranscriptLink]]</a
    >
    <template id="tracks" is="dom-repeat" items="{{tracks}}" as="track">
      <div
        id="inner"
        class="transcript-from-track"
        lang="{{track.language}}"
        active\$="[[track.active]]"
      >
        <template is="dom-repeat" items="{{track.cues}}" as="cue">
          <a11y-media-transcript-cue
            accent-color\$="[[accentColor]]"
            active-cues\$="[[activeCues]]"
            controls\$="[[mediaId]]"
            cue\$="{{cue}}"
            disabled\$="[[disableInteractive]]"
            disable-search\$="[[disableSearch]]"
            hide-timestamps\$="[[hideTimestamps]]"
            order\$="{{cue.order}}"
            role="button"
            search="[[search]]"
            tabindex="0"
          >
          </a11y-media-transcript-cue>
        </template>
      </div>
    </template>
    <div id="bottom" class="sr-only"></div>
  `,is:"a11y-media-transcript",listeners:{"cue-seek":"_onCueSeek"},behaviors:[SimpleColors,a11yMediaBehaviors.GeneralFunctions,a11yMediaBehaviors.TranscriptBehaviors],properties:{activeCues:{type:Array,value:null,reflectToAttribute:!0,notify:!0},lang:{type:String,value:"en",reflectToAttribute:!0},mediaId:{type:String,value:null},tabIndex:{type:Number,computed:"_getTabIndex(disableInteractive)"},role:{type:Number,computed:"_getRole(disableInteractive)"},selectedTranscript:{type:String,value:"0"},tracks:{type:Array,value:null}},attached:function(){this.fire("transcript-ready",this)},setMedia:function(a){this.media=a,this.fire("transcript-ready",this)},toggleHidden:function(a){let b=this,c=document.getElementById("inner"),d=null!==c&&c!==void 0?c.querySelector("a11y-media-transcript-cue[active]"):null,f=null!==c&&c!==void 0?c.querySelector("a11y-media-transcript-cue"):null;a=a===void 0?this.hidden:a,this.hidden=a},print:function(a){let b=this,c=b.shadowRoot.querySelector("#inner[active]");if(a=void 0===a?"Transcript":a,null!==c&void 0!==c){let f=window.open("","","left=0,top=0,width=552,height=477,toolbar=0,scrollbars=0,status =0"),g=dom(b).node;f.document.write("<style>"+"a11y-media-transcript-cue{display:table-row;background-color:#fff;color:#000}a11y-media-transcript-cue[hide-timestamps],a11y-media-transcript-cue[hide-timestamps] #text{display:inline}a11y-media-transcript-cue #text{display:table-cell;line-height:200%}a11y-media-transcript-cue #time{display:table-cell;font-size:80%;padding:0 16px;white-space:nowrap;font-family:monospace}a11y-media-transcript-cue[hide-timestamps] #time{display:none}a11y-media-transcript-cue [matched]{background-color:#fff;color:#eee;padding:.16px 4px;border-radius:.16px}"+"</style><h1>"+a+"</h1>"+c.innerHTML),f.document.close(),f.focus(),f.print(),f.close()}},setTracks:function(a){this.set("tracks",a.slice(0)),this.notifyPath("tracks"),this.tracks!==void 0&&0<this.tracks.length&&this.$.tracks.render()},setActiveCues:function(a){let b=this,c=null!==b.shadowRoot.querySelector("#inner")&&void 0!==b.shadowRoot.querySelector("#inner")?b.shadowRoot.querySelector("#inner").offsetTop:0,d=b.shadowRoot.querySelector("#inner a11y-media-transcript-cue[active]");if(b.set("activeCues",a.slice(0)),!b.disableScroll&&null!==d&void 0!==d){let f=function(g,h,j){if(!(0>=j)){var k=h-g.scrollTop;setTimeout(function(){g.scrollTop+=10*(k/j),g.scrollTop===h||f(g,h,j-10)},10)}};f(b,d.offsetTop-c,250)}},_getTabIndex:function(a){return a?-1:0},_getRole:function(a){return a?null:"button"},_onCueSeek:function(a){this.fire("transcript-seek",a.detail)},setActiveTranscript:function(a){if(this.tracks!==void 0&&null!==this.tracks)for(let b=0;b<this.tracks.length;b++)parseInt(a)===b?(this.selectedTranscript=parseInt(a),this.set("tracks."+b+".active",!0)):null!==this.tracks[b]&&this.set("tracks."+b+".active",!1),this.notifyPath("tracks."+b+".active");this.$.tracks.render()}});