var _templateObject=babelHelpers.taggedTemplateLiteral(["\n    <custom-style>\n      <style is=\"custom-style\" include=\"iron-flex iron-flex-alignment\">\n        div.layout {\n          height: auto;\n        }\n        #form {\n          display: block;\n          @apply --eco-json-schema-object-form;\n          @apply --layout-vertical;\n          @apply --layout-wrap;\n        }\n        #form ::slotted(paper-input) {\n          --paper-input-container-shared-input-style: {\n            border: none !important;\n            width: 100% !important;\n            background-color: transparent !important;\n          }\n        }\n      </style>\n    </custom-style>\n\n    <template is=\"dom-if\" if=\"{{!wizard}}\">\n      <div class=\"header\" hidden$=\"[[!label]]\">[[label]]</div>\n    </template>\n    <div class=\"layout vertical flex start-justified\">\n      <div id=\"form\" class=\"layout horizontal flex start-justified\">\n        <slot></slot>\n      </div>\n    </div>\n  "],["\n    <custom-style>\n      <style is=\"custom-style\" include=\"iron-flex iron-flex-alignment\">\n        div.layout {\n          height: auto;\n        }\n        #form {\n          display: block;\n          @apply --eco-json-schema-object-form;\n          @apply --layout-vertical;\n          @apply --layout-wrap;\n        }\n        #form ::slotted(paper-input) {\n          --paper-input-container-shared-input-style: {\n            border: none !important;\n            width: 100% !important;\n            background-color: transparent !important;\n          }\n        }\n      </style>\n    </custom-style>\n\n    <template is=\"dom-if\" if=\"{{!wizard}}\">\n      <div class=\"header\" hidden\\$=\"[[!label]]\">[[label]]</div>\n    </template>\n    <div class=\"layout vertical flex start-justified\">\n      <div id=\"form\" class=\"layout horizontal flex start-justified\">\n        <slot></slot>\n      </div>\n    </div>\n  "]);import{html,Polymer}from"@polymer/polymer/polymer-legacy.js";import{dom}from"@polymer/polymer/lib/legacy/polymer.dom.js";import"@polymer/iron-flex-layout/iron-flex-layout-classes.js";import{AppLocalizeBehavior}from"@polymer/app-localize-behavior/app-localize-behavior.js";import"./eco-json-schema-array.js";import"./eco-json-schema-boolean.js";import"./eco-json-schema-enum.js";import"./eco-json-schema-file.js";import"./eco-json-schema-input.js";Polymer({is:"eco-json-schema-object",_template:html(_templateObject),behaviors:[AppLocalizeBehavior],properties:{language:{value:"en"},resources:{value:function(){return{}}},schema:{type:Object,observer:"_schemaChanged"},label:{type:String},value:{type:Object,notify:!0,value:function(){return{}}},error:{type:Object,observer:"_errorChanged"},wizard:{type:Boolean,notify:!0}},detached:function(){this._clearForm()},_buildSchemaProperties:function(){var b=this;this._schemaProperties=Object.keys(this.schema.properties||[]).map(function(c){var d=b.schema.properties[c],e={property:c,label:d.title||c,schema:d,component:d.component||{}};if(e.component.valueProperty||(e.component.valueProperty="value"),e.component.slot||(e.component.slot=""),b._isSchemaEnum(d))e.component.name=e.component.name||"eco-json-schema-enum",babelHelpers.typeof(d.value)==="undefined"&&(d.value=""),e.value=d.value;else if(b._isSchemaBoolean(d.type))e.component.name=e.component.name||"eco-json-schema-boolean",babelHelpers.typeof(d.value)==="undefined"&&(d.value=!1),e.value=d.value;else if(b._isSchemaFile(d.type))e.component.name=e.component.name||"eco-json-schema-file",babelHelpers.typeof(d.value)==="undefined"&&(d.value={}),e.value=d.value;else if(b._isSchemaValue(d.type))e.component.name=e.component.name||"eco-json-schema-input",babelHelpers.typeof(d.value)==="undefined"&&(d.value=""),e.value=d.value;else if(b._isSchemaObject(d.type))e.component.name=e.component.name||"eco-json-schema-object",babelHelpers.typeof(d.value)==="undefined"&&(d.value={}),e.value=d.value;else if(b._isSchemaArray(d.type))e.component.name=e.component.name||"eco-json-schema-array",babelHelpers.typeof(d.value)==="undefined"&&(d.value=[]),e.value=d.value;else return console.error("Unknown property type %s",d.type);return e})},_schemaPropertyChanged:function(b,c){if(!(c.path&&/\.length$/.test(c.path))){var d=this,e=b.target.schemaProperty,f=["value",e.property];if(c.path&&/\.splices$/.test(c.path)){for(var g=c.path.split(".").slice(1,-1);g.length;)f.push(g.shift()),e.keyMap&&e.keyMap[f.join(".")]&&(f=e.keyMap[f.join(".")].split("."));c.value.keySplices&&e.keyMap&&c.value.keySplices.forEach(function(l){l.removed.forEach(function(m){delete e.keyMap[f.concat([m]).join(".")]})}),c.value&&c.value.indexSplices.forEach(function(l){var m=[f.join("."),l.index,l.removed.length];if(l.addedCount)for(var n=0,p=l.addedCount;n<p;n++)l.addedKeys&&l.addedKeys[n]&&(e.keyMap=e.keyMap||{},e.keyMap[f.concat([l.addedKeys[n]]).join(".")]=f.concat([n+l.index]).join(".")),m.push(d._deepClone(l.object[n+l.index]));d.splice.apply(d,m)})}else if(c.path){var g=c.path.split(".").slice(1),h=this.value;for(h.hasOwnProperty(e.property)||(this.set("value."+e.property,{}),this.notifyPath("value."+e.property));g.length;){var j=g.shift();f.push(j),e.keyMap&&e.keyMap[f.join(".")]&&(f=e.keyMap[f.join(".")].split("."))}this.set(f.join("."),this._deepClone(c.value)),this.notifyPath(f.join("."))}else e.value=c.value,this.set(f,this._deepClone(c.value)),this.notifyPath(f)}},_setValue:function(){var b=this,c={};this._schemaProperties.forEach(function(d){babelHelpers.typeof(d.value)!=="undefined"&&(c[d.property]=b._deepClone(d.value))}),this.value=c},_buildForm:function(){var b=this,c=this;this._schemaProperties.forEach(function(d){var e=c.create(d.component.name,{label:d.label,schema:d.schema,schemaProperty:d,language:b.language,resources:b.resources});for(var f in"paper-input"===d.component.name&&(e.style["background-color"]="transparent",e.style.width="100%"),e.setAttribute("name",d.property),e.className="flex start-justified",e[d.component.valueProperty]=d.value,d.component.attributes)e.setAttribute(f,d.component.attributes[f]);for(var g in d.component.properties)e[g]=d.component.properties[g];if(c.listen(e,d.component.valueProperty.replace(/([A-Z])/g,"-$1").toLowerCase()+"-changed","_schemaPropertyChanged"),babelHelpers.typeof(c.$)!=="undefined"&&dom(b).appendChild(e),""!=d.component.slot){var h=document.createElement("template");h.innerHTML=d.component.slot,dom(e).appendChild(h)}})},_removePropertyEl:function(b){babelHelpers.typeof(b.schemaProperty)!=="undefined"&&this.unlisten(b,b.schemaProperty.component.valueProperty.replace(/([A-Z])/g,"-$1").toLowerCase()+"-changed","_schemaPropertyChanged"),b.schemaProperty=null,dom(this).removeChild(b)},_clearForm:function(){if(babelHelpers.typeof(this.$)!=="undefined")for(var b=dom(this);b.firstChild;)this._removePropertyEl(b.firstChild)},_schemaChanged:function(b,c){b&&("undefined"===typeof c?"undefined":babelHelpers.typeof(c))!=="undefined"&&(this._clearForm(),this._buildSchemaProperties(),this._buildForm(),this._setValue())},_errorChanged:function(){var b=this;dom(this).childNodes.forEach(function(c){var d=c.getAttribute("name");c.error=b.error&&b.error[d]?b.error[d]:null})},_deepClone:function(b){return JSON.parse(JSON.stringify(b))},_isSchemaValue:function(b){return this._isSchemaBoolean(b)||this._isSchemaNumber(b)||this._isSchemaString(b)||this._isSchemaFile(b)},_isSchemaFile:function(b){return Array.isArray(b)?-1!==b.indexOf("file"):"file"===b},_isSchemaBoolean:function(b){return Array.isArray(b)?-1!==b.indexOf("boolean"):"boolean"===b},_isSchemaEnum:function(b){return!!b.enum},_isSchemaNumber:function(b){return Array.isArray(b)?-1!==b.indexOf("number")||-1!==b.indexOf("integer"):"number"===b||"integer"===b},_isSchemaString:function(b){return Array.isArray(b)?-1!==b.indexOf("string"):"string"===b},_isSchemaObject:function(b){return"object"===b},_isSchemaArray:function(b){return"array"===b}});