var _templateObject=babelHelpers.taggedTemplateLiteral(["\n    <style is=\"custom-style\" include=\"simple-colors\">\n      app-toolbar {\n        background-color: #3a0063;\n        color: #ffffff;\n      }\n      paper-icon-button {\n        --paper-icon-button-ink-color: #ffffff;\n      }\n      paper-icon-button + [main-title] {\n        margin-left: 24px;\n      }\n      app-header {\n        @apply --layout-fixed-top;\n        color: #ffffff;\n        --app-header-background-rear-layer: {\n          background-color: #ef6c00;\n        }\n      }\n      app-drawer {\n        --app-drawer-scrim-background: rgba(0, 0, 0, 0.6);\n        --app-drawer-content-container: {\n          background-color: rgba(93, 0, 159, 0.8);\n          overflow: scroll;\n          color: #ffffff;\n          padding-left: 8px;\n          padding-right: 8px;\n        }\n      }\n      sites-listing {\n        display: block;\n        margin: 100px 16px 0px 16px;\n      }\n      paper-dialog {\n        width: 60%;\n        min-height: 50%;\n        top: 10%;\n        border-radius: 16px;\n      }\n      paper-input {\n        --paper-input-container-focus-color: #3a0063;\n      }\n      #closedrawer {\n        float: left;\n        margin: 12px -20px 0 8px;\n      }\n      #add {\n        float: right;\n        margin: 12px 8px 0 -20px;\n      }\n      #newsitecolor {\n        padding: 4px;\n        margin: 0;\n        display: inline-flex;\n        vertical-align: middle;\n      }\n      #newsitecolor > * {\n        display: inline-flex;\n        align-self: center;\n        margin-right: 8px;\n        --simple-colors-picker-preview-size: 20px;\n      }\n    </style>\n    <jwt-login\n      id=\"jwt\"\n      url=\"[[basePath]]system/login.php\"\n      logout-url=\"[[basePath]]system/logout.php\"\n      jwt=\"{{jwt}}\"\n    ></jwt-login>\n    <iron-ajax\n      id=\"createrequest\"\n      method=\"POST\"\n      body=\"[[createParams]]\"\n      headers=\"{&quot;Authorization&quot;: &quot;Bearer [[jwt]]&quot;}\"\n      content-type=\"application/json\"\n      url=\"[[basePath]]system/createNewSite.php\"\n      handle-as=\"json\"\n      on-response=\"handleCreateResponse\"\n    ></iron-ajax>\n    <iron-ajax\n      id=\"downloadrequest\"\n      method=\"POST\"\n      body=\"[[downloadParams]]\"\n      headers=\"{&quot;Authorization&quot;: &quot;Bearer [[jwt]]&quot;}\"\n      content-type=\"application/json\"\n      url=\"[[basePath]]system/downloadSite.php\"\n      handle-as=\"json\"\n      on-response=\"handleDownloadResponse\"\n    ></iron-ajax>\n    <sites-listing\n      id=\"siteslisting\"\n      sites-response=\"{{__sitesResponse}}\"\n      sites=\"{{__sites}}\"\n      data-source=\"[[dataSource]]\"\n      edit-mode=\"[[editMode]]\"\n    ></sites-listing>\n    <app-header reveals>\n      <app-toolbar>\n        <paper-icon-button\n          icon=\"menu\"\n          on-tap=\"drawerToggle\"\n        ></paper-icon-button>\n        <div main-title>[[title]]</div>\n        <paper-icon-button\n          on-tap=\"_editTap\"\n          id=\"edit\"\n          icon=\"[[__editIcon]]\"\n          hidden$=\"[[!loggedIn]]\"\n        ></paper-icon-button>\n        <paper-icon-button\n          on-tap=\"_loginUserRoutine\"\n          id=\"login\"\n          icon=\"[[__loginIcon]]\"\n        ></paper-icon-button>\n        <paper-tooltip\n          for=\"login\"\n          position=\"bottom\"\n          offset=\"12\"\n          animation-delay=\"200\"\n          >[[__loginText]]</paper-tooltip\n        >\n      </app-toolbar>\n    </app-header>\n    <app-drawer id=\"drawer\" swipe-open>\n      <paper-icon-button\n        id=\"closedrawer\"\n        icon=\"icons:close\"\n        on-tap=\"drawerToggle\"\n      ></paper-icon-button>\n      <paper-tooltip\n        for=\"closedrawer\"\n        position=\"bottom\"\n        offset=\"12\"\n        animation-delay=\"200\"\n        >Close</paper-tooltip\n      >\n      <paper-icon-button\n        on-tap=\"_addTap\"\n        id=\"add\"\n        icon=\"icons:add\"\n      ></paper-icon-button>\n      <paper-tooltip\n        for=\"add\"\n        position=\"bottom\"\n        offset=\"12\"\n        animation-delay=\"200\"\n        >Add site</paper-tooltip\n      >\n      <h3\n        style=\"margin: 18px; padding: 6px; border-bottom: 1px solid #ffffff; text-align: center; font-weight: normal;\"\n      >\n        Site list\n      </h3>\n      <map-menu\n        id=\"mapmenu\"\n        items=\"{{outline}}\"\n        data=\"[[__sites]]\"\n        selected=\"{{activeItemID}}\"\n      ></map-menu>\n    </app-drawer>\n    <paper-dialog id=\"newdialog\" with-backdrop>\n      <h3>Create new site</h3>\n      <paper-dialog-scrollable>\n        <paper-input\n          id=\"newsitetitle\"\n          label=\"Title\"\n          required\n          autofocus\n          value=\"{{siteTitle}}\"\n        ></paper-input>\n        <paper-input\n          id=\"domain\"\n          label=\"Domain\"\n          required\n          value=\"[[domainName]]\"\n        ></paper-input>\n        <paper-input id=\"newsitedescription\" label=\"Description\"></paper-input>\n        <paper-input\n          id=\"newsiteimage\"\n          label=\"Image\"\n          value=\"[[activeItem.metadata.image]]\"\n        ></paper-input>\n        <label for=\"newsitecolor\">Select a color:</label>\n        <simple-colors-picker id=\"newsitecolor\"></simple-colors-picker>\n        <dropdown-select id=\"newsitetheme\" label=\"Theme\" value=\"simple-blog\">\n          <paper-item value=\"simple-blog\">Simple blog</paper-item>\n          <paper-item value=\"outline-player\">Basic outline</paper-item>\n          <paper-item value=\"haxcms-dev-theme\">DEVELOPER THEME</paper-item>\n          <paper-item value=\"infinite-scroll\">Infinite scroll</paper-item>\n        </dropdown-select>\n        <label for=\"newsiteicon\">Select an icon:</label>\n        <paper-icon-picker\n          id=\"newsiteicon\"\n          icon=\"[[activeItem.metadata.icon]]\"\n        ></paper-icon-picker>\n      </paper-dialog-scrollable>\n      <div class=\"buttons\">\n        <paper-button on-tap=\"_createSite\" dialog-confirm id=\"create\" raised\n          >Let's go!</paper-button\n        >\n        <paper-button dialog-dismiss>cancel</paper-button>\n      </div>\n    </paper-dialog>\n    <paper-dialog id=\"itemdialog\" with-backdrop>\n      <paper-dialog-scrollable>\n        <magazine-cover\n          image=\"[[activeItem.metadata.image]]\"\n          header=\"[[activeItem.title]]\"\n          subheader=\"[[activeItem.description]]\"\n          action=\"Access site\"\n          icon=\"[[activeItem.metadata.icon]]\"\n          event-data=\"[[activeItem]]\"\n          event-name=\"haxcms-load-site\"\n        >\n        </magazine-cover>\n      </paper-dialog-scrollable>\n      <div class=\"buttons\">\n        <iron-icon\n          icon=\"editor:format-color-fill\"\n          style$=\"color:[[activeItem.metadata.hexCode]]\"\n        ></iron-icon\n        >[[activeItem.metadata.hexCode]]\n        <iron-icon icon=\"av:web\"></iron-icon>Theme:\n        [[activeItem.metadata.theme]]\n        <paper-icon-button\n          id=\"editsite\"\n          icon=\"icons:settings\"\n          style=\"color:black\"\n        ></paper-icon-button>\n        <paper-tooltip\n          for=\"edit\"\n          position=\"bottom\"\n          offset=\"12\"\n          animation-delay=\"200\"\n          >change details</paper-tooltip\n        >\n        <paper-icon-button\n          id=\"archivesite\"\n          icon=\"icons:archive\"\n          dialog-dismiss\n          style=\"color:grey\"\n        ></paper-icon-button>\n        <paper-tooltip\n          for=\"archivesite\"\n          position=\"top\"\n          offset=\"12\"\n          animation-delay=\"200\"\n          >archive site</paper-tooltip\n        >\n        <paper-icon-button\n          on-tap=\"_downloadSite\"\n          id=\"download\"\n          icon=\"icons:file-download\"\n          style=\"color:black\"\n        ></paper-icon-button>\n        <paper-tooltip\n          for=\"download\"\n          position=\"top\"\n          offset=\"12\"\n          animation-delay=\"200\"\n          >Download zip</paper-tooltip\n        >\n      </div>\n    </paper-dialog>\n    <paper-toast id=\"toast\"></paper-toast>\n  "],["\n    <style is=\"custom-style\" include=\"simple-colors\">\n      app-toolbar {\n        background-color: #3a0063;\n        color: #ffffff;\n      }\n      paper-icon-button {\n        --paper-icon-button-ink-color: #ffffff;\n      }\n      paper-icon-button + [main-title] {\n        margin-left: 24px;\n      }\n      app-header {\n        @apply --layout-fixed-top;\n        color: #ffffff;\n        --app-header-background-rear-layer: {\n          background-color: #ef6c00;\n        }\n      }\n      app-drawer {\n        --app-drawer-scrim-background: rgba(0, 0, 0, 0.6);\n        --app-drawer-content-container: {\n          background-color: rgba(93, 0, 159, 0.8);\n          overflow: scroll;\n          color: #ffffff;\n          padding-left: 8px;\n          padding-right: 8px;\n        }\n      }\n      sites-listing {\n        display: block;\n        margin: 100px 16px 0px 16px;\n      }\n      paper-dialog {\n        width: 60%;\n        min-height: 50%;\n        top: 10%;\n        border-radius: 16px;\n      }\n      paper-input {\n        --paper-input-container-focus-color: #3a0063;\n      }\n      #closedrawer {\n        float: left;\n        margin: 12px -20px 0 8px;\n      }\n      #add {\n        float: right;\n        margin: 12px 8px 0 -20px;\n      }\n      #newsitecolor {\n        padding: 4px;\n        margin: 0;\n        display: inline-flex;\n        vertical-align: middle;\n      }\n      #newsitecolor > * {\n        display: inline-flex;\n        align-self: center;\n        margin-right: 8px;\n        --simple-colors-picker-preview-size: 20px;\n      }\n    </style>\n    <jwt-login\n      id=\"jwt\"\n      url=\"[[basePath]]system/login.php\"\n      logout-url=\"[[basePath]]system/logout.php\"\n      jwt=\"{{jwt}}\"\n    ></jwt-login>\n    <iron-ajax\n      id=\"createrequest\"\n      method=\"POST\"\n      body=\"[[createParams]]\"\n      headers=\"{&quot;Authorization&quot;: &quot;Bearer [[jwt]]&quot;}\"\n      content-type=\"application/json\"\n      url=\"[[basePath]]system/createNewSite.php\"\n      handle-as=\"json\"\n      on-response=\"handleCreateResponse\"\n    ></iron-ajax>\n    <iron-ajax\n      id=\"downloadrequest\"\n      method=\"POST\"\n      body=\"[[downloadParams]]\"\n      headers=\"{&quot;Authorization&quot;: &quot;Bearer [[jwt]]&quot;}\"\n      content-type=\"application/json\"\n      url=\"[[basePath]]system/downloadSite.php\"\n      handle-as=\"json\"\n      on-response=\"handleDownloadResponse\"\n    ></iron-ajax>\n    <sites-listing\n      id=\"siteslisting\"\n      sites-response=\"{{__sitesResponse}}\"\n      sites=\"{{__sites}}\"\n      data-source=\"[[dataSource]]\"\n      edit-mode=\"[[editMode]]\"\n    ></sites-listing>\n    <app-header reveals>\n      <app-toolbar>\n        <paper-icon-button\n          icon=\"menu\"\n          on-tap=\"drawerToggle\"\n        ></paper-icon-button>\n        <div main-title>[[title]]</div>\n        <paper-icon-button\n          on-tap=\"_editTap\"\n          id=\"edit\"\n          icon=\"[[__editIcon]]\"\n          hidden$=\"[[!loggedIn]]\"\n        ></paper-icon-button>\n        <paper-icon-button\n          on-tap=\"_loginUserRoutine\"\n          id=\"login\"\n          icon=\"[[__loginIcon]]\"\n        ></paper-icon-button>\n        <paper-tooltip\n          for=\"login\"\n          position=\"bottom\"\n          offset=\"12\"\n          animation-delay=\"200\"\n          >[[__loginText]]</paper-tooltip\n        >\n      </app-toolbar>\n    </app-header>\n    <app-drawer id=\"drawer\" swipe-open>\n      <paper-icon-button\n        id=\"closedrawer\"\n        icon=\"icons:close\"\n        on-tap=\"drawerToggle\"\n      ></paper-icon-button>\n      <paper-tooltip\n        for=\"closedrawer\"\n        position=\"bottom\"\n        offset=\"12\"\n        animation-delay=\"200\"\n        >Close</paper-tooltip\n      >\n      <paper-icon-button\n        on-tap=\"_addTap\"\n        id=\"add\"\n        icon=\"icons:add\"\n      ></paper-icon-button>\n      <paper-tooltip\n        for=\"add\"\n        position=\"bottom\"\n        offset=\"12\"\n        animation-delay=\"200\"\n        >Add site</paper-tooltip\n      >\n      <h3\n        style=\"margin: 18px; padding: 6px; border-bottom: 1px solid #ffffff; text-align: center; font-weight: normal;\"\n      >\n        Site list\n      </h3>\n      <map-menu\n        id=\"mapmenu\"\n        items=\"{{outline}}\"\n        data=\"[[__sites]]\"\n        selected=\"{{activeItemID}}\"\n      ></map-menu>\n    </app-drawer>\n    <paper-dialog id=\"newdialog\" with-backdrop>\n      <h3>Create new site</h3>\n      <paper-dialog-scrollable>\n        <paper-input\n          id=\"newsitetitle\"\n          label=\"Title\"\n          required\n          autofocus\n          value=\"{{siteTitle}}\"\n        ></paper-input>\n        <paper-input\n          id=\"domain\"\n          label=\"Domain\"\n          required\n          value=\"[[domainName]]\"\n        ></paper-input>\n        <paper-input id=\"newsitedescription\" label=\"Description\"></paper-input>\n        <paper-input\n          id=\"newsiteimage\"\n          label=\"Image\"\n          value=\"[[activeItem.metadata.image]]\"\n        ></paper-input>\n        <label for=\"newsitecolor\">Select a color:</label>\n        <simple-colors-picker id=\"newsitecolor\"></simple-colors-picker>\n        <dropdown-select id=\"newsitetheme\" label=\"Theme\" value=\"simple-blog\">\n          <paper-item value=\"simple-blog\">Simple blog</paper-item>\n          <paper-item value=\"outline-player\">Basic outline</paper-item>\n          <paper-item value=\"haxcms-dev-theme\">DEVELOPER THEME</paper-item>\n          <paper-item value=\"infinite-scroll\">Infinite scroll</paper-item>\n        </dropdown-select>\n        <label for=\"newsiteicon\">Select an icon:</label>\n        <paper-icon-picker\n          id=\"newsiteicon\"\n          icon=\"[[activeItem.metadata.icon]]\"\n        ></paper-icon-picker>\n      </paper-dialog-scrollable>\n      <div class=\"buttons\">\n        <paper-button on-tap=\"_createSite\" dialog-confirm id=\"create\" raised\n          >Let's go!</paper-button\n        >\n        <paper-button dialog-dismiss>cancel</paper-button>\n      </div>\n    </paper-dialog>\n    <paper-dialog id=\"itemdialog\" with-backdrop>\n      <paper-dialog-scrollable>\n        <magazine-cover\n          image=\"[[activeItem.metadata.image]]\"\n          header=\"[[activeItem.title]]\"\n          subheader=\"[[activeItem.description]]\"\n          action=\"Access site\"\n          icon=\"[[activeItem.metadata.icon]]\"\n          event-data=\"[[activeItem]]\"\n          event-name=\"haxcms-load-site\"\n        >\n        </magazine-cover>\n      </paper-dialog-scrollable>\n      <div class=\"buttons\">\n        <iron-icon\n          icon=\"editor:format-color-fill\"\n          style$=\"color:[[activeItem.metadata.hexCode]]\"\n        ></iron-icon\n        >[[activeItem.metadata.hexCode]]\n        <iron-icon icon=\"av:web\"></iron-icon>Theme:\n        [[activeItem.metadata.theme]]\n        <paper-icon-button\n          id=\"editsite\"\n          icon=\"icons:settings\"\n          style=\"color:black\"\n        ></paper-icon-button>\n        <paper-tooltip\n          for=\"edit\"\n          position=\"bottom\"\n          offset=\"12\"\n          animation-delay=\"200\"\n          >change details</paper-tooltip\n        >\n        <paper-icon-button\n          id=\"archivesite\"\n          icon=\"icons:archive\"\n          dialog-dismiss\n          style=\"color:grey\"\n        ></paper-icon-button>\n        <paper-tooltip\n          for=\"archivesite\"\n          position=\"top\"\n          offset=\"12\"\n          animation-delay=\"200\"\n          >archive site</paper-tooltip\n        >\n        <paper-icon-button\n          on-tap=\"_downloadSite\"\n          id=\"download\"\n          icon=\"icons:file-download\"\n          style=\"color:black\"\n        ></paper-icon-button>\n        <paper-tooltip\n          for=\"download\"\n          position=\"top\"\n          offset=\"12\"\n          animation-delay=\"200\"\n          >Download zip</paper-tooltip\n        >\n      </div>\n    </paper-dialog>\n    <paper-toast id=\"toast\"></paper-toast>\n  "]);import{html,Polymer}from"@polymer/polymer/polymer-legacy.js";import"@polymer/iron-ajax/iron-ajax.js";import"@polymer/paper-button/paper-button.js";import"@polymer/iron-icon/iron-icon.js";import"@polymer/paper-icon-button/paper-icon-button.js";import"@polymer/app-layout/app-header/app-header.js";import"@polymer/app-layout/app-toolbar/app-toolbar.js";import"@polymer/app-layout/app-drawer/app-drawer.js";import"@polymer/iron-icons/iron-icons.js";import"@polymer/iron-icons/editor-icons.js";import"@polymer/iron-icons/notification-icons.js";import"@polymer/iron-icons/av-icons.js";import"@polymer/iron-icons/device-icons.js";import"@polymer/iron-icons/image-icons.js";import"@polymer/paper-item/paper-item.js";import"@polymer/paper-input/paper-input.js";import"@polymer/paper-toast/paper-toast.js";import"@polymer/paper-dialog/paper-dialog.js";import"@polymer/paper-dialog-scrollable/paper-dialog-scrollable.js";import"@polymer/paper-tooltip/paper-tooltip.js";import"@lrnwebcomponents/paper-icon-picker/paper-icon-picker.js";import"@lrnwebcomponents/map-menu/map-menu.js";import"@lrnwebcomponents/jwt-login/jwt-login.js";import"@lrnwebcomponents/simple-colors/simple-colors.js";import"@lrnwebcomponents/hax-body/lib/simple-colors-picker.js";import"@lrnwebcomponents/magazine-cover/magazine-cover.js";import"@lrnwebcomponents/dropdown-select/dropdown-select.js";import"@lrnwebcomponents/sites-listing/sites-listing.js";Polymer({is:"haxcms-site-listing",_template:html(_templateObject),properties:{title:{type:String,value:"Site list"},siteTitle:{type:String},domainName:{type:String,computed:"_computeDomainName(siteTitle)"},__sitesResponse:{type:String,observer:"__sitesResponseChanged"},basePath:{type:String},dataSource:{type:String},jwt:{type:String,observer:"_jwtChanged"},createParams:{type:Object,value:{}},downloadParams:{type:Object,value:{}},activeItem:{type:Object,notify:!0,observer:"_activeItemChanged"},loggedIn:{type:Boolean,notify:!0,reflectToAttribute:!0,observer:"_loginStateChanged"},editMode:{type:Boolean,notify:!0,reflectToAttribute:!0,value:!1,observer:"_editModeChanged"}},drawerToggle:function(){this.$.drawer.toggle()},_computeDomainName:function(b){return"https://"+b.replace(/[^a-zA-Z0-9]/g,"").toLowerCase()+".surge.sh"},__sitesResponseChanged:function(b){var d=this;b&&(this.title=b.title,setTimeout(function(){d.jwt?(d.$.siteslisting.$.list.querySelector("[data-site-id=\"item-new\"]").hidden=!1,d.$.mapmenu.$.builder.shadowRoot.querySelector("#item-new").hidden=!1,d.$.add.hidden=!1):(d.$.siteslisting.$.list.querySelector("[data-site-id=\"item-new\"]").hidden=!0,d.$.mapmenu.$.builder.shadowRoot.querySelector("#item-new").hidden=!0,d.$.add.hidden=!0)},100))},_loginStateChange:function(b){this.loggedIn=!!b.detail},_editModeChanged:function(b){this.__editIcon=b?"icons:check":"icons:create"},_loginStateChanged:function(b){b?(this.__loginText="Log out",this.__loginIcon="icons:account-circle",this.$.toast.show("Welcome, log in successful!"),this.$.add.hidden=!1,this.$.siteslisting.$.list.querySelector("[data-site-id=\"item-new\"]").hidden=!1,this.$.mapmenu.$.builder.shadowRoot.querySelector("#item-new").hidden=!1):(this.__loginText="Log in",this.__loginIcon="icons:power-settings-new",this.$.toast.show("You logged out"),this.$.add.hidden=!0,this.$.siteslisting.$.list.querySelector("[data-site-id=\"item-new\"]").hidden=!0,this.$.mapmenu.$.builder.shadowRoot.querySelector("#item-new").hidden=!0)},_jwtChanged:function(b){b?(this.__loginText="Log out",this.__loginIcon="icons:account-circle"):(this.__loginText="Log in",this.__loginIcon="icons:power-settings-new")},_loginUserRoutine:function(){this.$.jwt.toggleLogin()},_themeChanged:function(b){this.set("activeItem.metadata.theme",b.detail.value)},_colorChanged:function(b){this.set("activeItem.metadata.cssVariable",b.detail.cssVariable),this.set("activeItem.metadata.hexCode",b.detail.hexCode)},_addTap:function(){var c=this.$.siteslisting.$.list.querySelector("[data-site-id=\"item-new\"]");c&&c.click()},_editTap:function(){this.editMode=!this.editMode},_mapMenuSelection:function(b){var c=this.__sites.filter(function(d){return!(d.id!==b.detail)});0<c.length&&(this.set("activeItem",{}),this.set("activeItem",c.pop()))},_activeItemChanged:function(b){("undefined"===typeof b?"undefined":babelHelpers.typeof(b))!=="undefined"&&babelHelpers.typeof(b.id)!=="undefined"?"item-new"===b.id?(this.$.newdialog.opened=!0,this.$.itemdialog.opened=!1):(this.$.newdialog.opened=!1,this.$.itemdialog.opened=!0):("undefined"===typeof b?"undefined":babelHelpers.typeof(b))!=="undefined"&&babelHelpers.typeof(b.id)!=="undefined"&&(this.$.newdialog.opened=!1,this.$.itemdialog.opened=!1,this.$.drawer.opened=!1)},attached:function(){document.body.addEventListener("sites-listing-item-selected",this._itemSelected.bind(this)),document.body.addEventListener("haxcms-load-site",this.loadActiveSite.bind(this)),this.$.mapmenu.addEventListener("selected",this._mapMenuSelection.bind(this)),this.$.newsitetheme.addEventListener("change",this._themeChanged.bind(this)),this.$.newsitecolor.addEventListener("change",this._colorChanged.bind(this)),this.$.jwt.addEventListener("jwt-logged-in",this._loginStateChange.bind(this)),this.$.siteslisting.addEventListener("item-overlay-option-selected",this._itemOptionSelected.bind(this)),this.$.siteslisting.addEventListener("item-overlay-op-changed",this._itemOpChanged.bind(this))},detached:function(){document.body.removeEventListener("sites-listing-item-selected",this._itemSelected.bind(this)),document.body.removeEventListener("haxcms-load-site",this.loadActiveSite.bind(this)),this.$.mapmenu.removeEventListener("selected",this._mapMenuSelection.bind(this)),this.$.newsitetheme.removeEventListener("change",this._themeChanged.bind(this)),this.$.newsitecolor.removeEventListener("change",this._colorChanged.bind(this)),this.$.jwt.removeEventListener("jwt-logged-in",this._loginStateChange.bind(this)),this.$.siteslisting.removeEventListener("item-overlay-option-selected",this._itemOptionSelected.bind(this)),this.$.siteslisting.removeEventListener("item-overlay-op-changed",this._itemOpChanged.bind(this))},ready:function(){this.jwt=localStorage.getItem("jwt")},loadActiveSite:function(b){var c=this.__sites.filter(function(f){return!(f.id!==b.detail.id)}),d=c.pop();d.location?window.open(d.location):window.open("/_sites/"+d.metadata.siteName+"/index.html")},_itemSelected:function(b){this.set("activeItem",{}),this.set("activeItem",b.detail)},_createSite:function(){this.set("createParams.domain",this.$.domain.value),this.set("createParams.siteName",this.$.newsitetitle.value),this.set("createParams.description",this.$.newsitedescription.value),this.set("createParams.theme",this.activeItem.metadata.theme),this.set("createParams.hexCode",this.activeItem.metadata.hexCode),this.set("createParams.cssVariable",this.activeItem.metadata.cssVariable),this.set("createParams.image",this.$.newsiteimage.value),this.set("createParams.icon",this.$.newsiteicon.icon),this.set("createParams.jwt",this.jwt),this.$.newsitetitle.value="",this.$.newsitedescription.value=null,this.$.createrequest.generateRequest()},_downloadSite:function(){this.set("downloadParams.siteName",this.activeItem.metadata.siteName),this.set("downloadParams.jwt",this.jwt),this.$.downloadrequest.generateRequest()},handleCreateResponse:function(b){this.fire("update-sites-listing-data",b.detail.response),this.$.toast.show(b.detail.response.title+" created successfully!")},handleDownloadResponse:function(b){this.fire("download-site-listing",b.detail.response);var c=document.createElement("a");c.setAttribute("href",b.detail.response.link),c.style.display="none",document.body.appendChild(c),c.click(),document.body.removeChild(c),this.$.toast.show(this.activeItem.title+" downloaded successfully!")},_itemOptionSelected:function(b){b.detail.element;switch(b.detail.operation){case"remove":"option1"===b.detail.option&&this.$.toast.show("Deleting this");break;case"duplicate":"option1"===b.detail.option&&this.$.toast.show("Duplicating this");break;case"move":"option1"===b.detail.option?this.$.toast.show("Move this item left"):this.$.toast.show("Move this item right");}},_itemOpChanged:function(b){var c=b.detail.element;if("edit"===b.detail.operation){var d=this.__sites.filter(function(f){return!(f.id!==c.getAttribute("data-site-id"))});0<d.length&&(this.set("activeItem",{}),this.set("activeItem",d.pop()),this.$.edit.click())}}});