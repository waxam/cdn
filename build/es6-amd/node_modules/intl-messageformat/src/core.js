define(["exports","./utils.js","./es5.js","./compiler.js","../../intl-messageformat-parser/src/parser.js"],(function(e,r,t,o,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,o=babelHelpers.interopRequireDefault(o),a=babelHelpers.interopRequireDefault(a);var n=MessageFormat;function MessageFormat(e,r,o){var a="string"==typeof e?MessageFormat.__parse(e):e;if(!a||"messageFormatPattern"!==a.type)throw new TypeError("A message must be provided as a String or AST.");o=this._mergeFormats(MessageFormat.formats,o),(0,t.defineProperty)(this,"_locale",{value:this._resolveLocale(r)});var n=this._findPluralRuleFunction(this._locale),s=this._compilePattern(a,r,o,n),l=this;this.format=function(r){try{return l._format(s,r)}catch(t){throw t.variableId?new Error("The intl string context variable '"+t.variableId+"' was not provided to the string '"+e+"'"):t}}}e.default=n,(0,t.defineProperty)(MessageFormat,"formats",{enumerable:!0,value:{number:{currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}}}),(0,t.defineProperty)(MessageFormat,"__localeData__",{value:(0,t.objCreate)(null)}),(0,t.defineProperty)(MessageFormat,"__addLocaleData",{value:function(e){if(!e||!e.locale)throw new Error("Locale data provided to IntlMessageFormat is missing a `locale` property");MessageFormat.__localeData__[e.locale.toLowerCase()]=e}}),(0,t.defineProperty)(MessageFormat,"__parse",{value:a.default.parse}),(0,t.defineProperty)(MessageFormat,"defaultLocale",{enumerable:!0,writable:!0,value:void 0}),MessageFormat.prototype.resolvedOptions=function(){return{locale:this._locale}},MessageFormat.prototype._compilePattern=function(e,r,t,a){return new o.default(r,t,a).compile(e)},MessageFormat.prototype._findPluralRuleFunction=function(e){for(var r=MessageFormat.__localeData__,t=r[e.toLowerCase()];t;){if(t.pluralRuleFunction)return t.pluralRuleFunction;t=t.parentLocale&&r[t.parentLocale.toLowerCase()]}throw new Error("Locale data added to IntlMessageFormat is missing a `pluralRuleFunction` for :"+e)},MessageFormat.prototype._format=function(e,t){var o,a,n,s,l,i,u="";for(o=0,a=e.length;o<a;o+=1)if("string"!=typeof(n=e[o])){if(s=n.id,!t||!r.hop.call(t,s))throw(i=new Error("A value must be provided for: "+s)).variableId=s,i;l=t[s],n.options?u+=this._format(n.getOption(l),t):u+=n.format(l)}else u+=n;return u},MessageFormat.prototype._mergeFormats=function(e,o){var a,n,s={};for(a in e)r.hop.call(e,a)&&(s[a]=n=(0,t.objCreate)(e[a]),o&&r.hop.call(o,a)&&(0,r.extend)(n,o[a]));return s},MessageFormat.prototype._resolveLocale=function(e){"string"==typeof e&&(e=[e]),e=(e||[]).concat(MessageFormat.defaultLocale);var r,t,o,a,n=MessageFormat.__localeData__;for(r=0,t=e.length;r<t;r+=1)for(o=e[r].toLowerCase().split("-");o.length;){if(a=n[o.join("-")])return a.locale;o.pop()}var s=e.pop();throw new Error("No locale data has been added to IntlMessageFormat for: "+e.join(", ")+", or the default locale: "+s)}}));