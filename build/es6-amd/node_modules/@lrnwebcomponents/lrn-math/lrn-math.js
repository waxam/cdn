define(["exports"],(function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LrnMath=t.LrnMathController=void 0;const e=window.document,n=1,r=2,o=3,a=4,i=5;let s,l,c=[],h=n,d="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js";function flush_typesets(){if(!c.length)return;const t=[],n=[];c.forEach((function(r){const o=e.createElement("script"),a=e.createElement("div");o.type=r[1]?"math/tex; mode=display":"math/tex",o.text=r[0],a.style.position="fixed",a.style.top=0,a.style.left="99999px",a.appendChild(o),e.body.appendChild(a),t.push(o),n.push([a,r[2]])})),c=[],h=a,s.Queue(["Typeset",s,t]),s.Queue((function(){l||function getStyleNode(){const t=e.querySelectorAll("style"),n=Array.prototype.filter.call(t,(function(t){return t.sheet&&t.sheet.cssRules.length>100&&".mjx-chtml"===t.sheet.cssRules[0].selectorText}));l=n[0]}(),n.forEach((function(t){const n=t[0],r="SPAN"===n.firstElementChild.tagName?n.firstElementChild:null;t[1](r,l),e.body.removeChild(n)})),h=o,flush_typesets()}))}function load_library(){h=r,window.MathJax={skipStartupTypeset:!0,showMathMenu:!1,jax:["input/TeX","output/CommonHTML"],TeX:{extensions:["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]},AuthorInit(){s=window.MathJax.Hub,s.Register.StartupHook("End",(function(){h=o,flush_typesets()}))}};var t=e.createElement("script");t.type="text/javascript",t.src=d,t.async=!0,t.onerror=function(){console.warn("Error loading MathJax library "+d),h=i,c=[]},e.head.appendChild(t)}class LrnMathController extends HTMLElement{connectedCallback(){this.hasAttribute("src")&&(d=this.getAttribute("src")),this.hasAttribute("lazy")||load_library()}typeset(t,e,r){h!==i&&(c.push([t,e,r]),h===n?load_library():h===o&&flush_typesets())}}t.LrnMathController=LrnMathController,window.customElements.define("lrn-math-controller",LrnMathController);const u={childList:!0,characterData:!0,attributes:!0,subtree:!0};let p;function update(t){const e=t.shadowRoot,n=t.textContent.trim(),r="display"===t.getAttribute("mode"),o=(r?"D":"I")+n;if(o!==t._private.check){for(;e.firstChild;)e.removeChild(e.firstChild);t._private.check=o,n.length&&p.typeset(n,r,(function(t,n){e.appendChild(n.cloneNode(!0)),e.appendChild(t)}))}}class LrnMath extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get tag(){return"lrn-math"}connectedCallback(){const t=this;!function check_handler(){p||(p=e.querySelector("lrn-math-controller")||e.createElement("lrn-math-controller"),p.setAttribute("lazy","lazy"),p&&"function"==typeof p.typeset?e.contains(p)||e.head.appendChild(p):(console.warn("no %s element defined; %s element will not work","lrn-math-controller","lrn-math"),p=void 0))}(),window.requestAnimationFrame((function(){t._private={check:"",observer:new MutationObserver((function(){update(t)}))},update(t),t._private.observer.observe(t,u)}))}static get haxProperties(){return{canScale:!0,canPosition:!0,canEditSource:!0,gizmo:{title:"Math",description:"Present math in a nice looking way.",icon:"hax:pi",iconLib:"@lrnwebcomponents/hax-iconset/hax-iconset.js",color:"grey",groups:["Content"],handles:[{type:"math",math:"mathText"},{type:"inline",text:"mathText"}],meta:{author:"ELMS:LN",inlineOnly:!0}},settings:{quick:[],configure:[{slot:"",title:"Math",description:"Enter equation as MathML",inputMethod:"code-editor",icon:"editor:format-quote"}],advanced:[]}}}refresh(){let t=e.createElement("lrn-math");this.parentNode.insertBefore(t,this),t.innerHTML=this.innerHTML,this.remove()}disconnectedCallback(){this._private&&(this._private.observer.disconnect(),delete this._private)}}t.LrnMath=LrnMath,window.customElements.define(LrnMath.tag,LrnMath)}));