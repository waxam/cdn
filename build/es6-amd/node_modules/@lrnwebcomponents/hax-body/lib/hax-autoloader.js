define(["exports","meta","require","../../../lit-element/lit-element.js","../../../@polymer/polymer/lib/utils/flattened-nodes-observer.js","../../hax-body-behaviors/hax-body-behaviors.js","./haxutils.js"],function(_exports,meta,_require,_litElement,_flattenedNodesObserver,_haxBodyBehaviors,_haxutils){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.HaxAutoloader=void 0,meta=babelHelpers.interopRequireWildcard(meta),_require=babelHelpers.interopRequireWildcard(_require);class HaxAutoloader extends((0,_haxBodyBehaviors.HAXElement)(_litElement.LitElement)){static get styles(){return[_litElement.css`
        :host {
          display: none;
        }
      `]}render(){return _litElement.html`
      <slot></slot>
    `}static get tag(){return"hax-autoloader"}pathFromUrl(url){return url.substring(0,url.lastIndexOf("/")+1)}static get properties(){return{processedList:{type:Object}}}constructor(){super(),this.processedList={}}firstUpdated(changedProperties){this.dispatchEvent(new CustomEvent("hax-register-core-piece",{bubbles:!0,cancelable:!0,composed:!0,detail:{piece:"haxAutoloader",object:this}})),this._observer=new _flattenedNodesObserver.FlattenedNodesObserver(this,info=>{info.addedNodes.length>0&&setTimeout(()=>{this.processNewElements(info.addedNodes)},5)})}disconnectedCallback(){this._observer.disconnect(),super.disconnectedCallback()}processNewElements(e){let effectiveChildren=_flattenedNodesObserver.FlattenedNodesObserver.getFlattenedNodes(this).filter(n=>n.nodeType===Node.ELEMENT_NODE);for(var i=0;i<effectiveChildren.length;i++)if(void 0!==effectiveChildren[i].tagName&&void 0===this.processedList[effectiveChildren[i].tagName])try{let name=effectiveChildren[i].tagName.toLowerCase();if("function"==typeof effectiveChildren[i].getHaxProperties){const evt=new CustomEvent("hax-register-properties",{bubbles:!0,composed:!0,cancelable:!0,detail:{tag:name,properties:effectiveChildren[i].getHaxProperties(),polymer:!0}});context.dispatchEvent(evt)}else if("function"==typeof effectiveChildren[i].HAXWiring){const evt=new CustomEvent("hax-register-properties",{bubbles:!0,cancelable:!0,composed:!0,detail:{tag:name,properties:effectiveChildren[i].HAXWiring.getHaxProperties(),polymer:!1}});context.dispatchEvent(evt)}else{const basePath=this.pathFromUrl(decodeURIComponent(meta.url));if(window.customElements.get(name)){let CEClass=window.customElements.get(name);CEClass?"function"==typeof CEClass.getHaxProperties?this.setHaxProperties(CEClass.getHaxProperties(),name):"function"==typeof CEClass.HAXWiring?this.setHaxProperties(CEClass.HAXWiring.getHaxProperties(),name):CEClass.haxProperties?this.setHaxProperties(CEClass.haxProperties,name):console.warn(`${name} didn't have hax wiring in the end`):console.error(`${name} was not a valid custom element yet a load was attempted`)}else{let nameLocation=(0,_haxutils.varGet)(window.HaxStore,"instance.__appStoreData.autoloader."+name,`@lrnwebcomponents/${name}/${name}.js`);new Promise((res,rej)=>_require.default([`${basePath}../../../${nameLocation}`],res,rej)).then(response=>{let CEClass=window.customElements.get(name);CEClass?"function"==typeof CEClass.getHaxProperties?this.setHaxProperties(CEClass.getHaxProperties(),name):"function"==typeof CEClass.HAXWiring?this.setHaxProperties(CEClass.HAXWiring.getHaxProperties(),name):CEClass.haxProperties?this.setHaxProperties(CEClass.haxProperties,name):console.warn(`${name} didn't have hax wiring in the end`):console.error(`${name} was not a valid custom element yet a load was attempted`)}).catch(error=>{console.warn(error)})}}this.processedList[name]=name}catch(err){}}}_exports.HaxAutoloader=HaxAutoloader,window.customElements.define(HaxAutoloader.tag,HaxAutoloader)});