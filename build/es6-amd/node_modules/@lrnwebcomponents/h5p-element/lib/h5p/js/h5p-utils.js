var H5PUtils=H5PUtils||{};!function(t){H5PUtils.createTable=function(e){var n=t('<table class="h5p-admin-table'+(void 0!==H5PAdminIntegration.extraTableClasses?" "+H5PAdminIntegration.extraTableClasses:"")+'"></table>');if(e){var a=t("<thead></thead>"),o=t("<tr></tr>");t.each(e,(function(e,n){n instanceof Object||(n={html:n}),t("<th/>",n).appendTo(o)})),n.append(a.append(o))}return n},H5PUtils.createTableRow=function(e){var n=t("<tr></tr>");return t.each(e,(function(e,a){a instanceof Object||(a={html:a}),t("<td/>",a).appendTo(n)})),n},H5PUtils.createLabeledField=function(e,n){var a=t('<div class="h5p-labeled-field"></div>');return a.append('<div class="h5p-label">'+e+"</div>"),a.append('<div class="h5p-value">'+n+"</div>"),a},H5PUtils.translateReplace=function(e,n){return t.each(n,(function(t,n){e=e.replace(new RegExp("\\"+t,"g"),n)})),e},H5PUtils.throbber=function(e){return t("<div/>",{class:"h5p-throbber",text:e})},H5PUtils.getRebuildCache=function(e){var n=t('<div class="h5p-admin-rebuild-cache"><p class="message">'+e.message+'</p><p class="progress">'+e.progress+"</p></div>"),a=t("<button>"+e.button+"</button>").appendTo(n).click((function(){var o=t("<div/>",{class:"h5p-spinner"}).replaceAll(a),i=["|","/","-","\\"],r=0,s=setInterval((function(){o.text(i[r]),++r===i.length&&(r=0)}),100),l=n.find(".progress"),build=function(){t.post(e.url,(function(t){if("0"===t)clearInterval(s),n.remove(),location.reload();else{var e=l.text().split(" ");e[0]=t,l.text(e.join(" ")),build()}}))};build()}));return n},H5PUtils.Table=function(e){var n,a,o,i,r,s={};void 0!==e.table&&(s.class=e.table);var l=t("<table/>",s),c=t("<thead/>").appendTo(l),d=t("<tfoot/>").appendTo(l),p=t("<tbody/>").appendTo(l),addCol=function(e,n,s){var l={on:{}};n instanceof Object?(void 0!==n.text&&(l.text=n.text),void 0!==n.class&&(l.class=n.class),void 0!==a&&!0===n.sortable&&(l.role="button",l.tabIndex=0,void 0===i&&(i=s,r=0),i===s&&(l.class="h5p-sort",1===r&&(l.class+=" h5p-reverse")),l.on.click=function(){sort(c,s)},l.on.keypress=function(t){32===(t.charCode||t.keyCode)&&sort(c,s)})):l.text=n;var c=t("<th>",l).appendTo(e);i===s&&(o=c)},sort=function(t,e){e===i?0===r?(r=1,t.addClass("h5p-reverse")):(r=0,t.removeClass("h5p-reverse")):(o.removeClass("h5p-sort").removeClass("h5p-reverse"),o=t.addClass("h5p-sort"),i=e,r=0),a({by:i,dir:r})};this.setHeaders=function(e,o,s){n=e.length,a=o,s&&(i=s.by,r=s.dir);for(var l=t("<thead/>"),d=t("<tr/>").appendTo(l),p=0;p<e.length;p++)addCol(d,e[p],p);c.replaceWith(l),c=l},this.setRows=function(e){for(var n=t("<tbody/>"),a=0;a<e.length;a++)for(var o=t("<tr/>").appendTo(n),i=0;i<e[a].length;i++)t("<td>",{html:e[a][i]}).appendTo(o);return p.replaceWith(n),p=n},this.setBody=function(e){var a=t("<tbody/>"),o=t("<tr/>").appendTo(a);t("<td>",{colspan:n}).append(e).appendTo(o),p.replaceWith(a),p=a},this.setFoot=function(e){var a=t("<tfoot/>"),o=t("<tr/>").appendTo(a);t("<td>",{colspan:n}).append(e).appendTo(o),d.replaceWith(a)},this.appendTo=function(t){l.appendTo(t)}},H5PUtils.Pagination=function(e,n,a,o){var i=0,r=Math.ceil(e/n),s=t("<button/>",{html:"&lt;",class:"button",title:o.previousPage}).click((function(){goTo(i-1)})),l=t("<span/>").click((function(){c.width(l.width()).show().val(i+1).focus(),l.hide()})),c=t("<input/>",{type:"number",min:1,max:r,on:{blur:function(){gotInput()},keyup:function(t){if(13===t.keyCode)return gotInput(),!1}}}).hide(),d=t("<button/>",{html:"&gt;",class:"button",title:o.nextPage}).click((function(){goTo(i+1)})),gotInput=function(){var t=parseInt(c.hide().val());isNaN(t)||goTo(t-1),l.show()},updateUI=function(){var t=i+1;s.attr("disabled",0===i),d.attr("disabled",t===r),l.html(o.currentPage.replace("$current",t).replace("$total",r))},goTo=function(t){t===i||t<0||t>=r||(i=t,updateUI(),a(t*n))};this.update=function(t,a){if(t!==e||a!==n){if(e=t,n=a,r=Math.ceil(e/n),c.attr("max",r),i>=r)return void goTo(r-1);updateUI()}},this.appendTo=function(t){s.add(l).add(c).add(d).appendTo(t)},updateUI()}}(H5P.jQuery);