var H5PLibraryList=H5PLibraryList||{};!function(t){H5PLibraryList.init=function(){var t=H5P.jQuery(H5PAdminIntegration.containerSelector).html(""),e=H5PAdminIntegration.libraryList;e.notCached&&t.append(H5PUtils.getRebuildCache(e.notCached)),t.append(H5PLibraryList.createLibraryList(H5PAdminIntegration.libraryList))},H5PLibraryList.createLibraryList=function(e){var i=H5PAdminIntegration.l10n;if(void 0===e.listData||0===e.listData.length)return t("<div>"+i.NA+"</div>");var r=H5PUtils.createTable(e.listHeaders);return r.addClass("libraries"),t.each(e.listData,(function(a,n){var d=H5PUtils.createTableRow([n.title,'<input class="h5p-admin-restricted" type="checkbox"/>',{text:n.numContent,class:"h5p-admin-center"},{text:n.numContentDependencies,class:"h5p-admin-center"},{text:n.numLibraryDependencies,class:"h5p-admin-center"},'<div class="h5p-admin-buttons-wrapper"><button class="h5p-admin-upgrade-library"></button>'+(n.detailsUrl?'<button class="h5p-admin-view-library" title="'+i.viewLibrary+'"></button>':"")+(n.deleteUrl?'<button class="h5p-admin-delete-library"></button>':"")+"</div>"]);H5PLibraryList.addRestricted(t(".h5p-admin-restricted",d),n.restrictedUrl,n.restricted);var l=!(""===n.numContent||0===n.numContent);null===n.upgradeUrl?t(".h5p-admin-upgrade-library",d).remove():!1!==n.upgradeUrl&&l?t(".h5p-admin-upgrade-library",d).attr("title",i.upgradeLibrary).click((function(){window.location.href=n.upgradeUrl})):t(".h5p-admin-upgrade-library",d).attr("disabled",!0),t(".h5p-admin-view-library",d).on("click",(function(){window.location.href=n.detailsUrl}));var c=t(".h5p-admin-delete-library",d);void 0!==e.notCached||l||""!==n.numContentDependencies&&0!==n.numContentDependencies||""!==n.numLibraryDependencies&&0!==n.numLibraryDependencies?c.attr("disabled",!0):c.attr("title",i.deleteLibrary).on("click",(function(){window.location.href=n.deleteUrl})),r.append(d)})),r},H5PLibraryList.addRestricted=function(e,i,r){null===r?e.remove():(e.change((function(){e.attr("disabled",!0),t.ajax({dataType:"json",url:i,cache:!1}).fail((function(){e.attr("disabled",!1),e.attr("checked",!e.is(":checked"))})).done((function(t){i=t.url,e.attr("disabled",!1)}))})),r&&e.attr("checked",!0))},t(document).ready((function(){H5PLibraryList.initialized||(H5PLibraryList.initialized=!0,H5PLibraryList.init())}))}(H5P.jQuery);