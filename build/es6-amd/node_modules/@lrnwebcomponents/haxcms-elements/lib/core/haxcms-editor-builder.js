define(["exports","meta","require","./haxcms-site-store.js"],(function(e,t,i,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HAXCMSEditorBuilder=void 0,t=babelHelpers.interopRequireWildcard(t),i=babelHelpers.interopRequireWildcard(i);
/**
   * Copyright 2018 The Pennsylvania State University
   * @license Apache-2.0, see License.md for full text.
   */
class HAXCMSEditorBuilder extends HTMLElement{static get tag(){return"haxcms-editor-builder"}constructor(){super(),this.applyContext(),window.addEventListener("haxcms-site-editor-loaded",this.editorLoaded.bind(this))}connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.dispatchEvent(new CustomEvent("haxcms-editor-builder-ready",{bubbles:!0,composed:!0,cancelable:!1,detail:this}))}disconnectedCallback(){window.removeEventListener("haxcms-site-editor-loaded",this.editorLoaded.bind(this)),super.disconnectedCallback&&super.disconnectedCallback()}getContext(){let e="";return e="undefined"!=typeof DatArchive?"beaker":!0===window.__haxCMSContextPublished?"published":!0===window.__haxCMSContextNode?"nodejs":!0===window.__haxCMSContextDemo?"demo":"php",e}editorLoaded(e){d.store.cmsSiteEditor.haxCmsSiteEditorUIElement||(new Promise((e,t)=>i.default(["./haxcms-site-editor-ui.js"],e,t)),d.store.cmsSiteEditor.haxCmsSiteEditorUIElement=document.createElement("haxcms-site-editor-ui"),document.body.appendChild(d.store.cmsSiteEditor.haxCmsSiteEditorUIElement),setTimeout(()=>{d.store.cmsSiteEditor.haxCmsSiteEditorUIElement.painting=!1},5))}pathFromUrl(e){return e.substring(0,e.lastIndexOf("/")+1)}applyContext(e=null){if(!this.__appliedContext){if(this.__appliedContext=!0,null==e&&(e=this.getContext()),"php"===e||"nodejs"===e){let e=document.createElement("script");e.src="../../system/api/connectionSettings",fetch(e.src).then(t=>{404!=t.status&&document.documentElement.appendChild(e)})}if("published"!==e){const o=this.pathFromUrl(decodeURIComponent(t.url));d.store.cmsSiteEditorBackend.tag=`haxcms-backend-${e}`,new Promise((e,t)=>i.default([`${o}backends/${d.store.cmsSiteEditorBackend.tag}.js`],e,t)).then(e=>{d.store.cmsSiteEditorBackend.instance||(d.store.cmsSiteEditorBackend.instance=document.createElement(d.store.cmsSiteEditorBackend.tag),document.body.append(d.store.cmsSiteEditorBackend.instance))})}}}}e.HAXCMSEditorBuilder=HAXCMSEditorBuilder,window.customElements.define(HAXCMSEditorBuilder.tag,HAXCMSEditorBuilder)}));