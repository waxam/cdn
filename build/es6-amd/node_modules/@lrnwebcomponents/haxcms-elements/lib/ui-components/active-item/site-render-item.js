define(["exports","meta","require","../../../../../@polymer/polymer/polymer-element.js","../../../../utils/utils.js","../../../../../@polymer/polymer/lib/utils/async.js","../../core/haxcms-site-store.js","../../../../../@polymer/iron-ajax/iron-ajax.js","../../../../../mobx/lib/mobx.module.js"],(function(e,t,n,o,i,r,a,s,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SiteRenderItem=void 0,t=babelHelpers.interopRequireWildcard(t),n=babelHelpers.interopRequireWildcard(n);
/**
   * Copyright 2019 The Pennsylvania State University
   * @license Apache-2.0, see License.md for full text.
   */
class SiteRenderItem extends o.PolymerElement{static get tag(){return"site-render-item"}static get template(){return o.html`
      <style>
        :host {
          display: block;
        }
      </style>
      <iron-ajax
        id="content"
        url="[[location]]"
        handle-as="text"
        loading="{{loading}}"
        debounce-duration="250"
        last-response="{{itemContent}}"
      ></iron-ajax>
      <slot></slot>
    `}static get properties(){return{render:{type:Boolean,value:!1},itemId:{type:String},location:{type:String,computed:"_computeLocation(itemId, render)",observer:"locationChanged"},itemContent:{type:String,notify:!0,observer:"_itemContentChanged"}}}_computeLocation(e,t){if(e&&t){return a.store.findItem(e).location+"?"+Math.floor(Date.now()/1e3)}}locationChanged(e){e&&this.shadowRoot.querySelector("#content").generateRequest()}pathFromUrl(e){return e.substring(0,e.lastIndexOf("/")+1)}_itemContentChanged(e,o){if(e){var a=e;if(null!==a&&(a=(0,i.encapScript)(e),(0,i.wipeSlot)(this,"*"),r.microTask.run(()=>{setTimeout(()=>{let e=document.createRange().createContextualFragment(a);this.appendChild(e)},5)}),(0,i.varExists)(this.manifest,"metadata.node.dynamicElementLoader"))){let e=(0,i.findTagsInHTML)(a);const o=this.pathFromUrl(decodeURIComponent(t.url));for(var s in e){const t=e[s];this.manifest.metadata.node.dynamicElementLoader[t]&&!window.customElements.get(t)&&new Promise((e,i)=>n.default([`${o}../../../../../${this.manifest.metadata.node.dynamicElementLoader[t]}`],e,i)).then(e=>{}).catch(e=>{console.log(e)})}}}}connectedCallback(){super.connectedCallback(),this.__disposer=[],(0,l.autorun)(e=>{this.manifest=(0,l.toJS)(a.store.manifest),this.__disposer.push(e)})}disconnectedCallback(){for(var e in this.__disposer)this.__disposer[e];super.disconnectedCallback()}}e.SiteRenderItem=SiteRenderItem,window.customElements.define(SiteRenderItem.tag,SiteRenderItem)}));