define(["exports","../../../@polymer/polymer/polymer-element.js","../../../@polymer/polymer/lib/utils/templatize.js"],(function(_exports,_polymerElement,_templatize){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.Templatizer=void 0;
/**
  @license
  Copyright (c) 2017 Vaadin Ltd.
  This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
  */
class GridTemplatizer extends class extends _polymerElement.PolymerElement{}{static get is(){return"vaadin-grid-templatizer"}static get properties(){return{dataHost:Object,template:Object,_templateInstances:{type:Array,value:function(){return[]}},_parentPathValues:{value:function(){return{}}},_grid:Object}}static get observers(){return["_templateInstancesChanged(_templateInstances.*, _parentPathValues.*)"]}constructor(){super(),this._instanceProps={detailsOpened:!0,index:!0,item:!0,selected:!0,expanded:!0,level:!0}}createInstance(){this._ensureTemplatized();const instance=new this._TemplateClass({});return this.addInstance(instance),instance}addInstance(instance){-1===this._templateInstances.indexOf(instance)&&(this._templateInstances.push(instance),requestAnimationFrame(()=>this.notifyPath("_templateInstances.*",this._templateInstances)))}removeInstance(instance){const index=this._templateInstances.indexOf(instance);this.splice("_templateInstances",index,1)}_ensureTemplatized(){this._TemplateClass||(this._TemplateClass=(0,_templatize.templatize)(this.template,this,{instanceProps:this._instanceProps,parentModel:!0,forwardHostProp:function(prop,value){this._forwardParentProp(prop,value),this._templateInstances&&this._templateInstances.forEach(inst=>inst.notifyPath(prop,value))},notifyInstanceProp:function(inst,prop,value){if("index"===prop||"item"===prop)return;const originalProp=`__${prop}__`;if(inst[originalProp]===value)return;inst[originalProp]=value;const row=Array.from(this._grid.$.items.children).filter(row=>this._grid._itemsEqual(row._item,inst.item))[0];row&&Array.from(row.children).forEach(cell=>{cell._instance&&(cell._instance[originalProp]=value,cell._instance.notifyPath(prop,value))});if(Array.isArray(this._grid.items)&&0===prop.indexOf("item.")){const itemsIndex=this._grid.items.indexOf(inst.item),path=prop.slice("item.".length);this._grid.notifyPath(`items.${itemsIndex}.${path}`,value)}const gridCallback=`_${prop}InstanceChangedCallback`;this._grid&&this._grid[gridCallback]&&this._grid[gridCallback](inst,value)}}))}_forwardParentProp(prop,value){this._parentPathValues[prop]=value,this._templateInstances.forEach(inst=>inst.notifyPath(prop,value))}_templateInstancesChanged(t,p){let index,count;if("_templateInstances"===t.path)index=0,count=this._templateInstances.length;else{if("_templateInstances.splices"!==t.path)return;index=t.value.index,count=t.value.addedCount}Object.keys(this._parentPathValues||{}).forEach(keyName=>{for(var i=index;i<index+count;i++)this._templateInstances[i].set(keyName,this._parentPathValues[keyName])})}}_exports.Templatizer=GridTemplatizer,customElements.define(GridTemplatizer.is,GridTemplatizer)}));