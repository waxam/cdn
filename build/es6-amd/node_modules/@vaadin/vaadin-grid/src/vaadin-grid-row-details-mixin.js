define(["exports","./vaadin-grid-templatizer.js","../../../@polymer/polymer/lib/utils/flush.js"],function(_exports,_vaadinGridTemplatizer,_flush){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.RowDetailsMixin=void 0;_exports.RowDetailsMixin=superClass=>(class RowDetailsMixin extends superClass{static get properties(){return{detailsOpenedItems:{type:Array,value:function(){return[]}},_rowDetailsTemplate:Object,rowDetailsRenderer:Function,_detailsCells:{type:Array}}}static get observers(){return["_detailsOpenedItemsChanged(detailsOpenedItems.*, _rowDetailsTemplate, rowDetailsRenderer)","_rowDetailsTemplateOrRendererChanged(_rowDetailsTemplate, rowDetailsRenderer)"]}_rowDetailsTemplateOrRendererChanged(rowDetailsTemplate,rowDetailsRenderer){if(rowDetailsTemplate&&rowDetailsRenderer)throw new Error("You should only use either a renderer or a template for row details");if(rowDetailsTemplate||rowDetailsRenderer){if(rowDetailsTemplate&&!rowDetailsTemplate.templatizer){var templatizer=new _vaadinGridTemplatizer.Templatizer;templatizer._grid=this,templatizer.dataHost=this.dataHost,templatizer.template=rowDetailsTemplate,rowDetailsTemplate.templatizer=templatizer}this._columnTree&&Array.from(this.$.items.children).forEach(row=>{row.querySelector("[part~=details-cell]")||(this._updateRow(row,this._columnTree[this._columnTree.length-1]),this._a11yUpdateRowDetailsOpened(row,!1)),delete row.querySelector("[part~=details-cell]")._instance}),this.detailsOpenedItems.length&&(Array.from(this.$.items.children).forEach(this._toggleDetailsCell,this),this._update())}}_detailsOpenedItemsChanged(changeRecord,rowDetailsTemplate,rowDetailsRenderer){"detailsOpenedItems.length"!==changeRecord.path&&changeRecord.value&&Array.from(this.$.items.children).forEach(row=>{this._toggleDetailsCell(row,row._item),this._a11yUpdateRowDetailsOpened(row,this._isDetailsOpened(row._item))})}_configureDetailsCell(cell){cell.setAttribute("part","cell details-cell"),this._toggleAttribute("frozen",!0,cell)}_toggleDetailsCell(row,item){const cell=row.querySelector('[part~="details-cell"]');if(!cell)return;const detailsHidden=!this._isDetailsOpened(item),hiddenChanged=!!cell.hidden!==detailsHidden;(cell._instance||cell._renderer)&&cell.hidden===detailsHidden||(cell.hidden=detailsHidden,detailsHidden?row.style.removeProperty("padding-bottom"):(this.rowDetailsRenderer?(cell._renderer=this.rowDetailsRenderer,cell._renderer.call(this,cell._content,this,{index:row.index,item:item})):this._rowDetailsTemplate&&!cell._instance&&(cell._instance=this._rowDetailsTemplate.templatizer.createInstance(),cell._content.innerHTML="",cell._content.appendChild(cell._instance.root),this._updateItem(row,item)),(0,_flush.flush)(),row.style.setProperty("padding-bottom",`${cell.offsetHeight}px`),requestAnimationFrame(()=>this.notifyResize()))),hiddenChanged&&(this._updateMetrics(),this._positionItems())}_updateDetailsCellHeights(){Array.from(this.$.items.querySelectorAll('[part~="details-cell"]:not([hidden])')).forEach(cell=>{cell.parentElement.style.setProperty("padding-bottom",`${cell.offsetHeight}px`)})}_isDetailsOpened(item){return this.detailsOpenedItems&&-1!==this._getItemIndexInArray(item,this.detailsOpenedItems)}openItemDetails(item){this._isDetailsOpened(item)||this.push("detailsOpenedItems",item)}closeItemDetails(item){this._isDetailsOpened(item)&&this.splice("detailsOpenedItems",this._getItemIndexInArray(item,this.detailsOpenedItems),1)}_detailsOpenedInstanceChangedCallback(instance,value){super._detailsOpenedInstanceChangedCallback&&super._detailsOpenedInstanceChangedCallback(instance,value),value?this.openItemDetails(instance.item):this.closeItemDetails(instance.item)}})});