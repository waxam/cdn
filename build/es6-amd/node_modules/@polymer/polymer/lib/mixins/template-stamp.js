define(["exports","../utils/boot.js","../utils/mixin.js"],(function(e,t,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TemplateStamp=void 0;
/**
  @license
  Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
  This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
  The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
  The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
  Code distributed by Google as part of the polymer project is also
  subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
  */
const a={"dom-if":!0,"dom-repeat":!0};let o=!1,r=!1;function fixPlaceholder(e){(function hasPlaceholderBug(){if(!o){o=!0;const e=document.createElement("textarea");e.placeholder="a",r=e.placeholder===e.textContent}return r})()&&"textarea"===e.localName&&e.placeholder&&e.placeholder===e.textContent&&(e.textContent=null)}function wrapTemplateExtension(e){let t=e.getAttribute("is");if(t&&a[t]){let n=e;for(n.removeAttribute("is"),e=n.ownerDocument.createElement(t),n.parentNode.replaceChild(e,n),e.appendChild(n);n.attributes.length;)e.setAttribute(n.attributes[0].name,n.attributes[0].value),n.removeAttribute(n.attributes[0].name)}return e}function findTemplateNode(e,t){let n=t.parentInfo&&findTemplateNode(e,t.parentInfo);if(!n)return e;for(let a=n.firstChild,o=0;a;a=a.nextSibling)if(t.parentIndex===o++)return a}function applyIdToMap(e,t,n,a){a.id&&(t[a.id]=n)}function applyEventListener(e,t,n){if(n.events&&n.events.length)for(let a,o=0,r=n.events;o<r.length&&(a=r[o]);o++)e._addMethodEventListenerToNode(t,a.name,a.value,e)}function applyTemplateContent(e,t,n){n.templateInfo&&(t._templateInfo=n.templateInfo)}const l=(0,n.dedupingMixin)(e=>class TemplateStamp extends e{static _parseTemplate(e,t){if(!e._templateInfo){let n=e._templateInfo={};n.nodeInfoList=[],n.stripWhiteSpace=t&&t.stripWhiteSpace||e.hasAttribute("strip-whitespace"),this._parseTemplateContent(e,n,{parent:null})}return e._templateInfo}static _parseTemplateContent(e,t,n){return this._parseTemplateNode(e.content,t,n)}static _parseTemplateNode(e,t,n){let a=!1,o=e;return"template"!=o.localName||o.hasAttribute("preserve-content")?"slot"===o.localName&&(t.hasInsertionPoint=!0):a=this._parseTemplateNestedTemplate(o,t,n)||a,fixPlaceholder(o),o.firstChild&&this._parseTemplateChildNodes(o,t,n),o.hasAttributes&&o.hasAttributes()&&(a=this._parseTemplateNodeAttributes(o,t,n)||a),a}static _parseTemplateChildNodes(e,t,n){if("script"!==e.localName&&"style"!==e.localName)for(let a,o=e.firstChild,r=0;o;o=a){if("template"==o.localName&&(o=wrapTemplateExtension(o)),a=o.nextSibling,o.nodeType===Node.TEXT_NODE){let n=a;for(;n&&n.nodeType===Node.TEXT_NODE;)o.textContent+=n.textContent,a=n.nextSibling,e.removeChild(n),n=a;if(t.stripWhiteSpace&&!o.textContent.trim()){e.removeChild(o);continue}}let l={parentIndex:r,parentInfo:n};this._parseTemplateNode(o,t,l)&&(l.infoIndex=t.nodeInfoList.push(l)-1),o.parentNode&&r++}}static _parseTemplateNestedTemplate(e,t,n){let a=e,o=this._parseTemplate(a,t);return(o.content=a.content.ownerDocument.createDocumentFragment()).appendChild(a.content),n.templateInfo=o,!0}static _parseTemplateNodeAttributes(e,t,n){let a=!1,o=Array.from(e.attributes);for(let r,l=o.length-1;r=o[l];l--)a=this._parseTemplateNodeAttribute(e,t,n,r.name,r.value)||a;return a}static _parseTemplateNodeAttribute(e,t,n,a,o){return"on-"===a.slice(0,3)?(e.removeAttribute(a),n.events=n.events||[],n.events.push({name:a.slice(3),value:o}),!0):"id"===a&&(n.id=o,!0)}static _contentForTemplate(e){let t=e._templateInfo;return t&&t.content||e.content}_stampTemplate(e){e&&!e.content&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate&&HTMLTemplateElement.decorate(e);let t=this.constructor._parseTemplate(e),n=t.nodeInfoList,a=t.content||e.content,o=document.importNode(a,!0);o.__noInsertionPoint=!t.hasInsertionPoint;let r=o.nodeList=new Array(n.length);o.$={};for(let l,i=0,s=n.length;i<s&&(l=n[i]);i++){let e=r[i]=findTemplateNode(o,l);applyIdToMap(0,o.$,e,l),applyTemplateContent(0,e,l),applyEventListener(this,e,l)}return o=o,o}_addMethodEventListenerToNode(e,t,n,a){let o=function createNodeEventHandler(e,t,n){return e=e._methodHost||e,function(t){e[n]?e[n](t,t.detail):console.warn("listener method `"+n+"` not defined")}}(a=a||e,0,n);return this._addEventListenerToNode(e,t,o),o}_addEventListenerToNode(e,t,n){e.addEventListener(t,n)}_removeEventListenerFromNode(e,t,n){e.removeEventListener(t,n)}});e.TemplateStamp=l}));