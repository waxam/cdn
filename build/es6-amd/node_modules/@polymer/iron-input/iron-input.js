define(["../polymer/polymer-legacy.js","../iron-a11y-announcer/iron-a11y-announcer.js","../iron-validatable-behavior/iron-validatable-behavior.js","../polymer/lib/legacy/polymer-fn.js","../polymer/lib/legacy/polymer.dom.js","../polymer/lib/utils/html-tag.js"],(function(_polymerLegacy,_ironA11yAnnouncer,_ironValidatableBehavior,_polymerFn,_polymerDom,_htmlTag){
/**
  @license
  Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
  This code may only be used under the BSD style license found at
  http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
  http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
  found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
  part of the polymer project is also subject to an additional IP rights grant
  found at http://polymer.github.io/PATENTS.txt
  */
(0,_polymerFn.Polymer)({_template:_htmlTag.html`
    <style>
      :host {
        display: inline-block;
      }
    </style>
    <slot id="content"></slot>
`,is:"iron-input",behaviors:[_ironValidatableBehavior.IronValidatableBehavior],properties:{bindValue:{type:String,value:""},value:{type:String,computed:"_computeValue(bindValue)"},allowedPattern:{type:String},autoValidate:{type:Boolean,value:!1},_inputElement:Object},observers:["_bindValueChanged(bindValue, _inputElement)"],listeners:{input:"_onInput",keypress:"_onKeypress"},created:function(){_ironA11yAnnouncer.IronA11yAnnouncer.requestAvailability(),this._previousValidInput="",this._patternAlreadyChecked=!1},attached:function(){this._observer=(0,_polymerDom.dom)(this).observeNodes(function(info){this._initSlottedInput()}.bind(this))},detached:function(){this._observer&&((0,_polymerDom.dom)(this).unobserveNodes(this._observer),this._observer=null)},get inputElement(){return this._inputElement},_initSlottedInput:function(){this._inputElement=this.getEffectiveChildren()[0],this.inputElement&&this.inputElement.value&&(this.bindValue=this.inputElement.value),this.fire("iron-input-ready")},get _patternRegExp(){var pattern;if(this.allowedPattern)pattern=new RegExp(this.allowedPattern);else switch(this.inputElement.type){case"number":pattern=/[0-9.,e-]/}return pattern},_bindValueChanged:function(bindValue,inputElement){inputElement&&(void 0===bindValue?inputElement.value=null:bindValue!==inputElement.value&&(this.inputElement.value=bindValue),this.autoValidate&&this.validate(),this.fire("bind-value-changed",{value:bindValue}))},_onInput:function(){this.allowedPattern&&!this._patternAlreadyChecked&&(this._checkPatternValidity()||(this._announceInvalidCharacter("Invalid string of characters not entered."),this.inputElement.value=this._previousValidInput));this.bindValue=this._previousValidInput=this.inputElement.value,this._patternAlreadyChecked=!1},_isPrintable:function(event){var anyNonPrintable=8==event.keyCode||9==event.keyCode||13==event.keyCode||27==event.keyCode,mozNonPrintable=19==event.keyCode||20==event.keyCode||45==event.keyCode||46==event.keyCode||144==event.keyCode||145==event.keyCode||event.keyCode>32&&event.keyCode<41||event.keyCode>111&&event.keyCode<124;return!(anyNonPrintable||0==event.charCode&&mozNonPrintable)},_onKeypress:function(event){if(this.allowedPattern||"number"===this.inputElement.type){var regexp=this._patternRegExp;if(regexp&&!(event.metaKey||event.ctrlKey||event.altKey)){this._patternAlreadyChecked=!0;var thisChar=String.fromCharCode(event.charCode);this._isPrintable(event)&&!regexp.test(thisChar)&&(event.preventDefault(),this._announceInvalidCharacter("Invalid character "+thisChar+" not entered."))}}},_checkPatternValidity:function(){var regexp=this._patternRegExp;if(!regexp)return!0;for(var i=0;i<this.inputElement.value.length;i++)if(!regexp.test(this.inputElement.value[i]))return!1;return!0},validate:function(){if(!this.inputElement)return this.invalid=!1,!0;var valid=this.inputElement.checkValidity();return valid&&(this.required&&""===this.bindValue?valid=!1:this.hasValidator()&&(valid=_ironValidatableBehavior.IronValidatableBehavior.validate.call(this,this.bindValue))),this.invalid=!valid,this.fire("iron-input-validate"),valid},_announceInvalidCharacter:function(message){this.fire("iron-announce",{text:message})},_computeValue:function(bindValue){return bindValue}})}));