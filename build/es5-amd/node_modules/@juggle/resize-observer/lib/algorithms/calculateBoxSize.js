define(["exports","../ResizeObserverBoxOptions.js","../DOMRectReadOnly.js","../utils/element.js","../utils/global.js"],function(_exports,_ResizeObserverBoxOptions,_DOMRectReadOnly,_element,_global){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.cache=_exports.calculateBoxSizes=_exports.calculateBoxSize=void 0;var cache=new Map;_exports.cache=cache;var scrollRegexp=/auto|scroll/,verticalRegexp=/^tb|vertical/,IE=/msie|trident/i.test(_global.global.navigator&&_global.global.navigator.userAgent),parseDimension=function parseDimension(pixel){return parseFloat(pixel||"0")},size=function size(inlineSize,blockSize,switchSizes){if(void 0===inlineSize){inlineSize=0}if(void 0===blockSize){blockSize=0}if(void 0===switchSizes){switchSizes=!1}return Object.freeze({inlineSize:(switchSizes?blockSize:inlineSize)||0,blockSize:(switchSizes?inlineSize:blockSize)||0})},zeroBoxes=Object.freeze({devicePixelContentBoxSize:size(),borderBoxSize:size(),contentBoxSize:size(),contentRect:new _DOMRectReadOnly.DOMRectReadOnly(0,0,0,0)}),calculateBoxSizes=function calculateBoxSizes(target){if(cache.has(target)){return cache.get(target)}if((0,_element.isHidden)(target)){cache.set(target,zeroBoxes);return zeroBoxes}var cs=getComputedStyle(target),svg=(0,_element.isSVG)(target)&&target.ownerSVGElement&&target.getBBox(),removePadding=!IE&&"border-box"===cs.boxSizing,switchSizes=verticalRegexp.test(cs.writingMode||""),canScrollVertically=!svg&&scrollRegexp.test(cs.overflowY||""),canScrollHorizontally=!svg&&scrollRegexp.test(cs.overflowX||""),paddingTop=svg?0:parseDimension(cs.paddingTop),paddingRight=svg?0:parseDimension(cs.paddingRight),paddingBottom=svg?0:parseDimension(cs.paddingBottom),paddingLeft=svg?0:parseDimension(cs.paddingLeft),borderTop=svg?0:parseDimension(cs.borderTopWidth),borderRight=svg?0:parseDimension(cs.borderRightWidth),borderBottom=svg?0:parseDimension(cs.borderBottomWidth),borderLeft=svg?0:parseDimension(cs.borderLeftWidth),horizontalPadding=paddingLeft+paddingRight,verticalPadding=paddingTop+paddingBottom,horizontalBorderArea=borderLeft+borderRight,verticalBorderArea=borderTop+borderBottom,horizontalScrollbarThickness=!canScrollHorizontally?0:target.offsetHeight-verticalBorderArea-target.clientHeight,verticalScrollbarThickness=!canScrollVertically?0:target.offsetWidth-horizontalBorderArea-target.clientWidth,widthReduction=removePadding?horizontalPadding+horizontalBorderArea:0,heightReduction=removePadding?verticalPadding+verticalBorderArea:0,contentWidth=svg?svg.width:parseDimension(cs.width)-widthReduction-verticalScrollbarThickness,contentHeight=svg?svg.height:parseDimension(cs.height)-heightReduction-horizontalScrollbarThickness,borderBoxWidth=contentWidth+horizontalPadding+verticalScrollbarThickness+horizontalBorderArea,borderBoxHeight=contentHeight+verticalPadding+horizontalScrollbarThickness+verticalBorderArea,boxes=Object.freeze({devicePixelContentBoxSize:size(Math.round(contentWidth*devicePixelRatio),Math.round(contentHeight*devicePixelRatio),switchSizes),borderBoxSize:size(borderBoxWidth,borderBoxHeight,switchSizes),contentBoxSize:size(contentWidth,contentHeight,switchSizes),contentRect:new _DOMRectReadOnly.DOMRectReadOnly(paddingLeft,paddingTop,contentWidth,contentHeight)});cache.set(target,boxes);return boxes};_exports.calculateBoxSizes=calculateBoxSizes;var calculateBoxSize=function calculateBoxSize(target,observedBox){var _a=calculateBoxSizes(target),borderBoxSize=_a.borderBoxSize,contentBoxSize=_a.contentBoxSize,devicePixelContentBoxSize=_a.devicePixelContentBoxSize;switch(observedBox){case _ResizeObserverBoxOptions.ResizeObserverBoxOptions.DEVICE_PIXEL_CONTENT_BOX:return devicePixelContentBoxSize;case _ResizeObserverBoxOptions.ResizeObserverBoxOptions.BORDER_BOX:return borderBoxSize;default:return contentBoxSize;}};_exports.calculateBoxSize=calculateBoxSize});