define(["exports","../../../@polymer/polymer/polymer-legacy.js","../../vaadin-themable-mixin/vaadin-themable-mixin.js","./vaadin-grid-scroller.js","./vaadin-grid-a11y-mixin.js","./vaadin-grid-active-item-mixin.js","./vaadin-grid-array-data-provider-mixin.js","./vaadin-grid-column-resizing-mixin.js","./vaadin-grid-data-provider-mixin.js","./vaadin-grid-dynamic-columns-mixin.js","./vaadin-grid-filter-mixin.js","./vaadin-grid-row-details-mixin.js","./vaadin-grid-scroll-mixin.js","./vaadin-grid-selection-mixin.js","./vaadin-grid-sort-mixin.js","./vaadin-grid-keyboard-navigation-mixin.js","./vaadin-grid-column-reordering-mixin.js","./vaadin-grid-column.js","./vaadin-grid-outer-scroller.js","./vaadin-grid-styles.js","../../vaadin-element-mixin/vaadin-element-mixin.js","../../../@polymer/polymer/lib/utils/html-tag.js","../../../@polymer/polymer/lib/utils/render-status.js","../../../@polymer/polymer/lib/utils/debounce.js","../../../@polymer/polymer/lib/utils/async.js"],function(_exports,_polymerLegacy,_vaadinThemableMixin,_vaadinGridScroller,_vaadinGridA11yMixin,_vaadinGridActiveItemMixin,_vaadinGridArrayDataProviderMixin,_vaadinGridColumnResizingMixin,_vaadinGridDataProviderMixin,_vaadinGridDynamicColumnsMixin,_vaadinGridFilterMixin,_vaadinGridRowDetailsMixin,_vaadinGridScrollMixin,_vaadinGridSelectionMixin,_vaadinGridSortMixin,_vaadinGridKeyboardNavigationMixin,_vaadinGridColumnReorderingMixin,_vaadinGridColumn,_vaadinGridOuterScroller,_vaadinGridStyles,_vaadinElementMixin,_htmlTag,_renderStatus,_debounce,_async){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.GridElement=void 0;function _templateObject_07127d20598711e9be72c76822165544(){var data=babelHelpers.taggedTemplateLiteral(["\n    <style include=\"vaadin-grid-styles\"></style>\n\n    <div id=\"scroller\" no-scrollbars$=\"[[!_scrollbarWidth]]\" wheel-scrolling$=\"[[_wheelScrolling]]\" safari$=\"[[_safari]]\" ios$=\"[[_ios]]\" loading$=\"[[loading]]\" edge$=\"[[_edge]]\" firefox$=\"[[_firefox]]\" ie$=\"[[_ie]]\" column-reordering-allowed$=\"[[columnReorderingAllowed]]\">\n\n      <table id=\"table\" role=\"grid\" aria-multiselectable=\"true\" tabindex=\"0\">\n        <caption id=\"fixedsizer\" class=\"sizer\" part=\"row\"></caption>\n        <thead id=\"header\" role=\"rowgroup\"></thead>\n        <tbody id=\"items\" role=\"rowgroup\"></tbody>\n        <tfoot id=\"footer\" role=\"rowgroup\"></tfoot>\n      </table>\n\n      <div part=\"reorder-ghost\"></div>\n      <vaadin-grid-outer-scroller id=\"outerscroller\" _touch-device=\"[[_touchDevice]]\" scroll-target=\"[[scrollTarget]]\" scroll-handler=\"[[_this]]\" no-scrollbars=\"[[!_scrollbarWidth]]\">\n        <div id=\"outersizer\" class=\"sizer\" part=\"row\"></div>\n      </vaadin-grid-outer-scroller>\n    </div>\n\n    <!-- The template needs at least one slot or else shady doesn't distribute -->\n    <slot name=\"nodistribute\"></slot>\n\n    <div id=\"focusexit\" tabindex=\"0\"></div>\n"],["\n    <style include=\"vaadin-grid-styles\"></style>\n\n    <div id=\"scroller\" no-scrollbars\\$=\"[[!_scrollbarWidth]]\" wheel-scrolling\\$=\"[[_wheelScrolling]]\" safari\\$=\"[[_safari]]\" ios\\$=\"[[_ios]]\" loading\\$=\"[[loading]]\" edge\\$=\"[[_edge]]\" firefox\\$=\"[[_firefox]]\" ie\\$=\"[[_ie]]\" column-reordering-allowed\\$=\"[[columnReorderingAllowed]]\">\n\n      <table id=\"table\" role=\"grid\" aria-multiselectable=\"true\" tabindex=\"0\">\n        <caption id=\"fixedsizer\" class=\"sizer\" part=\"row\"></caption>\n        <thead id=\"header\" role=\"rowgroup\"></thead>\n        <tbody id=\"items\" role=\"rowgroup\"></tbody>\n        <tfoot id=\"footer\" role=\"rowgroup\"></tfoot>\n      </table>\n\n      <div part=\"reorder-ghost\"></div>\n      <vaadin-grid-outer-scroller id=\"outerscroller\" _touch-device=\"[[_touchDevice]]\" scroll-target=\"[[scrollTarget]]\" scroll-handler=\"[[_this]]\" no-scrollbars=\"[[!_scrollbarWidth]]\">\n        <div id=\"outersizer\" class=\"sizer\" part=\"row\"></div>\n      </vaadin-grid-outer-scroller>\n    </div>\n\n    <!-- The template needs at least one slot or else shady doesn't distribute -->\n    <slot name=\"nodistribute\"></slot>\n\n    <div id=\"focusexit\" tabindex=\"0\"></div>\n"]);_templateObject_07127d20598711e9be72c76822165544=function(){return data};return data}var TOUCH_DEVICE=function(){try{document.createEvent("TouchEvent");return!0}catch(e){return!1}}(),GridElement=function(_ElementMixin){babelHelpers.inherits(GridElement,_ElementMixin);babelHelpers.createClass(GridElement,null,[{key:"template",get:function get(){return(0,_htmlTag.html)(_templateObject_07127d20598711e9be72c76822165544())}},{key:"is",get:function get(){return"vaadin-grid"}},{key:"version",get:function get(){return"5.2.5"}},{key:"observers",get:function get(){return["_columnTreeChanged(_columnTree, _columnTree.*)"]}},{key:"properties",get:function get(){return{_this:{type:Object,value:function value(){return this}},_safari:{type:Boolean,value:/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},_ios:{type:Boolean,value:/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},_edge:{type:Boolean,value:"undefined"!==typeof CSS&&CSS.supports("(-ms-ime-align:auto)")},_ie:{type:Boolean,value:!!(navigator.userAgent.match(/Trident/)&&!navigator.userAgent.match(/MSIE/))},_firefox:{type:Boolean,value:-1<navigator.userAgent.toLowerCase().indexOf("firefox")},_android:{type:Boolean,value:/android/i.test(navigator.userAgent)},_touchDevice:{type:Boolean,value:TOUCH_DEVICE},heightByRows:{type:Boolean,value:!1,reflectToAttribute:!0}}}}]);function GridElement(){var _this;babelHelpers.classCallCheck(this,GridElement);_this=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(GridElement).call(this));_this.addEventListener("animationend",_this._onAnimationEnd);return _this}babelHelpers.createClass(GridElement,[{key:"_createScrollerRows",value:function _createScrollerRows(count){for(var _this2=this,rows=[],i=0,row;i<count;i++){row=document.createElement("tr");row.setAttribute("part","row");row.setAttribute("role","row");if(this._columnTree){this._updateRow(row,this._columnTree[this._columnTree.length-1],"body",!1,!0)}rows.push(row)}if(this._columnTree){this._columnTree[this._columnTree.length-1].forEach(function(c){return c.notifyPath("_cells.*",c._cells)})}(0,_renderStatus.beforeNextRender)(this,function(){_this2._updateFirstAndLastColumn();_this2._resetKeyboardNavigation()});return rows}},{key:"_getRowTarget",value:function _getRowTarget(){return this.$.items}},{key:"_createCell",value:function _createCell(tagName){var _this3=this,contentId=this._contentIndex=this._contentIndex+1||0,slotName="vaadin-grid-cell-content-"+contentId,cellContent=document.createElement("vaadin-grid-cell-content");cellContent.setAttribute("slot",slotName);var cell=document.createElement(tagName);cell.id=slotName.replace("-content-","-");cell.setAttribute("tabindex","-1");cell.setAttribute("role","td"===tagName?"gridcell":"columnheader");var slot=document.createElement("slot");slot.setAttribute("name",slotName);cell.appendChild(slot);cell._content=cellContent;cellContent.addEventListener("mousedown",function(){if(window.chrome){var mouseUpListener=function(){if(!cellContent.contains(_this3.getRootNode().activeElement)){cell.focus()}document.removeEventListener("mouseup",mouseUpListener,!0)};document.addEventListener("mouseup",mouseUpListener,!0)}else{setTimeout(function(){if(!cellContent.contains(_this3.getRootNode().activeElement)){cell.focus()}})}});return cell}},{key:"_updateRow",value:function _updateRow(row,columns,section,isColumnRow,noNotify){var _this4=this;section=section||"body";var contentsFragment=document.createDocumentFragment();Array.from(row.children).forEach(function(cell){return cell._vacant=!0});row.innerHTML="";if("outersizer"!==row.id&&"fixedsizer"!==row.id){row.hidden=!0}columns.forEach(function(column,index){var cell;if("body"===section){column._cells=column._cells||[];cell=column._cells.filter(function(cell){return cell._vacant})[0];if(!cell){cell=_this4._createCell("td");column._cells.push(cell)}cell.setAttribute("part","cell body-cell");row.appendChild(cell);if(index===columns.length-1&&(_this4._rowDetailsTemplate||_this4.rowDetailsRenderer)){_this4._detailsCells=_this4._detailsCells||[];var detailsCell=_this4._detailsCells.filter(function(cell){return cell._vacant})[0]||_this4._createCell("td");if(-1===_this4._detailsCells.indexOf(detailsCell)){_this4._detailsCells.push(detailsCell)}if(!detailsCell._content.parentElement){contentsFragment.appendChild(detailsCell._content)}_this4._configureDetailsCell(detailsCell);row.appendChild(detailsCell);_this4._a11ySetRowDetailsCell(row,detailsCell);detailsCell._vacant=!1}if(column.notifyPath&&!noNotify){column.notifyPath("_cells.*",column._cells)}}else{var tagName="header"===section?"th":"td";if(isColumnRow||"vaadin-grid-column-group"===column.localName){cell=column["_".concat(section,"Cell")]||_this4._createCell(tagName);row.appendChild(cell);if(cell._instance){row.hidden=!1}column["_".concat(section,"Cell")]=cell}else{column._emptyCells=column._emptyCells||[];cell=column._emptyCells.filter(function(cell){return cell._vacant})[0]||_this4._createCell(tagName);row.appendChild(cell);if(-1===column._emptyCells.indexOf(cell)){column._emptyCells.push(cell)}}cell.setAttribute("part","cell ".concat(section,"-cell"))}if(!cell._content.parentElement){contentsFragment.appendChild(cell._content)}cell._vacant=!1;cell._column=column});this.appendChild(contentsFragment);this._frozenCellsChanged();this._updateFirstAndLastColumnForRow(row)}},{key:"_updateScrollerItem",value:function _updateScrollerItem(row,index){this._preventScrollerRotatingCellFocus(row,index);if(!this._columnTree){return}this._toggleAttribute("first",0===index,row);this._toggleAttribute("odd",index%2,row);this._a11yUpdateRowRowindex(row,index);this._getItem(index,row)}},{key:"_columnTreeChanged",value:function _columnTreeChanged(columnTree){var _this5=this;Array.from(this.$.items.children).forEach(function(row){return _this5._updateRow(row,columnTree[columnTree.length-1])});while(this.$.header.children.length<columnTree.length){var headerRow=document.createElement("tr");headerRow.setAttribute("part","row");headerRow.setAttribute("role","row");this.$.header.appendChild(headerRow);var footerRow=document.createElement("tr");footerRow.setAttribute("part","row");footerRow.setAttribute("role","row");this.$.footer.appendChild(footerRow)}while(this.$.header.children.length>columnTree.length){this.$.header.removeChild(this.$.header.firstElementChild);this.$.footer.removeChild(this.$.footer.firstElementChild)}Array.from(this.$.header.children).forEach(function(headerRow,index){return _this5._updateRow(headerRow,columnTree[index],"header",index===columnTree.length-1)});Array.from(this.$.footer.children).forEach(function(footerRow,index){return _this5._updateRow(footerRow,columnTree[columnTree.length-1-index],"footer",0===index)});this._updateRow(this.$.outersizer,columnTree[columnTree.length-1]);this._updateRow(this.$.fixedsizer,columnTree[columnTree.length-1]);this._resizeHandler();this._frozenCellsChanged();this._updateFirstAndLastColumn();this._resetKeyboardNavigation();this._a11yUpdateHeaderRows();this._a11yUpdateFooterRows()}},{key:"_updateItem",value:function _updateItem(row,item){var _this6=this;row._item=item;var model=this.__getRowModel(row);this._toggleAttribute("selected",model.selected,row);this._a11yUpdateRowSelected(row,model.selected);this._a11yUpdateRowLevel(row,model.level);this._toggleAttribute("expanded",model.expanded,row);if(this._rowDetailsTemplate||this.rowDetailsRenderer){this._toggleDetailsCell(row,item)}Array.from(row.children).forEach(function(cell){if(cell._renderer){var owner=cell._column||_this6;cell._renderer.call(owner,cell._content,owner,model)}else if(cell._instance){cell._instance.__detailsOpened__=model.detailsOpened;cell._instance.__selected__=model.selected;cell._instance.__level__=model.level;cell._instance.__expanded__=model.expanded;cell._instance.setProperties(model)}});this._debouncerUpdateHeights=_debounce.Debouncer.debounce(this._debouncerUpdateHeights,_async.timeOut.after(1),function(){_this6._updateMetrics();_this6._positionItems();_this6._updateScrollerSize()})}},{key:"_resizeHandler",value:function _resizeHandler(){this._updateDetailsCellHeights();this._accessIronListAPI(babelHelpers.get(babelHelpers.getPrototypeOf(GridElement.prototype),"_resizeHandler",this),!0);this._updateHeaderFooterMetrics()}},{key:"_updateHeaderFooterMetrics",value:function _updateHeaderFooterMetrics(){var _this7=this,headerHeight=this.$.header.clientHeight+"px",footerHeight=this.$.footer.clientHeight+"px";[this.$.outersizer,this.$.fixedsizer,this.$.items].forEach(function(element){element.style.borderTopWidth=headerHeight;element.style.borderBottomWidth=footerHeight});(0,_renderStatus.afterNextRender)(this.$.header,function(){if(_this7._pendingScrollToIndex){_this7._scrollToIndex(_this7._pendingScrollToIndex)}})}},{key:"_onAnimationEnd",value:function _onAnimationEnd(e){if(0===e.animationName.indexOf("vaadin-grid-appear")){this._render();this._updateHeaderFooterMetrics();e.stopPropagation();this.notifyResize()}}},{key:"_toggleAttribute",value:function _toggleAttribute(name,bool,node){if(node.hasAttribute(name)===!bool){if(bool){node.setAttribute(name,"")}else{node.removeAttribute(name)}}}},{key:"__getRowModel",value:function __getRowModel(row){return{index:row.index,item:row._item,level:this._getIndexLevel(row.index),expanded:this._isExpanded(row._item),selected:this._isSelected(row._item),detailsOpened:!!(this._rowDetailsTemplate||this.rowDetailsRenderer)&&this._isDetailsOpened(row._item)}}},{key:"render",value:function render(){if(this._columnTree){this._columnTree.forEach(function(level){level.forEach(function(column){return column._renderHeaderAndFooter()})});this._update()}}},{key:"notifyResize",value:function notifyResize(){babelHelpers.get(babelHelpers.getPrototypeOf(GridElement.prototype),"notifyResize",this).call(this)}}]);return GridElement}((0,_vaadinElementMixin.ElementMixin)((0,_vaadinThemableMixin.ThemableMixin)((0,_vaadinGridDataProviderMixin.DataProviderMixin)((0,_vaadinGridArrayDataProviderMixin.ArrayDataProviderMixin)((0,_vaadinGridDynamicColumnsMixin.DynamicColumnsMixin)((0,_vaadinGridActiveItemMixin.ActiveItemMixin)((0,_vaadinGridScrollMixin.ScrollMixin)((0,_vaadinGridSelectionMixin.SelectionMixin)((0,_vaadinGridSortMixin.SortMixin)((0,_vaadinGridRowDetailsMixin.RowDetailsMixin)((0,_vaadinGridKeyboardNavigationMixin.KeyboardNavigationMixin)((0,_vaadinGridA11yMixin.A11yMixin)((0,_vaadinGridFilterMixin.FilterMixin)((0,_vaadinGridColumnReorderingMixin.ColumnReorderingMixin)((0,_vaadinGridColumnResizingMixin.ColumnResizingMixin)(_vaadinGridScroller.ScrollerElement))))))))))))))));_exports.GridElement=GridElement;customElements.define(GridElement.is,GridElement)});