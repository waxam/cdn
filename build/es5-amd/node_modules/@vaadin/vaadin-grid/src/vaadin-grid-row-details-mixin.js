define(["exports","./vaadin-grid-templatizer.js","../../../@polymer/polymer/lib/utils/flush.js"],function(_exports,_vaadinGridTemplatizer,_flush){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.RowDetailsMixin=void 0;_exports.RowDetailsMixin=function RowDetailsMixin(superClass){return function(_superClass){babelHelpers.inherits(RowDetailsMixin,_superClass);function RowDetailsMixin(){babelHelpers.classCallCheck(this,RowDetailsMixin);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(RowDetailsMixin).apply(this,arguments))}babelHelpers.createClass(RowDetailsMixin,[{key:"_rowDetailsTemplateOrRendererChanged",value:function _rowDetailsTemplateOrRendererChanged(rowDetailsTemplate,rowDetailsRenderer){var _this=this;if(rowDetailsTemplate&&rowDetailsRenderer){throw new Error("You should only use either a renderer or a template for row details")}if(rowDetailsTemplate||rowDetailsRenderer){if(rowDetailsTemplate&&!rowDetailsTemplate.templatizer){var templatizer=new _vaadinGridTemplatizer.Templatizer;templatizer._grid=this;templatizer.dataHost=this.dataHost;templatizer.template=rowDetailsTemplate;rowDetailsTemplate.templatizer=templatizer}if(this._columnTree){Array.from(this.$.items.children).forEach(function(row){if(!row.querySelector("[part~=details-cell]")){_this._updateRow(row,_this._columnTree[_this._columnTree.length-1]);_this._a11yUpdateRowDetailsOpened(row,!1)}delete row.querySelector("[part~=details-cell]")._instance})}if(this.detailsOpenedItems.length){Array.from(this.$.items.children).forEach(this._toggleDetailsCell,this);this._update()}}}},{key:"_detailsOpenedItemsChanged",value:function _detailsOpenedItemsChanged(changeRecord){var _this2=this;if("detailsOpenedItems.length"===changeRecord.path||!changeRecord.value){return}Array.from(this.$.items.children).forEach(function(row){_this2._toggleDetailsCell(row,row._item);_this2._a11yUpdateRowDetailsOpened(row,_this2._isDetailsOpened(row._item))})}},{key:"_configureDetailsCell",value:function _configureDetailsCell(cell){cell.setAttribute("part","cell details-cell");this._toggleAttribute("frozen",!0,cell)}},{key:"_toggleDetailsCell",value:function _toggleDetailsCell(row,item){var cell=row.querySelector("[part~=\"details-cell\"]");if(!cell){return}var detailsHidden=!this._isDetailsOpened(item),hiddenChanged=!!cell.hidden!==detailsHidden;if(!cell._instance&&!cell._renderer||cell.hidden!==detailsHidden){cell.hidden=detailsHidden;if(detailsHidden){row.style.removeProperty("padding-bottom")}else{if(this.rowDetailsRenderer){cell._renderer=this.rowDetailsRenderer;cell._renderer.call(this,cell._content,this,{index:row.index,item:item})}else if(this._rowDetailsTemplate&&!cell._instance){cell._instance=this._rowDetailsTemplate.templatizer.createInstance();cell._content.innerHTML="";cell._content.appendChild(cell._instance.root);this._updateItem(row,item)}(0,_flush.flush)();row.style.setProperty("padding-bottom","".concat(cell.offsetHeight,"px"))}}if(hiddenChanged){this._updateMetrics();this._positionItems()}}},{key:"_updateDetailsCellHeights",value:function _updateDetailsCellHeights(){Array.from(this.$.items.querySelectorAll("[part~=\"details-cell\"]:not([hidden])")).forEach(function(cell){cell.parentElement.style.setProperty("padding-bottom","".concat(cell.offsetHeight,"px"))})}},{key:"_isDetailsOpened",value:function _isDetailsOpened(item){return this.detailsOpenedItems&&-1!==this._getItemIndexInArray(item,this.detailsOpenedItems)}},{key:"openItemDetails",value:function openItemDetails(item){if(!this._isDetailsOpened(item)){this.push("detailsOpenedItems",item)}}},{key:"closeItemDetails",value:function closeItemDetails(item){if(this._isDetailsOpened(item)){this.splice("detailsOpenedItems",this._getItemIndexInArray(item,this.detailsOpenedItems),1)}}},{key:"_detailsOpenedInstanceChangedCallback",value:function _detailsOpenedInstanceChangedCallback(instance,value){if(babelHelpers.get(babelHelpers.getPrototypeOf(RowDetailsMixin.prototype),"_detailsOpenedInstanceChangedCallback",this)){babelHelpers.get(babelHelpers.getPrototypeOf(RowDetailsMixin.prototype),"_detailsOpenedInstanceChangedCallback",this).call(this,instance,value)}if(value){this.openItemDetails(instance.item)}else{this.closeItemDetails(instance.item)}}}],[{key:"properties",get:function get(){return{detailsOpenedItems:{type:Array,value:function value(){return[]}},_rowDetailsTemplate:Object,rowDetailsRenderer:Function,_detailsCells:{type:Array}}}},{key:"observers",get:function get(){return["_detailsOpenedItemsChanged(detailsOpenedItems.*, _rowDetailsTemplate, rowDetailsRenderer)","_rowDetailsTemplateOrRendererChanged(_rowDetailsTemplate, rowDetailsRenderer)"]}}]);return RowDetailsMixin}(superClass)}});