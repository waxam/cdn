define(["exports"],function(_exports){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.ControlStateMixin=void 0;var TabIndexMixin=function(superClass){return function(_superClass){babelHelpers.inherits(VaadinTabIndexMixin,_superClass);function VaadinTabIndexMixin(){babelHelpers.classCallCheck(this,VaadinTabIndexMixin);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(VaadinTabIndexMixin).apply(this,arguments))}babelHelpers.createClass(VaadinTabIndexMixin,null,[{key:"properties",get:function get(){var properties={tabindex:{type:Number,value:0,reflectToAttribute:!0,observer:"_tabindexChanged"}};if(window.ShadyDOM){properties.tabIndex=properties.tabindex}return properties}}]);return VaadinTabIndexMixin}(superClass)};_exports.ControlStateMixin=function ControlStateMixin(superClass){return function(_TabIndexMixin){babelHelpers.inherits(VaadinControlStateMixin,_TabIndexMixin);function VaadinControlStateMixin(){babelHelpers.classCallCheck(this,VaadinControlStateMixin);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(VaadinControlStateMixin).apply(this,arguments))}babelHelpers.createClass(VaadinControlStateMixin,[{key:"ready",value:function ready(){var _this=this;this.addEventListener("focusin",function(e){if(e.composedPath()[0]===_this){_this._focus(e)}else if(-1!==e.composedPath().indexOf(_this.focusElement)&&!_this.disabled){_this._setFocused(!0)}});this.addEventListener("focusout",function(){return _this._setFocused(!1)});babelHelpers.get(babelHelpers.getPrototypeOf(VaadinControlStateMixin.prototype),"ready",this).call(this);var ensureEventComposed=function(e){if(!e.composed){e.target.dispatchEvent(new CustomEvent(e.type,{bubbles:!0,composed:!0,cancelable:!1}))}};this.shadowRoot.addEventListener("focusin",ensureEventComposed);this.shadowRoot.addEventListener("focusout",ensureEventComposed);this.addEventListener("keydown",function(e){if(!e.defaultPrevented&&e.shiftKey&&9===e.keyCode){_this._isShiftTabbing=!0;HTMLElement.prototype.focus.apply(_this);_this._setFocused(!1);setTimeout(function(){return _this._isShiftTabbing=!1},0)}});if(this.autofocus&&!this.focused&&!this.disabled){window.requestAnimationFrame(function(){_this._focus();_this._setFocused(!0);_this.setAttribute("focus-ring","")})}this._boundKeydownListener=this._bodyKeydownListener.bind(this);this._boundKeyupListener=this._bodyKeyupListener.bind(this)}},{key:"connectedCallback",value:function connectedCallback(){babelHelpers.get(babelHelpers.getPrototypeOf(VaadinControlStateMixin.prototype),"connectedCallback",this).call(this);document.body.addEventListener("keydown",this._boundKeydownListener,!0);document.body.addEventListener("keyup",this._boundKeyupListener,!0)}},{key:"disconnectedCallback",value:function disconnectedCallback(){babelHelpers.get(babelHelpers.getPrototypeOf(VaadinControlStateMixin.prototype),"disconnectedCallback",this).call(this);document.body.removeEventListener("keydown",this._boundKeydownListener,!0);document.body.removeEventListener("keyup",this._boundKeyupListener,!0);if(this.hasAttribute("focused")){this._setFocused(!1)}}},{key:"_setFocused",value:function _setFocused(focused){if(focused){this.setAttribute("focused","")}else{this.removeAttribute("focused")}if(focused&&this._tabPressed){this.setAttribute("focus-ring","")}else{this.removeAttribute("focus-ring")}}},{key:"_bodyKeydownListener",value:function _bodyKeydownListener(e){this._tabPressed=9===e.keyCode}},{key:"_bodyKeyupListener",value:function _bodyKeyupListener(){this._tabPressed=!1}},{key:"_focus",value:function _focus(){if(this._isShiftTabbing){return}this.focusElement.focus();this._setFocused(!0)}},{key:"focus",value:function focus(){if(!this.focusElement||this.disabled){return}this.focusElement.focus();this._setFocused(!0)}},{key:"blur",value:function blur(){this.focusElement.blur();this._setFocused(!1)}},{key:"_disabledChanged",value:function _disabledChanged(disabled){this.focusElement.disabled=disabled;if(disabled){this.blur();this._previousTabIndex=this.tabindex;this.tabindex=-1;this.setAttribute("aria-disabled","true")}else{if("undefined"!==typeof this._previousTabIndex){this.tabindex=this._previousTabIndex}this.removeAttribute("aria-disabled")}}},{key:"_tabindexChanged",value:function _tabindexChanged(tabindex){if(tabindex!==void 0){this.focusElement.tabIndex=tabindex}if(this.disabled&&this.tabindex){if(-1!==this.tabindex){this._previousTabIndex=this.tabindex}this.tabindex=tabindex=void 0}if(window.ShadyDOM){this.setProperties({tabIndex:tabindex,tabindex:tabindex})}}},{key:"focusElement",get:function get(){window.console.warn("Please implement the 'focusElement' property in <".concat(this.localName,">"));return this}}],[{key:"properties",get:function get(){return{autofocus:{type:Boolean},_previousTabIndex:{type:Number},disabled:{type:Boolean,observer:"_disabledChanged",reflectToAttribute:!0},_isShiftTabbing:{type:Boolean}}}}]);return VaadinControlStateMixin}(TabIndexMixin(superClass))}});