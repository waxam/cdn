define(["exports","meta","../../@polymer/polymer/polymer-legacy.js","../../@polymer/polymer/lib/utils/resolve-url.js","../es-global-bridge/es-global-bridge.js","./lib/img-loader.js"],function(_exports,meta,_polymerLegacy,_resolveUrl){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.ImgPanZoom=void 0;meta=babelHelpers.interopRequireWildcard(meta);function _templateObject_2392c970490411e990ee3fd35bb8725b(){var data=babelHelpers.taggedTemplateLiteral(["\n    <style>\n      :host {\n        display: block;\n        position: relative;\n        height: 500px;\n      }\n      #viewer {\n        position: relative;\n        height: 100%;\n        width: 100%;\n      }\n\n      paper-spinner-lite {\n        opacity: 0;\n        display: block;\n        transition: opacity 700ms;\n        position: absolute;\n        margin: auto;\n        top: 0;\n        left: 0;\n        bottom: 0;\n        right: 0;\n        z-index: 1;\n        height: 70px;\n        width: 70px;\n        --paper-spinner-color: var(--img-pan-zoom-spinner-color, #2196f3);\n        --paper-spinner-stroke-width: var(--img-pan-zoom-spinner-width, 5px);\n        @apply --img-pan-zoom-spinner;\n      }\n      paper-spinner-lite[active] {\n        opacity: 1;\n      }\n    </style>\n\n    <!-- Only preload regular images -->\n    <template is=\"dom-if\" if=\"[[!dzi]]\">\n      <paper-spinner-lite\n        hidden$=\"[[hideSpinner]]\"\n        active=\"[[loading]]\"\n      ></paper-spinner-lite>\n      <img-loader\n        loaded=\"{{loaded}}\"\n        loading=\"{{loading}}\"\n        src=\"[[src]]\"\n      ></img-loader>\n    </template>\n\n    <!-- Openseadragon -->\n    <div id=\"viewer\"></div>\n  "]);_templateObject_2392c970490411e990ee3fd35bb8725b=function(){return data};return data}var ImgPanZoom=(0,_polymerLegacy.Polymer)({_template:(0,_polymerLegacy.html)(_templateObject_2392c970490411e990ee3fd35bb8725b()),is:"img-pan-zoom",properties:{src:{type:String},dzi:{type:Boolean,value:!1},fadeIn:{type:Boolean,value:!0},loading:{type:Boolean,readonly:!0,notify:!0},hideSpinner:{type:Boolean,value:!1},loaded:{type:Boolean,readonly:!0,notify:!0,observer:"_loadedChanged"},showNavigationControl:{type:Boolean,value:!1},showNavigator:{type:Boolean,value:!1},zoomPerClick:{type:Number,value:2},zoomPerScroll:{type:Number,value:1.2},animationTime:{type:Number,value:1.2},navPrevNextWrap:{type:Boolean,value:!1},showRotationControl:{type:Boolean,value:!1},minZoomImageRatio:{type:Number,value:1},maxZoomPixelRatio:{type:Number,value:1.1},constrainDuringPan:{type:Boolean,value:!1},visibilityRatio:{type:Number,value:1}},observers:["_srcChanged(src)"],created:function created(){var name="openseadragon",basePath=(0,_resolveUrl.pathFromUrl)(decodeURIComponent(meta.url)),location="".concat(basePath,"lib/openseadragon/build/openseadragon/openseadragon.js");window.addEventListener("es-bridge-".concat(name,"-loaded"),this._openseadragonLoaded.bind(this));window.ESGlobalBridge.requestAvailability();window.ESGlobalBridge.instance.load(name,location)},_openseadragonLoaded:function _openseadragonLoaded(){this.__openseadragonLoaded=!0;if(this.dzi){this._initOpenSeadragon()}},ready:function ready(){this.animationConfig={fade:{name:"fade-in-animation",node:this.$.viewer}};if(this.dzi&&this.__openseadragonLoaded){this._initOpenSeadragon()}},_initOpenSeadragon:function _initOpenSeadragon(){var _this=this;setTimeout(function(){var tileSources=_this.src;if(!_this.dzi){tileSources={type:"image",url:_this.src,buildPyramid:!1}}_this.viewer=new OpenSeadragon({element:_this.$.viewer,visibilityRatio:_this.visibilityRatio,constrainDuringPan:_this.constrainDuringPan,showNavigationControl:_this.showNavigationControl,showNavigator:_this.showNavigator,zoomPerClick:_this.zoomPerClick,zoomPerScroll:_this.zoomPerScroll,animationTime:_this.animationTime,navPrevNextWrap:_this.navPrevNextWrap,showRotationControl:_this.showRotationControl,minZoomImageRatio:_this.minZoomImageRatio,maxZoomPixelRatio:_this.maxZoomPixelRatio,tileSources:tileSources});_this.init=!0},100)},destroy:function destroy(){this.viewer.destroy()},zoomIn:function zoomIn(){var currentZoom=this.viewer.viewport.getZoom(),maxZoom=this.viewer.viewport.getMaxZoom(),zoomTo=currentZoom+.7;if(zoomTo<maxZoom){this.viewer.viewport.zoomTo(zoomTo)}},zoomOut:function zoomOut(){var currentZoom=this.viewer.viewport.getZoom(),minZoom=this.viewer.viewport.getMinZoom(),zoomTo=currentZoom-.7;if(zoomTo>minZoom){this.viewer.viewport.zoomTo(zoomTo)}else{if(minZoom!=currentZoom){this.resetZoom()}}},resetZoom:function resetZoom(){this.viewer.viewport.goHome()},_srcChanged:function _srcChanged(){if(this.dzi&&this.init){this._addTiledImage()}},_loadedChanged:function _loadedChanged(){if(this.loaded){if(!this.init){this._initOpenSeadragon()}else{this._addImage()}}},_addImage:function _addImage(){this.viewer.addSimpleImage({url:this.src,index:0,replace:!0})},_addTiledImage:function _addTiledImage(){this.viewer.addTiledImage({tileSource:this.src,index:0,replace:!0})}});_exports.ImgPanZoom=ImgPanZoom});