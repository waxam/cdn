// H5P iframe Resizer
(function(){if(!window.postMessage||!window.addEventListener||window.h5pResizerInitialized){return;// Not supported
}window.h5pResizerInitialized=!0;// Map actions to handlers
var actionHandlers={hello:function(iframe,data,respond){// Make iframe responsive
iframe.style.width="100%";// Bugfix for Chrome: Force update of iframe width. If this is not done the
// document size may not be updated before the content resizes.
iframe.getBoundingClientRect();// Tell iframe that it needs to resize when our window resizes
var resize=function resize(){if(iframe.contentWindow){// Limit resize calls to avoid flickering
respond("resize")}else{// Frame is gone, unregister.
window.removeEventListener("resize",resize)}};window.addEventListener("resize",resize,!1);// Respond to let the iframe know we can resize it
respond("hello")},prepareResize:function(iframe,data,respond){// Do not resize unless page and scrolling differs
if(iframe.clientHeight!==data.scrollHeight||data.scrollHeight!==data.clientHeight){// Reset iframe height, in case content has shrinked.
iframe.style.height=data.clientHeight+"px";respond("resizePrepared")}},resize:function(iframe,data){// Resize iframe so all content is visible. Use scrollHeight to make sure we get everything
iframe.style.height=data.scrollHeight+"px"}},escape=function escape(event){if(27===event.keyCode){exitFullScreen()}};/**
   * Prepare iframe resize.
   *
   * @private
   * @param {Object} iframe Element
   * @param {Object} data Payload
   * @param {Function} respond Send a response to the iframe
   */ // Listen for messages from iframes
window.addEventListener("message",function receiveMessage(event){if("h5p"!==event.data.context){return;// Only handle h5p requests.
}// Find out who sent the message
for(var iframe,iframes=document.getElementsByTagName("iframe"),i=0;i<iframes.length;i++){if(iframes[i].contentWindow===event.source){iframe=iframes[i];break}}if(!iframe){return;// Cannot find sender
}// Find action handler handler
if(actionHandlers[event.data.action]){actionHandlers[event.data.action](iframe,event.data,function respond(action,data){if(data===void 0){data={}}data.action=action;data.context="h5p";event.source.postMessage(data,event.origin)})}},!1);// Let h5p iframes know we're ready!
for(var iframes=document.getElementsByTagName("iframe"),ready={context:"h5p",action:"ready"},i=0;i<iframes.length;i++){if(-1!==iframes[i].src.indexOf("h5p")){iframes[i].contentWindow.postMessage(ready,"*")}}})();