!function(b,f){"object"==("undefined"===typeof exports?"undefined":babelHelpers.typeof(exports))&&"undefined"!=typeof module?f(exports,require("@polymer/polymer/lib/legacy/polymer.dom.js"),require("@polymer/polymer/lib/utils/resolve-url.js"),require("@polymer/iron-icon/iron-icon.js"),require("@polymer/paper-menu-button/paper-menu-button.js"),require("@polymer/paper-dropdown-menu/paper-dropdown-menu.js"),require("@lrnwebcomponents/hax-body-behaviors/lib/HAXWiring.js"),require("@lrnwebcomponents/lrnsys-layout/lrnsys-layout.js"),require("@lrnwebcomponents/lrnsys-layout/lib/lrnsys-dialog.js"),require("@lrnwebcomponents/lrnsys-layout/lib/lrnsys-collapselist.js"),require("@lrnwebcomponents/lrnsys-layout/lib/lrnsys-collapselist-item.js"),require("@lrnwebcomponents/es-global-bridge/es-global-bridge.js"),require("@polymer/polymer/polymer-legacy.js"),require("@polymer/paper-button/paper-button.js"),require("@polymer/iron-icons/iron-icons.js"),require("@lrnwebcomponents/materializecss-styles/lib/colors.js"),require("@polymer/paper-card/paper-card.js"),require("@lrnwebcomponents/lrnsys-layout/lib/lrnsys-drawer.js"),require("@polymer/iron-ajax/iron-ajax.js")):"function"==typeof define&&define.amd?define(["exports","@polymer/polymer/lib/legacy/polymer.dom.js","@polymer/polymer/lib/utils/resolve-url.js","@polymer/iron-icon/iron-icon.js","@polymer/paper-menu-button/paper-menu-button.js","@polymer/paper-dropdown-menu/paper-dropdown-menu.js","@lrnwebcomponents/hax-body-behaviors/lib/HAXWiring.js","@lrnwebcomponents/lrnsys-layout/lrnsys-layout.js","@lrnwebcomponents/lrnsys-layout/lib/lrnsys-dialog.js","@lrnwebcomponents/lrnsys-layout/lib/lrnsys-collapselist.js","@lrnwebcomponents/lrnsys-layout/lib/lrnsys-collapselist-item.js","@lrnwebcomponents/es-global-bridge/es-global-bridge.js","@polymer/polymer/polymer-legacy.js","@polymer/paper-button/paper-button.js","@polymer/iron-icons/iron-icons.js","@lrnwebcomponents/materializecss-styles/lib/colors.js","@polymer/paper-card/paper-card.js","@lrnwebcomponents/lrnsys-layout/lib/lrnsys-drawer.js","@polymer/iron-ajax/iron-ajax.js"],f):f(b.LrnCalendar={},b.polymer_dom_js,b.resolveUrl_js,null,null,null,null,null,null,null,null,null,b.polymerLegacy_js)}(this,function(b,f,j,k,q,v,w,x,z,A,B,C,E){"use strict";function F(K){return(F="function"==typeof Symbol&&"symbol"==babelHelpers.typeof(Symbol.iterator)?function(L){return"undefined"===typeof L?"undefined":babelHelpers.typeof(L)}:function(L){return L&&"function"==typeof Symbol&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":"undefined"===typeof L?"undefined":babelHelpers.typeof(L)})(K)}function G(K,L){return L||(L=K.slice(0)),Object.freeze(Object.defineProperties(K,{raw:{value:Object.freeze(L)}}))}function H(){var K=G(["\n    <style include=\"materializecss-styles-colors\">\n      :host {\n        display: block;\n      }\n      ::-webkit-scrollbar {\n        width: 0px; /* remove scrollbar space */\n        background: transparent; /* optional: just make scrollbar invisible */\n      }\n\n      .month {\n        width: 100%;\n        height: 20vh;\n        vertical-align: top;\n        overflow: scroll;\n      }\n      .week {\n        width: 100%;\n        height: 40vh;\n        vertical-align: top;\n        overflow: scroll;\n      }\n      .card-content {\n        position: relative;\n        bottom: 10px;\n        white-space: nowrap;\n        font-size: 12px;\n        padding: 0px 5px;\n        line-height: 7px;\n      }\n      .label {\n        width: 100%;\n      }\n    </style>\n\n    <div id=\"test\">\n      <div>\n        <template is=\"dom-if\" if=\"[[firstWeek]]\">\n          <paper-card class=\"label\"> <h3>[[getWeek(date)]]</h3> </paper-card>\n        </template>\n      </div>\n      <paper-card class$=\"[[view]]\" id=\"dateHeader\">\n        <h5>[[getMonth(date)]]</h5>\n        <template is=\"dom-repeat\" items=\"{{events}}\">\n          <div class=\"card-content\">\n            <lrnsys-drawer\n              text=\"[[timeString(item.event.startDate._time.hour, item.event.startDate._time.minute, item.event.endDate._time.hour,item.event.endDate._time.minute)]] {{item.event.summary}}\"\n              header=\"[[getDateString(date)]]\"\n              align=\"left\"\n              heading-class=\"orange lighten-3 blue-text text-darken-4\"\n              style$=\"[[computeStyle(item)]];overflow:auto;\"\n            >\n              [[displayActivity(item)]]\n              <br /><br />[[displayStart(item)]]<br /><br />[[displayEnd(item)]]<br /><br />[[displayDuration(item)]]<br /><br />[[displayDescription(item)]]<br /><br />[[displayLocation(item)]]\n            </lrnsys-drawer>\n          </div>\n        </template>\n      </paper-card>\n    </div>\n  "]);return H=function(){return K},K}function I(){var K=G(["\n    <style>\n      :host {\n        display: block;\n      }\n      lrn-calendar-date {\n        display: inline-table;\n        top: 0px;\n      }\n      paper-card {\n        width: 14%;\n        height: 20px;\n        display: inline-table;\n        padding: 0;\n        margin: 0;\n      }\n      .calendar {\n        color: var(--my-toolbar-title-color);\n      }\n      .header {\n        padding-bottom: 15px;\n      }\n    </style>\n\n    <div class=\"calendar\">\n      <div class=\"header\">\n        <div style=\"float: left\">\n          <paper-button raised type=\"button\" on-tap=\"monthView\"\n            >Month</paper-button\n          >\n          <paper-button raised type=\"button\" on-tap=\"weekView\"\n            >Week</paper-button\n          >\n        </div>\n        <div style=\"float: right\">\n          <paper-button raised type=\"button\" on-tap=\"showDate\"\n            >Today</paper-button\n          >\n          <paper-button on-tap=\"showPrev\"\n            ><iron-icon icon=\"arrow-back\"></iron-icon\n          ></paper-button>\n          <paper-button on-tap=\"showNext\"\n            ><iron-icon icon=\"arrow-forward\"></iron-icon\n          ></paper-button>\n        </div>\n        <div style=\"margin: 0 auto; width: 200px; text-align: center\">\n          <h2>[[getDisplayDate(date)]]</h2>\n        </div>\n      </div>\n\n      <div class=\"calendarView\" id=\"calView\"></div>\n    </div>\n  "]);return I=function(){return K},K}E.Polymer({_template:E.html(H()),is:"lrn-calendar-date",properties:{title:{type:String,value:"lrn-calendar-date"},name:{type:String},date:{type:Date},loadeddate:{type:Boolean},firstWeek:{type:Boolean},view:{type:String},valid:{type:Boolean,value:!1}},getMonth:function(L){var M=L.getMonth(),N=L.getDate();return monthstring=1==N?["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][M]+" "+N:N,monthstring},getWeek:function(L){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][L.getDay()]},timeString:function(L,M,N,O){var P=11<L?"pm":"am";if(12<L)L-=12;else if(0==L){if(0==M&&0==N&&0==O)return"";L="12"}return 10>M&&(M="0"+M),0==M?L+P:L+":"+M+P},computeStyle:function(L){if(0==L.event.startDate._time.hour)var M="background-color: yellow";else M="background-color: clear";return M},getDateString:function(L){var M=L.getMonth();return L.getDate(),monthstring=["January","February","March","April","May","June","July","August","September","October","November","December"][M]+" "+L.getDate()+" "+L.getFullYear(),monthstring},displayActivity:function(L){return"Activity: "+L.event.summary},displayStart:function(L){var M=this.timeString(L.event.startDate._time.hour,L.event.startDate._time.minute);return this.timeString(L.event.endDate._time.hour,L.event.endDate._time.minute),"Start Time: "+M},displayEnd:function(L){return"End Time: "+this.timeString(L.event.endDate._time.hour,L.event.endDate._time.minute)},displayDuration:function(L){var M=L.event.duration,N=M.days,O=M.hours,P=M.minutes;return M.weeks,0==O&&0==P&&1==N?"Duration: All Day":0==N?0==O?0==P?"Duration: ":"Duration: "+P+"min":0==P?"Duration: "+O+"H ":"Duration: "+O+"H "+P+"min ":0==O&&0==P?"Duration: "+N+"Days ":0<O&&0==P?"Duration: "+N+"Days "+O+"H ":"Duration: "+N+"Days "+O+"H "+P+"min "},displayDescription:function(L){return L.event.description,"Description: "},displayLocation:function(L){var M=L.event.location;return null==(M=M+"")||"null"==M?"Location: ":"Location: "+M}});var J=E.Polymer({_template:E.html(I()),is:"lrn-calendar",behaviors:[HAXBehaviors.PropertiesBehaviors],properties:{listOfEvents:{type:Array,value:[]},dateString:{type:String,observer:"_dateStringChanged"},date:{type:Date,value:new Date,observer:"_dateChanged"},view:{type:String,value:"month",observer:"_viewTypeChanged"},file:{type:String,reflectToAttribute:!0,observer:"_fileChanged"}},_fileChanged:function(L){"undefined"!==F(L)&&this.__icalLoaded&&(this.loadFile(),this.getDateInfo(),this.createCalendar())},_viewTypeChanged:function(L){"undefined"!==F(L)&&"undefined"!==F(this.file)&&this.__icalLoaded&&(this.getDateInfo(),this.createCalendar())},_dateChanged:function(L){"undefined"!==F(L)&&"undefined"!==F(this.file)&&this.__icalLoaded&&(this.getDateInfo(),this.createCalendar())},_dateStringChanged:function(L){"undefined"!==F(L)&&""!=L&&this.__icalLoaded&&(this.date=new Date(L))},created:function(){var L=j.pathFromUrl("undefined"==typeof document?new("undefined"==typeof URL?require("url").URL:URL)("file:"+__filename).href:document.currentScript&&document.currentScript.src||document.baseURI),M="".concat(L,"lib/ical.js/build/ical.js");window.addEventListener("es-bridge-".concat("ical","-loaded"),this._icalLoaded.bind(this)),window.ESGlobalBridge.requestAvailability(),window.ESGlobalBridge.instance.load("ical",M)},_icalLoaded:function(){this.__icalLoaded=!0,"undefined"!==F(this.file)&&this.loadFile()},attached:function(){this.setHaxProperties({canScale:!1,canPosition:!1,canEditSource:!1,gizmo:{title:"Calendar",description:"Present dates.",icon:"icons:today",color:"grey",groups:["Date"],handles:[{type:"ical",source:"file",date:"date"}],meta:{author:"LRNWebComponents"}},settings:{quick:[{property:"file",title:"iCal feed",description:"Calendar feed to display",inputMethod:"textfield",icon:"link",required:!0}],configure:[{property:"file",title:"iCal feed",description:"Calendar feed to display",inputMethod:"textfield",icon:"link",required:!0,validationType:"url"},{property:"view",title:"View calendar in week or month format",description:"week or month view",inputMethod:"select",options:{week:"Week",month:"Month"}},{property:"dateString",title:"Date: yyyy/mm/dd",description:"Date to display calendar",inputMethod:"datepicker"}],advanced:[]}})},loadFile:function(){this.startIndex=0,this.calendarText=this.readTextFile(this.file),this.listOfEvents=this.getEvents(this.date,this.calendarText),this.listOfEvents=this.sortByTime(this.listOfEvents)},showPrev:function(){if(this.startIndex=0,"month"==this.view)L=2==this.date.getMonth()&&28<this.date.getDate()?new Date(this.date.getFullYear(),this.date.getMonth()-1,28):new Date(this.date.getFullYear(),this.date.getMonth()-1,this.date.getDate()),this.date=L;else{var L=new Date(this.date.getFullYear(),this.date.getMonth(),this.date.getDate()-7);this.date=L}this.startMonth=this.date.getMonth()+1,this.getDateInfo(),this.createCalendar()},showNext:function(){if("month"==this.view)L=11==this.date.getMonth()?new Date(this.date.getFullYear()+1,0,this.date.getDate()):0==this.date.getMonth()&&28<this.date.getDate()?new Date(this.date.getFullYear(),this.date.getMonth()+1,28):new Date(this.date.getFullYear(),this.date.getMonth()+1,this.date.getDate()),this.date=L;else{var L=new Date(this.date.getFullYear(),this.date.getMonth(),this.date.getDate()+7);this.date=L}this.getDateInfo(),this.createCalendar()},showDate:function(){this.startIndex=0,this.date=new Date,this.getDateInfo(),this.createCalendar()},monthView:function(){this.view="month",this.startIndex=0,this.createCalendar()},weekView:function(){this.view="week",this.startIndex=0,this.createCalendar()},readTextFile:function(L){this.fileNotFound=!1;var M=new XMLHttpRequest,N="";return M.open("GET",L,!1),M.onreadystatechange=function(){4===M.readyState&&(N=200===M.status||0==M.status?M.responseText:"Not Found")},M.send(null),this.calendarText=N,N},createCalendar:function(){"month"!=this.view&&"week"!=this.view&&(this.view="month"),this.date.getFullYear()||(this.date=new Date),this.getDateInfo(),this.totalDays=7*this.numweeks,this.calendarText=this.readTextFile(this.file),this.calendarView=this.$.calView;for(var L=1,M=f.dom(this.$.calView).node,N=M.childNodes;N[1];)M.removeChild(M.childNodes[1]);var O=this.currentDayofWeek;if("week"==this.view){for(var P=0;6>this.currentDayofWeek+P;)P+=1;this.totalDays=P}if("month"==this.view&&(1==this.currentMonth||3==this.currentMonth||5==this.currentMonth||7==this.currentMonth||8==this.currentMonth||10==this.currentMonth||12==this.currentMonth?(this.totalDays=31,this.totalDays=this.totalDays-this.startDay+1):4==this.currentMonth||6==this.currentMonth||9==this.currentMonth||11==this.currentMonth?(this.totalDays=30,this.totalDays=this.totalDays-this.startDay+1):(this.totalDays=29,this.totalDays-=this.startDay)),this.newDate=new Date(this.currentYear+"/"+this.currentMonth+"/"+this.currentDate),"month"==this.view){for(;1!=this.currentDate;)L-=1,1==this.currentMonth&&1==this.currentDate?(--this.currentYear,this.currentMonth=12,this.currentDate=31,this.newDate=new Date(this.currentYear+"/"+this.currentMonth+"/"+this.currentDate)):(--this.currentDate,this.newDate=new Date(this.currentYear+"/"+this.currentMonth+"/"+this.currentDate),this.newDate.getDate()!=this.currentDate&&(0!=this.currentDate||2!=this.currentMonth&&4!=this.currentMonth&&6!=this.currentMonth&&8!=this.currentMonth&&9!=this.currentMonth&&11!=this.currentMonth&&1!=this.currentMonth||(this.newDate=new Date(this.currentYear+"/"+(this.currentMonth-1)+"/31"),this.currentDate=31),0!=this.currentDate||5!=this.currentMonth&&7!=this.currentMonth&&10!=this.currentMonth&&12!=this.currentMonth||(this.newDate=new Date(this.currentYear+"/"+(this.currentMonth-1)+"/30"),this.currentDate=30),0==this.currentDate&&3==this.currentMonth&&(this.newDate=new Date(this.currentYear+"/2/29"),this.currentDate=29,2==this.newDate.getMonth()&&(this.newDate=new Date(this.currentYear+"/2/28"),this.currentDate=28)),--this.currentMonth)),0!=this.currentDayofWeek&&0!=O||(this.currentDayofWeek=7,O=-1),--this.currentDayofWeek;7==this.currentDayofWeek&&(this.currentDayofWeek=0)}for(;0!=this.currentDayofWeek;)L-=1,1==this.currentMonth&&1==this.currentDate?(--this.currentYear,this.currentMonth=12,this.currentDate=31,this.newDate=new Date(this.currentYear+"/"+this.currentMonth+"/"+this.currentDate)):(--this.currentDate,this.newDate=new Date(this.currentYear+"/"+this.currentMonth+"/"+this.currentDate),this.newDate.getDate()!=this.currentDate&&(0!=this.currentDate||2!=this.currentMonth&&4!=this.currentMonth&&6!=this.currentMonth&&8!=this.currentMonth&&9!=this.currentMonth&&11!=this.currentMonth&&1!=this.currentMonth||(this.newDate=new Date(this.currentYear+"/"+(this.currentMonth-1)+"/31"),this.currentDate=31),0!=this.currentDate||5!=this.currentMonth&&7!=this.currentMonth&&10!=this.currentMonth&&12!=this.currentMonth||(this.newDate=new Date(this.currentYear+"/"+(this.currentMonth-1)+"/30"),this.currentDate=30),0==this.currentDate&&3==this.currentMonth&&(this.newDate=new Date(this.currentYear+"/2/29"),this.currentDate=29,2==this.newDate.getMonth()&&(this.newDate=new Date(this.currentYear+"/2/28"),this.currentDate=28)),--this.currentMonth)),--this.currentDayofWeek;(T=document.createElement("lrn-calendar-date")).date=this.newDate,T.firstWeek=!0,T.style.width="14.25%",T.style.display="inline-block",T.setAttribute("id","date"),T.view=this.view,this.date.getFullYear()===this.newDate.getFullYear()&&this.date.getMonth()===this.newDate.getMonth()&&this.date.getDate()===this.newDate.getDate()&&(T.loadeddate=!0);var Q=this.eventCheck(this.listOfEvents,this.newDate),R=this.createReturn(Q);T.events=R,T.valid=!0,f.dom(this.calendarView).appendChild(T);for(var S=1;L<this.totalDays;){var T;12==this.currentMonth&&31==this.currentDate?(++this.currentYear,this.currentMonth=1,this.currentDate=1,this.newDay=new Date(this.currentYear+"/"+this.currentMonth+"/"+this.currentDate)):(++this.currentDate,this.newDay=new Date(this.currentYear+"/"+this.currentMonth+"/"+this.currentDate),this.newDay.getDate()!=this.currentDate&&(1!=this.currentMonth&&3!=this.currentMonth&&5!=this.currentMonth&&7!=this.currentMonth&&8!=this.currentMonth&&10!=this.currentMonth&&12!=this.currentMonth||(this.newDay=new Date(this.currentYear+"/"+(this.currentMonth+1)+"/1")),this.currentDate=1,++this.currentMonth)),(T=document.createElement("lrn-calendar-date")).valid=!0,T.setAttribute("id","date"),T.date=this.newDay,T.style.width="14.25%",T.style.display="inline-block",T.view=this.view,this.date.getFullYear()===this.newDay.getFullYear()&&this.date.getMonth()===this.newDay.getMonth()&&this.date.getDate()===this.newDay.getDate()&&(T.loadeddate=!0);var U=this.eventCheck(this.listOfEvents,this.newDay),V=this.createReturn(U);T.events=V,7>S&&(T.firstWeek=!0),S+=1,T.valid=!0,f.dom(this.calendarView).appendChild(T),(L+=1)==this.totalDays&&6!=this.newDay.getDay()&&(L-=1)}},getEvents:function(L,M){if("Not Found"==M)return"";var O=ICAL.parse(M),P=new ICAL.Component(O),Q=(P.getFirstSubcomponent("vevent"),P.getAllSubcomponents("vevent").map(function(S){return event=new ICAL.Event(S),event}));this.eventArray=[];for(var R=0;R<Q.length;R++)this.createDate(Q[R]),Q[R].isRecurring()&&this.createRecurrence(Q[R]),this.eventArray.push(Q[R]);return this.eventArray},createRecurrence:function(L){L.getRecurrenceTypes().WEEKLY?this.createRepeatedEvent(L,156):L.getRecurrenceTypes().DAILY?this.createRepeatedEvent(L,720):L.getRecurrenceTypes().MONTHLY?this.createRepeatedEvent(L,36):L.getRecurrenceTypes().YEARLY&&this.createRepeatedEvent(L,10)},createRepeatedEvent:function(L,M){for(var N,Q,O=L.iterator(L.startDate),P=0;(N=O.next())&&P++<M;){Q=new ICAL.Event,Q.summary=L.summary,Q.description=L.description,Q.startDate=L.getOccurrenceDetails(N).startDate,Q.endDate=L.getOccurrenceDetails(N).endDate;var R=L.location+"";Q.location=R,Q.startDate._time.day==L.startDate._time.day&&Q.startDate._time.month==L.startDate._time.month&&Q.startDate._time.year==L.startDate._time.year||this.eventArray.push(Q)}},createDate:function(L){var M=L.startDate._time.year,N=L.startDate._time.month,O=L.startDate._time.day;return new Date(M+"/"+N+"/"+O)},eventCheck:function(L,M){for(var Q,N=[],O=L.length,P=this.startIndex;P<O;P++)Q=this.createDate(L[P]),Q.getTime()>M.getTime()&&(O=P,0!=P&&(this.startIndex=P-1)),Q.getTime()==M.getTime()&&N.push(L[P]);return N},sortByTime:function(L){var M;do{M=!1;for(var N=0;N<L.length-1;N++)if(L[N].startDate>L[N+1].startDate){var O=L[N];L[N]=L[N+1],L[N+1]=O,M=!0}}while(M);return L},getDateInfo:function(){this.startMonth=this.date.getMonth()+1,this.startYear=this.date.getFullYear(),this.startDay=this.date.getDate(),this.startDayOfWeek=this.date.getDay(),this.currentDate=this.startDay,this.currentMonth=this.startMonth,this.currentYear=this.startYear,this.currentDayofWeek=this.startDayOfWeek},createReturn:function(L){for(var M=[],N=0;N<L.length;N++)M.push({event:L[N]});return M},getDisplayDate:function(L){if("function"==typeof L.getMonth){var M=L.getMonth();return L.getDate(),["January","February","March","April","May","June","July","August","September","October","November","December"][M]+" "+L.getFullYear()}return""}});b.LrnCalendar=J,Object.defineProperty(b,"__esModule",{value:!0})});