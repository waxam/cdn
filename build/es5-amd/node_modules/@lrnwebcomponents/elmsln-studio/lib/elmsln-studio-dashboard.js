define(["exports", "../../../lit-element/lit-element.js", "../../../@polymer/iron-ajax/iron-ajax.js", "../../accent-card/accent-card.js", "../../nav-card/nav-card.js", "../../progress-donut/progress-donut.js", "../../lrndesign-avatar/lrndesign-avatar.js"], function (_exports, _litElement, _ironAjax, _accentCard, _navCard, _progressDonut, _lrndesignAvatar) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.ElmslnStudioDashboard = void 0;

  function _templateObject7_319ab030bff711ea911389a091fca225() {
    var data = babelHelpers.taggedTemplateLiteral(["\n        :host {\n          font-family: var(--elmsln-studio-FontFamily, \"Roboto\", sans-serif);\n          font-size: 13px;\n        }\n        .sr-only {\n          position: absolute;\n          left: -9999999px;\n          width: 0;\n          overflow: hidden;\n        }\n        h1,\n        h2,\n        h3,\n        .card [slot=\"heading\"] {\n          font-size: 14px;\n          font-weight: normal;\n          margin: 0;\n          color: var(--simple-colors-default-theme-grey-7, #666);\n        }\n        h2,\n        #secondary [slot=\"heading\"] {\n          font-size: 18px;\n        }\n        .card {\n          margin: calc(0.5 * var(--elmsln-studio-margin, 20px))\n            var(--elmsln-studio-margin, 20px)\n            calc(2 * var(--elmsln-studio-margin, 20px));\n          flex: 1 0 calc(50% - 2 * var(--elmsln-studio-margin, 20px));\n          --accent-card-footer-border-color: transparent;\n        }\n        .card [slot=\"subheading\"] {\n          text-decoration: underline;\n          border: none;\n          font-family: inherit;\n          font-size: inherit;\n          font-weight: normal;\n        }\n        .card [slot=\"subheading\"]:focus,\n        .card [slot=\"subheading\"]:hover {\n          text-decoration: none;\n        }\n        .card th,\n        .card td {\n          padding: 5px 0;\n          text-align: left;\n          min-height: 25px;\n          border-bottom: 1px solid\n            var(--simple-colors-default-theme-grey-4, #666);\n        }\n        #primary .card [slot=\"heading\"],\n        #primary .card [slot=\"subheading\"] {\n          text-align: center;\n          display: block;\n          margin: 0 auto;\n        }\n        #secondary {\n          margin-top: 0;\n          --accent-card-heading-padding-top: 0;\n          --nav-card-linklist-margin-top: 0;\n          --nav-card-linklist-left-size: 36px;\n          --paper-avatar-width: var(--nav-card-linklist-left-size, 36px);\n        }\n        accent-card {\n          --accent-card-heading-padding-top: 0;\n        }\n        progress-donut {\n          max-width: 100px;\n          margin: 0 auto;\n        }\n        accent-card table {\n          width: 100%;\n          border-collapse: collapse;\n        }\n        accent-card button,\n        .linklist button {\n          border: none;\n          padding: 0;\n          text-align: left;\n          font-size: inherit;\n          font-weight: inherit;\n        }\n        .linklist-footer {\n          text-align: center;\n          display: block;\n          padding: 5px 10px;\n          margin: 0 auto;\n          border-radius: 3px;\n          background-color: var(--simple-colors-default-theme-grey-2, #eee);\n          color: var(--simple-colors-default-theme-grey11, #222);\n        }\n        .linklist-footer:focus,\n        .linklist-footer:hover {\n          background-color: var(--simple-colors-default-theme-grey-3, #ddd);\n          color: var(--simple-colors-default-theme-grey12, #000);\n        }\n        @media screen and (min-width: 600px) {\n          progress-donut {\n            max-width: 150px;\n          }\n          :host {\n            display: flex;\n            align-items: stretch;\n            justify-content: space-between;\n          }\n          #primary {\n            flex: 0 0 calc(50%);\n          }\n          #secondary {\n            flex: 0 0 calc(50%);\n          }\n          h1,\n          h2 {\n            flex: 0 0 calc(100% - var(--elmsln-studio-margin, 20px));\n            padding: 0 var(--elmsln-studio-margin, 20px);\n          }\n        }\n        @media screen and (min-width: 900px) {\n          progress-donut {\n            max-width: 200px;\n          }\n          #primary {\n            flex: 0 0 calc(66.66666667%);\n          }\n          #secondary {\n            flex: 0 0 calc(33.33333333%);\n          }\n          #primary > div {\n            display: flex;\n            align-items: stretch;\n            justify-content: space-between;\n            flex-wrap: wrap;\n          }\n        }\n      "]);

    _templateObject7_319ab030bff711ea911389a091fca225 = function _templateObject7_319ab030bff711ea911389a091fca225() {
      return data;
    };

    return data;
  }

  function _templateObject6_319ab030bff711ea911389a091fca225() {
    var data = babelHelpers.taggedTemplateLiteral(["\n              <nav-card-item\n                icon=\"chevron-right\"\n                avatar=\"", "\"\n                initials=\"", "\"\n              >\n                <button\n                  id=\"activity-", "\"\n                  aria-describedby=\"activity-desc-", "\"\n                  slot=\"label\"\n                >\n                  ", "\n                  ", "\n                  ", "\n                </button>\n                <span id=\"activity-desc-", "\" slot=\"description\">\n                  ", "\n                </span>\n              </nav-card-item>\n            "]);

    _templateObject6_319ab030bff711ea911389a091fca225 = function _templateObject6_319ab030bff711ea911389a091fca225() {
      return data;
    };

    return data;
  }

  function _templateObject5_319ab030bff711ea911389a091fca225() {
    var data = babelHelpers.taggedTemplateLiteral(["\n                  <nav-card-item icon=\"chevron-right\">\n                    <button\n                      id=\"comment-", "\"\n                      aria-describedby=\"comment-desc-", "\"\n                      slot=\"label\"\n                    >\n                      ", "\n                    </button>\n                    <span id=\"comment-", "\" slot=\"description\"\n                      >", "</span\n                    >\n                  </nav-card-item>\n                "]);

    _templateObject5_319ab030bff711ea911389a091fca225 = function _templateObject5_319ab030bff711ea911389a091fca225() {
      return data;
    };

    return data;
  }

  function _templateObject4_319ab030bff711ea911389a091fca225() {
    var data = babelHelpers.taggedTemplateLiteral(["\n                  <nav-card-item icon=\"chevron-right\">\n                    <button\n                      id=\"submission-", "\"\n                      aria-describedby=\"submission-desc-", "\"\n                      slot=\"label\"\n                    >\n                      ", "\n                    </button>\n                    <span id=\"submission-desc-", "\" slot=\"description\"\n                      >", "</span\n                    >\n                  </nav-card-item>\n                "]);

    _templateObject4_319ab030bff711ea911389a091fca225 = function _templateObject4_319ab030bff711ea911389a091fca225() {
      return data;
    };

    return data;
  }

  function _templateObject3_319ab030bff711ea911389a091fca225() {
    var data = babelHelpers.taggedTemplateLiteral(["\n                            Due\n                            ", "\n                          "]);

    _templateObject3_319ab030bff711ea911389a091fca225 = function _templateObject3_319ab030bff711ea911389a091fca225() {
      return data;
    };

    return data;
  }

  function _templateObject2_319ab030bff711ea911389a091fca225() {
    var data = babelHelpers.taggedTemplateLiteral(["\n                  <nav-card-item icon=\"chevron-right\">\n                    <button\n                      id=\"due-", "\"\n                      aria-describedby=\"due-desc-", "\"\n                      slot=\"label\"\n                    >\n                      ", "\n                    </button>\n                    <span id=\"due-desc-", "\" slot=\"description\">\n                      ", "\n                    </span>\n                  </nav-card-item>\n                "]);

    _templateObject2_319ab030bff711ea911389a091fca225 = function _templateObject2_319ab030bff711ea911389a091fca225() {
      return data;
    };

    return data;
  }

  function _templateObject_319ab030bff711ea911389a091fca225() {
    var data = babelHelpers.taggedTemplateLiteral(["\n      <iron-ajax\n        auto\n        url=\"", "\"\n        @response=\"", "\"\n      ></iron-ajax>\n      <iron-ajax\n        auto\n        url=\"", "\"\n        @response=\"", "\"\n      ></iron-ajax>\n      <iron-ajax\n        auto\n        url=\"", "\"\n        @response=\"", "\"\n      ></iron-ajax>\n      <iron-ajax\n        auto\n        url=\"", "\"\n        @response=\"", "\"\n      ></iron-ajax>\n      <iron-ajax\n        auto\n        url=\"", "\"\n        @response=\"", "\"\n      ></iron-ajax>\n      <h1 class=\"sr-only\">Overview</h1>\n      <div id=\"primary\">\n        <div id=\"profile\">\n          <h2>", "</h2>\n          <accent-card accent-color=\"purple\" class=\"card\">\n            <span slot=\"heading\" class=\"sr-only\">My Progress</span>\n            <progress-donut\n              accent-color=\"purple\"\n              slot=\"content\"\n              animation=\"500\"\n              animation-delay=\"500\"\n              complete=\"[5,3,2,6]\"\n              donut-width=\"25%\"\n              chart-padding=\"0\"\n              image-src=\"", "\"\n              image-alt=\"Profile picture for ", "\"\n              start-angle=\"0\"\n              total=\"30\"\n            ></progress-donut>\n            <table slot=\"content\">\n              <tbody>\n                <tr>\n                  <th scope=\"row\">Course Progress</th>\n                  <td>\n                    ", "%\n                  </td>\n                </tr>\n                <tr>\n                  <th scope=\"row\">Comments</th>\n                  <td>", "</td>\n                </tr>\n                <tr>\n                  <th scope=\"row\">Submissions</th>\n                  <td>\n                    ", "\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </accent-card>\n          <nav-card accent-color=\"green\" class=\"card\">\n            <span slot=\"heading\">Work Due</span>\n            <div slot=\"linklist\">\n              ", "\n            </div>\n          </nav-card>\n        </div>\n        <div id=\"work\">\n          <h2>Recent Work</h2>\n          <nav-card accent-color=\"amber\" class=\"card\" link-icon=\"chevron-right\">\n            <span slot=\"heading\">Submissions</span>\n            <button slot=\"subheading\">All submissions</button>\n            <div slot=\"linklist\">\n              ", "\n            </div>\n          </nav-card>\n          <nav-card accent-color=\"cyan\" class=\"card\" link-icon=\"chevron-right\">\n            <span slot=\"heading\">Comments</span>\n            <button slot=\"subheading\">All comments</button>\n            <!-- TODO need a comments list where student is in the thread or thread is about student submission -->\n            <div slot=\"linklist\">\n              ", "\n            </div>\n          </nav-card>\n        </div>\n      </div>\n      <nav-card\n        id=\"secondary\"\n        flat\n        no-border\n        class=\"card\"\n        link-icon=\"chevron-right\"\n      >\n        <span slot=\"heading\">Recent Activity</span>\n        <div slot=\"linklist\">\n          ", "\n        </div>\n        <button class=\"linklist-footer\" slot=\"footer\">Load More</button>\n      </nav-card>\n    "]);

    _templateObject_319ab030bff711ea911389a091fca225 = function _templateObject_319ab030bff711ea911389a091fca225() {
      return data;
    };

    return data;
  }

  /**
   * `elmsln-studio-dashboard`
   * Studio App for ELMS:LN
   *
   * @customElement elmsln-studio-dashboard
   * @lit-html
   * @lit-element
   * @demo demo/dashboard.html
   */
  var ElmslnStudioDashboard =
  /*#__PURE__*/
  function (_LitElement) {
    babelHelpers.inherits(ElmslnStudioDashboard, _LitElement);
    babelHelpers.createClass(ElmslnStudioDashboard, [{
      key: "render",
      // render function
      value: function render() {
        var _this2 = this;

        return (0, _litElement.html)(_templateObject_319ab030bff711ea911389a091fca225(), this.activitySrc, function (e) {
          return _this2._handleArrayData(e, "__activity");
        }, this.assignmentsSrc, function (e) {
          return _this2._handleArrayData(e, "__assignments");
        }, this.commentsSrc, function (e) {
          return _this2._handleArrayData(e, "__comments");
        }, this.profileSrc, function (e) {
          return _this2._handleObjectData(e, "__profile");
        }, this.submissionsSrc, function (e) {
          return _this2._handleObjectData(e, "__submissions");
        }, this.__profile.student.data.display_name, this.__profile.student.data.sis.avatar_url, this.__profile.student.data.display_name, Math.round(this.__profile.student.progress.submissions.reduce(function (sum, val) {
          return sum + val;
        }) * 100 / this.__profile.student.progress.totalAssignments), this.__profile.student.progress.comments, this.__profile.student.progress.submissions.reduce(function (sum, val) {
          return sum + val;
        }), this.__assignments.map(function (assign, i) {
          return (0, _litElement.html)(_templateObject2_319ab030bff711ea911389a091fca225(), i, i, assign.attributes.title, i, _this2._getDueDate(assign) ? (0, _litElement.html)(_templateObject3_319ab030bff711ea911389a091fca225(), _this2.date(parseInt(_this2._getDueDate(assign)) * 1000)) : "");
        }), Object.keys(this.__submissions).map(function (submission, i) {
          return (0, _litElement.html)(_templateObject4_319ab030bff711ea911389a091fca225(), i, i, _this2.__submissions[submission].attributes.title, i, _this2.date(_this2.__submissions[submission].meta.changed));
        }), this.__comments.map(function (comment, i) {
          return (0, _litElement.html)(_templateObject5_319ab030bff711ea911389a091fca225(), i, i, comment.attributes.subject, i, _this2.date(comment.attributes.changed));
        }), this.__activity.map(function (activity, i) {
          return (0, _litElement.html)(_templateObject6_319ab030bff711ea911389a091fca225(), activity.relationships.author.data.avatar || "", activity.relationships.author.data.display_name || "", i, i, activity.relationships.author.data.sis.sortable_name.replace(/.*,/, ""), activity.type === "comment" ? "commented" : "submitted", activity.type === "comment" ? activity.attributes.subject : activity.attributes.title, i, _this2.date(activity.type === "comment" ? activity.attributes.changed : activity.meta.changed));
        }));
      } // properties available to the custom element for data binding

    }], [{
      key: "styles",
      get: function get() {
        return [(0, _litElement.css)(_templateObject7_319ab030bff711ea911389a091fca225())];
      }
    }, {
      key: "properties",
      get: function get() {
        return {
          /*
           * source JSON for all activity
           * (submissions and comments by anyone)
           */
          activitySrc: {
            type: String,
            attribute: "activity-src"
          },

          /*
           * source JSON for upcoming assignments
           * that student hasn't submitted yet
           */
          assignmentsSrc: {
            type: String,
            attribute: "assignments-src"
          },

          /*
           * source JSON for most recent comments in response to
           * student's comment or submission
           */
          commentsSrc: {
            type: String,
            attribute: "comments-src"
          },

          /*
           * source JSON for student's profile data (name & course progress)
           */
          profileSrc: {
            type: String,
            attribute: "profile-src"
          },

          /*
           * source JSON for student's most recent submissions
           */
          submissionsSrc: {
            type: String,
            attribute: "submissions-src"
          },

          /*
           * recent activity
           * (submissions and comments from everyone)
           */
          __activity: {
            type: Array
          },

          /*
           * upcoming assignments
           */
          __assignments: {
            type: Array
          },

          /*
           * most recent comments in response to
           * student's comment or submission
           */
          __comments: {
            type: Array
          },

          /*
           * student's profile data
           * (name & course progress)
           */
          __profileSrc: {
            type: Object
          },

          /*
           * student's submissions
           */
          __submissions: {
            type: Object
          }
        };
      }
      /**
       * Store the tag name to make it easier to obtain directly.
       * @notice function name must be here for tooling to operate correctly
       */

    }, {
      key: "tag",
      get: function get() {
        return "elmsln-studio-dashboard";
      } // life cycle

    }]);

    function ElmslnStudioDashboard() {
      var _this;

      babelHelpers.classCallCheck(this, ElmslnStudioDashboard);
      _this = babelHelpers.possibleConstructorReturn(this, babelHelpers.getPrototypeOf(ElmslnStudioDashboard).call(this));
      _this.__activity = [];
      _this.__assignments = [];
      _this.__comments = [];
      _this.__profile = {
        student: {
          data: {
            type: "user",
            id: "371",
            name: "toc5234",
            display_name: "Tom Cat",
            avatar: "http://placekitten.com/300/150",
            sis: {
              id: 6966348,
              name: "Tom Cat",
              created_at: "2019-07-24T16:16:51-04:00",
              sortable_name: "Cat, Tom",
              short_name: "Tom Cat",
              sis_user_id: "toc5234@psu.edu",
              integration_id: null,
              avatar_url: "http://placekitten.com/300/150"
            }
          },
          progress: {
            comments: 22,
            submissions: [5, 3, 2, 6],
            totalAssignments: 30
          }
        }
      };
      _this.__submissions = [];
      _this.tag = ElmslnStudioDashboard.tag;
      return _this;
    }

    babelHelpers.createClass(ElmslnStudioDashboard, [{
      key: "_getDueDates",
      value: function _getDueDates(item) {
        return item.meta.rationale && item.meta.rationale.data ? item.meta.rationale.data : undefined;
      }
    }, {
      key: "_getDueDate",
      value: function _getDueDate(item) {
        //console.log('_getDueDate',item,this._getDueDates(item));
        return this._getDueDates(item) ? this._getDueDates(item)[1] || this._getDueDates(item)[0] : undefined;
      }
    }, {
      key: "_handleArrayData",
      value: function _handleArrayData(e, propName) {
        this[propName] = e && e.detail && e.detail.response && e.detail.response.data ? e.detail.response.data : []; //console.log("_handleArrayData", e, propName, this[propName]);
      }
    }, {
      key: "_handleObjectData",
      value: function _handleObjectData(e, propName) {
        this[propName] = e && e.detail && e.detail.response && e.detail.response.data ? e.detail.response.data : {}; //console.log('_handleObjectData',e,propName,this[propName]);
      }
    }, {
      key: "date",
      value: function date(time) {
        var date,
            options = {
          //weekday: 'long',
          year: "numeric",
          month: "long",
          day: "numeric"
        };

        if (time && isNaN(time)) {
          var parts = time.split(/\D+/);
          date = babelHelpers.construct(Date, babelHelpers.toConsumableArray(parts));
          /*console.log('date',parts,
          '\ndate',date,
          '\ntoString',date.toString(),
          '\ntoLocaleString',date.toLocaleString(),
          '\ntoLocaleDateString',date.toLocaleDateString(undefined,options),
          '\ntoUTCString',date.toUTCString(),
          '\ntoTimeString',date.toTimeString(),
          '\ntoLocaleTimeString',date.toLocaleTimeString()
          );*/
        } else if (time) {
          date = new Date(parseInt(time));
        }

        return date.toLocaleDateString(undefined, options);
      }
      /**
       * life cycle, element is afixed to the DOM
       */

    }, {
      key: "connectedCallback",
      value: function connectedCallback() {
        babelHelpers.get(babelHelpers.getPrototypeOf(ElmslnStudioDashboard.prototype), "connectedCallback", this).call(this);
      } // static get observedAttributes() {
      //   return [];
      // }
      // disconnectedCallback() {}
      // attributeChangedCallback(attr, oldValue, newValue) {}

    }]);
    return ElmslnStudioDashboard;
  }(_litElement.LitElement);

  _exports.ElmslnStudioDashboard = ElmslnStudioDashboard;
  customElements.define("elmsln-studio-dashboard", ElmslnStudioDashboard);
});