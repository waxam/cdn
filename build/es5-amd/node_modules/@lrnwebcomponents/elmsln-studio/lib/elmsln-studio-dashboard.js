define(["exports", "../../../lit-element/lit-element.js", "../../../@polymer/iron-ajax/iron-ajax.js", "../../accent-card/accent-card.js", "../../a11y-collapse/a11y-collapse.js", "../../progress-donut/progress-donut.js", "../../../@polymer/iron-icons/iron-icons.js"], function (_exports, _litElement, _ironAjax, _accentCard, _a11yCollapse, _progressDonut, _ironIcons) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.ElmslnStudioDashboard = void 0;

  function _templateObject7_f42ec4a0954111eaba7de7fca9c9f5e8() {
    var data = babelHelpers.taggedTemplateLiteral(["\n        :host {\n          font-family: var(--elmsln-studio--FontFamily, sans-serif);\n          font-size: 13px;\n        }\n        h1,\n        h2,\n        h3,\n        [slot=\"heading\"] {\n          font-size: 14px;\n          font-weight: normal;\n          color: var(--simple-colors-default-theme-grey-7, #666);\n          margin: 0;\n        }\n        [slot=\"subheading\"] {\n          text-decoration: underline;\n        }\n        [slot=\"subheading\"]:focus,\n        [slot=\"subheading\"]:hover {\n          text-decoration: none;\n        }\n        accent-card {\n          margin: var(--elmsln-studio--Margin, 20px);\n          flex: 1 0 calc(50% - 2 * var(--elmsln-studio--Margin, 20px));\n        }\n        .linklist {\n          list-style-type: none;\n          padding-inline-start: 0;\n        }\n        #comments .linklist {\n          padding: 0 var(--elmsln-studio--Margin, 20px);\n        }\n        .linklist li {\n          position: relative;\n          padding: 5px 0;\n          margin-bottom: 1px;\n          opacity: 0.8;\n        }\n        .linklist li,\n        accent-card th,\n        accent-card td {\n          padding: 5px 0;\n          text-align: left;\n          min-height: 25px;\n          border-bottom: 1px solid\n            var(--simple-colors-default-theme-grey-4, #666);\n        }\n        accent-card table {\n          width: 100%;\n          border-collapse: collapse;\n        }\n        accent-card button,\n        .linklist button {\n          border: none;\n          padding: 0;\n          text-align: left;\n          font-size: inherit;\n          font-weight: inherit;\n        }\n        .linklist iron-icon {\n          position: absolute;\n          width: 24px;\n          height: 24px;\n          right: 0px;\n          top: calc(50% - 12px);\n        }\n        .linklist-heading::after {\n          content: \" \";\n          position: absolute;\n          left: 0;\n          right: 0;\n          top: 0;\n          bottom: 0;\n        }\n        .linklist li:focus,\n        .linklist li:focus-within .linklist-heading::after {\n          outline: 1px solid blue;\n        }\n        .linklist li:hover {\n          cursor: pointer;\n          opacity: 1;\n        }\n        .linklist-heading,\n        .linklist-subheading {\n          display: block;\n          width: calc(100% - 24px);\n        }\n        .linklist-heading {\n          font-weight: bold;\n        }\n        .linklist-subheading {\n          font-size: 12px;\n        }\n        @media screen and (min-width: 600px) {\n          :host {\n            display: flex;\n            align-items: stretch;\n            justify-content: space-between;\n          }\n          #cards {\n            width: calc(66.66666667%);\n          }\n          #comments {\n            padding-right: var(--elmsln-studio--Padding, 20px);\n            width: calc(33.33333333% - var(--elmsln-studio--Padding, 20px));\n          }\n          h1,\n          h2 {\n            flex: 0 0 calc(100% - var(--elmsln-studio--Margin, 20px));\n            padding: 0 var(--elmsln-studio--Margin, 20px);\n          }\n        }\n        @media screen and (min-width: 900px) {\n          #cards > div {\n            display: flex;\n            align-items: stretch;\n            justify-content: space-between;\n            flex-wrap: wrap;\n          }\n        }\n      "]);

    _templateObject7_f42ec4a0954111eaba7de7fca9c9f5e8 = function _templateObject7_f42ec4a0954111eaba7de7fca9c9f5e8() {
      return data;
    };

    return data;
  }

  function _templateObject6_f42ec4a0954111eaba7de7fca9c9f5e8() {
    var data = babelHelpers.taggedTemplateLiteral(["\n              <li>\n                <iron-icon aria-hidden=\"true\" icon=\"chevron-right\"></iron-icon>\n                <button class=\"linklist-heading\">\n                  ", "\n                  ", "\n                  ", "\n                </button>\n                <span class=\"linklist-subheading\">\n                  ", "\n                </span>\n              </li>\n            "]);

    _templateObject6_f42ec4a0954111eaba7de7fca9c9f5e8 = function _templateObject6_f42ec4a0954111eaba7de7fca9c9f5e8() {
      return data;
    };

    return data;
  }

  function _templateObject5_f42ec4a0954111eaba7de7fca9c9f5e8() {
    var data = babelHelpers.taggedTemplateLiteral(["\n                  <li>\n                    <iron-icon\n                      aria-hidden=\"true\"\n                      icon=\"chevron-right\"\n                    ></iron-icon>\n                    <button class=\"linklist-heading\">\n                      ", "\n                    </button>\n                    <span class=\"linklist-subheading\"\n                      >", "</span\n                    >\n                  </li>\n                "]);

    _templateObject5_f42ec4a0954111eaba7de7fca9c9f5e8 = function _templateObject5_f42ec4a0954111eaba7de7fca9c9f5e8() {
      return data;
    };

    return data;
  }

  function _templateObject4_f42ec4a0954111eaba7de7fca9c9f5e8() {
    var data = babelHelpers.taggedTemplateLiteral(["\n                  <li>\n                    <iron-icon\n                      aria-hidden=\"true\"\n                      icon=\"chevron-right\"\n                    ></iron-icon>\n                    <button class=\"linklist-heading\">\n                      ", "\n                    </button>\n                    <span class=\"linklist-subheading\"\n                      >", "</span\n                    >\n                  </li>\n                "]);

    _templateObject4_f42ec4a0954111eaba7de7fca9c9f5e8 = function _templateObject4_f42ec4a0954111eaba7de7fca9c9f5e8() {
      return data;
    };

    return data;
  }

  function _templateObject3_f42ec4a0954111eaba7de7fca9c9f5e8() {
    var data = babelHelpers.taggedTemplateLiteral(["\n                            Due\n                            ", "\n                          "]);

    _templateObject3_f42ec4a0954111eaba7de7fca9c9f5e8 = function _templateObject3_f42ec4a0954111eaba7de7fca9c9f5e8() {
      return data;
    };

    return data;
  }

  function _templateObject2_f42ec4a0954111eaba7de7fca9c9f5e8() {
    var data = babelHelpers.taggedTemplateLiteral(["\n                  <li>\n                    <iron-icon\n                      aria-hidden=\"true\"\n                      icon=\"chevron-right\"\n                    ></iron-icon>\n                    <button class=\"linklist-heading\">\n                      ", "\n                    </button>\n                    <span class=\"linklist-subheading\"\n                      >", "\n                    </span>\n                  </li>\n                "]);

    _templateObject2_f42ec4a0954111eaba7de7fca9c9f5e8 = function _templateObject2_f42ec4a0954111eaba7de7fca9c9f5e8() {
      return data;
    };

    return data;
  }

  function _templateObject_f42ec4a0954111eaba7de7fca9c9f5e8() {
    var data = babelHelpers.taggedTemplateLiteral(["\n      <iron-ajax\n        auto\n        url=\"", "\"\n        @response=\"", "\"\n      ></iron-ajax>\n      <iron-ajax\n        auto\n        url=\"", "\"\n        @response=\"", "\"\n      ></iron-ajax>\n      <iron-ajax\n        auto\n        url=\"", "\"\n        @response=\"", "\"\n      ></iron-ajax>\n      <iron-ajax\n        auto\n        url=\"", "\"\n        @response=\"", "\"\n      ></iron-ajax>\n      <iron-ajax\n        auto\n        url=\"", "\"\n        @response=\"", "\"\n      ></iron-ajax>\n      <!--h1 class=\"sr-only\">Overview</h1-->\n      <div id=\"cards\">\n        <div id=\"profile\">\n          <h2 class=\"sr-only\">My Progress</h2>\n          <accent-card accent-color=\"purple\">\n            <span slot=\"heading\"\n              >", "</span\n            >\n            <progress-donut\n              accent-color=\"purple\"\n              slot=\"content\"\n              animation=\"500\"\n              animation-delay=\"500\"\n              complete=\"[5,3,2,6]\"\n              donut-width=\"25%\"\n              chart-padding=\"0\"\n              image-src=\"", "\"\n              image-alt=\"Profile picture for ", "\"\n              start-angle=\"0\"\n              total=\"30\"\n            ></progress-donut>\n            <table slot=\"content\">\n              <tbody>\n                <tr>\n                  <th scope=\"row\">Course Progress</th>\n                  <td>\n                    ", "%\n                  </td>\n                </tr>\n                <tr>\n                  <th scope=\"row\">Comments</th>\n                  <td>", "</td>\n                </tr>\n                <tr>\n                  <th scope=\"row\">Submissions</th>\n                  <td>\n                    ", "\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </accent-card>\n          <accent-card accent-color=\"green\">\n            <span slot=\"heading\">Work Due</span>\n            <ul class=\"linklist\" slot=\"content\">\n              ", "\n            </ul>\n          </accent-card>\n        </div>\n        <div id=\"work\">\n          <h2>Recent Work</h2>\n          <accent-card accent-color=\"amber\">\n            <span slot=\"heading\">Submissions</span>\n            <button slot=\"subheading\">All submissions</button>\n            <ul class=\"linklist\" slot=\"content\">\n              ", "\n            </ul>\n          </accent-card>\n          <accent-card accent-color=\"cyan\">\n            <span slot=\"heading\">Comments</span>\n            <button slot=\"subheading\">All comments</button>\n            <!-- TODO need a comments list where student is in the thread or thread is about student submission -->\n            <ul class=\"linklist\" slot=\"content\">\n              ", "\n            </ul>\n          </accent-card>\n        </div>\n      </div>\n      <div id=\"comments\">\n        <h2>Recent Activity</h2>\n        <ul class=\"linklist\">\n          ", "\n        </ul>\n      </div>\n    "]);

    _templateObject_f42ec4a0954111eaba7de7fca9c9f5e8 = function _templateObject_f42ec4a0954111eaba7de7fca9c9f5e8() {
      return data;
    };

    return data;
  }

  /**
   * `elmsln-studio-dashboard`
   * Studio App for ELMS:LN
   *
   * @customElement elmsln-studio-dashboard
   * @lit-html
   * @lit-element
   * @demo demo/index.html
   */
  var ElmslnStudioDashboard =
  /*#__PURE__*/
  function (_LitElement) {
    babelHelpers.inherits(ElmslnStudioDashboard, _LitElement);
    babelHelpers.createClass(ElmslnStudioDashboard, [{
      key: "render",
      // render function
      value: function render() {
        var _this2 = this;

        return (0, _litElement.html)(_templateObject_f42ec4a0954111eaba7de7fca9c9f5e8(), this.activitySrc, function (e) {
          return _this2._handleArrayData(e, "__activity");
        }, this.assignmentsSrc, function (e) {
          return _this2._handleArrayData(e, "__assignments");
        }, this.commentsSrc, function (e) {
          return _this2._handleArrayData(e, "__comments");
        }, this.profileSrc, function (e) {
          return _this2._handleObjectData(e, "__profile");
        }, this.submissionsSrc, function (e) {
          return _this2._handleObjectData(e, "__submissions");
        }, this.__profile.student.data.display_name, this.__profile.student.data.sis.avatar_url, this.__profile.student.data.display_name, Math.round(this.__profile.student.progress.submissions.reduce(function (sum, val) {
          return sum + val;
        }) * 100 / this.__profile.student.progress.totalAssignments), this.__profile.student.progress.comments, this.__profile.student.progress.submissions.reduce(function (sum, val) {
          return sum + val;
        }), this.__assignments.map(function (assign) {
          return (0, _litElement.html)(_templateObject2_f42ec4a0954111eaba7de7fca9c9f5e8(), assign.attributes.title, _this2._getDueDate(assign) ? (0, _litElement.html)(_templateObject3_f42ec4a0954111eaba7de7fca9c9f5e8(), _this2.date(parseInt(_this2._getDueDate(assign)) * 1000)) : "");
        }), Object.keys(this.__submissions).map(function (submission) {
          return (0, _litElement.html)(_templateObject4_f42ec4a0954111eaba7de7fca9c9f5e8(), _this2.__submissions[submission].attributes.title, _this2.date(_this2.__submissions[submission].meta.changed));
        }), this.__comments.map(function (comment) {
          return (0, _litElement.html)(_templateObject5_f42ec4a0954111eaba7de7fca9c9f5e8(), comment.attributes.subject, _this2.date(comment.attributes.changed));
        }), this.__activity.map(function (activity) {
          return (0, _litElement.html)(_templateObject6_f42ec4a0954111eaba7de7fca9c9f5e8(), activity.relationships.author.data.sis.sortable_name.replace(/.*,/, ""), activity.type === "comment" ? "commented" : "submitted", activity.type === "comment" ? activity.attributes.subject : activity.attributes.title, _this2.date(activity.type === "comment" ? activity.attributes.changed : activity.meta.changed));
        }));
      } // properties available to the custom element for data binding

    }, {
      key: "tag",

      /**
       * Store the tag name to make it easier to obtain directly.
       * @notice function name must be here for tooling to operate correctly
       */
      value: function tag() {
        return "elmsln-studio-dashboard";
      } // life cycle

    }], [{
      key: "styles",
      get: function get() {
        return [(0, _litElement.css)(_templateObject7_f42ec4a0954111eaba7de7fca9c9f5e8())];
      }
    }, {
      key: "properties",
      get: function get() {
        return {
          /*
           * source JSON for all activity
           * (submissions and comments by anyone)
           */
          activitySrc: {
            type: String,
            attribute: "activity-src"
          },

          /*
           * source JSON for upcoming assignments
           * that student hasn't submitted yet
           */
          assignmentsSrc: {
            type: String,
            attribute: "assignments-src"
          },

          /*
           * source JSON for most recent comments in response to
           * student's comment or submission
           */
          commentsSrc: {
            type: String,
            attribute: "comments-src"
          },

          /*
           * source JSON for student's profile data (name & course progress)
           */
          profileSrc: {
            type: String,
            attribute: "profile-src"
          },

          /*
           * source JSON for student's most recent submissions
           */
          submissionsSrc: {
            type: String,
            attribute: "submissions-src"
          },

          /*
           * recent activity
           * (submissions and comments from everyone)
           */
          __activity: {
            type: Array
          },

          /*
           * upcoming assignments
           */
          __assignments: {
            type: Array
          },

          /*
           * most recent comments in response to
           * student's comment or submission
           */
          __comments: {
            type: Array
          },

          /*
           * student's profile data
           * (name & course progress)
           */
          __profileSrc: {
            type: Object
          },

          /*
           * student's submissions
           */
          __submissions: {
            type: Object
          }
        };
      }
    }]);

    function ElmslnStudioDashboard() {
      var _this;

      babelHelpers.classCallCheck(this, ElmslnStudioDashboard);
      _this = babelHelpers.possibleConstructorReturn(this, babelHelpers.getPrototypeOf(ElmslnStudioDashboard).call(this));
      _this.__activity = [];
      _this.__assignments = [];
      _this.__comments = [];
      _this.__profile = {
        student: {
          data: {
            type: "user",
            id: "371",
            name: "toc5234",
            display_name: "Tom Cat",
            avatar: "http://placekitten.com/300/150",
            sis: {
              id: 6966348,
              name: "Tom Cat",
              created_at: "2019-07-24T16:16:51-04:00",
              sortable_name: "Cat, Tom",
              short_name: "Tom Cat",
              sis_user_id: "toc5234@psu.edu",
              integration_id: null,
              avatar_url: "http://placekitten.com/300/150"
            }
          },
          progress: {
            comments: 22,
            submissions: [5, 3, 2, 6],
            totalAssignments: 30
          }
        }
      };
      _this.__submissions = [];
      _this.tag = ElmslnStudioDashboard.tag;
      return _this;
    }

    babelHelpers.createClass(ElmslnStudioDashboard, [{
      key: "_getDueDates",
      value: function _getDueDates(item) {
        return item.meta.rationale && item.meta.rationale.data ? item.meta.rationale.data : undefined;
      }
    }, {
      key: "_getDueDate",
      value: function _getDueDate(item) {
        //console.log('_getDueDate',item,this._getDueDates(item));
        return this._getDueDates(item) ? this._getDueDates(item)[1] || this._getDueDates(item)[0] : undefined;
      }
    }, {
      key: "_handleArrayData",
      value: function _handleArrayData(e, propName) {
        this[propName] = e && e.detail && e.detail.response && e.detail.response.data ? e.detail.response.data : []; //console.log("_handleArrayData", e, propName, this[propName]);
      }
    }, {
      key: "_handleObjectData",
      value: function _handleObjectData(e, propName) {
        this[propName] = e && e.detail && e.detail.response && e.detail.response.data ? e.detail.response.data : {}; //console.log('_handleObjectData',e,propName,this[propName]);
      }
    }, {
      key: "date",
      value: function date(time) {
        var date,
            options = {
          //weekday: 'long',
          year: "numeric",
          month: "long",
          day: "numeric"
        };

        if (time && isNaN(time)) {
          var parts = time.split(/\D+/);
          date = babelHelpers.construct(Date, babelHelpers.toConsumableArray(parts));
          /*console.log('date',parts,
          '\ndate',date,
          '\ntoString',date.toString(),
          '\ntoLocaleString',date.toLocaleString(),
          '\ntoLocaleDateString',date.toLocaleDateString(undefined,options),
          '\ntoUTCString',date.toUTCString(),
          '\ntoTimeString',date.toTimeString(),
          '\ntoLocaleTimeString',date.toLocaleTimeString()
          );*/
        } else if (time) {
          date = new Date(parseInt(time));
        }

        return date.toLocaleDateString(undefined, options);
      }
      /**
       * life cycle, element is afixed to the DOM
       */

    }, {
      key: "connectedCallback",
      value: function connectedCallback() {
        babelHelpers.get(babelHelpers.getPrototypeOf(ElmslnStudioDashboard.prototype), "connectedCallback", this).call(this);
      } // static get observedAttributes() {
      //   return [];
      // }
      // disconnectedCallback() {}
      // attributeChangedCallback(attr, oldValue, newValue) {}

    }]);
    return ElmslnStudioDashboard;
  }(_litElement.LitElement);

  _exports.ElmslnStudioDashboard = ElmslnStudioDashboard;
  customElements.define("elmsln-studio-dashboard", ElmslnStudioDashboard);
});