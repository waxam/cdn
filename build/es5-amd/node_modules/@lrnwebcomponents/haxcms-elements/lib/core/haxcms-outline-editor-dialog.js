define(["exports","../../../../@polymer/polymer/polymer-element.js","../../../../@polymer/polymer/lib/utils/render-status.js","./haxcms-site-store.js","../../../../mobx/lib/mobx.module.js","../../../../@polymer/paper-button/paper-button.js","../../../../@polymer/iron-icon/iron-icon.js","../../../../@polymer/iron-icons/iron-icons.js","../../../json-editor/json-editor.js","../../../editable-outline/editable-outline.js","../../../json-outline-schema/json-outline-schema.js"],function(_exports,_polymerElement,_renderStatus,_haxcmsSiteStore,_mobxModule){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.HAXCMSOutlineEditorDialog=void 0;function _templateObject_15baee20598711e9be72c76822165544(){var data=babelHelpers.taggedTemplateLiteral(["\n      <style>\n        :host {\n          display: block;\n          height: 60vh;\n          min-width: 50vw;\n        }\n        .buttons {\n          position: absolute;\n          bottom: 0;\n          z-index: 1000000;\n          background-color: var(--simple-modal-titlebar-background, #ddd);\n          left: 0;\n          right: 0;\n        }\n        #toggle {\n          float: right;\n          text-transform: unset;\n        }\n        editable-outline,\n        json-editor {\n          margin-bottom: 32px;\n        }\n      </style>\n      <editable-outline\n        id=\"outline\"\n        edit-mode\n        hidden$=\"[[viewMode]]\"\n        items=\"[[manifestItems]]\"\n      ></editable-outline>\n      <json-editor\n        id=\"editor\"\n        label=\"JSON Outline Schema items\"\n        value=\"[[manifestItemsStatic]]\"\n        hidden$=\"[[!viewMode]]\"\n      ></json-editor>\n      <div class=\"buttons\">\n        <paper-button dialog-confirm on-tap=\"_saveTap\">Save</paper-button>\n        <paper-button dialog-dismiss>Cancel</paper-button>\n        <paper-button id=\"toggle\" on-tap=\"toggleView\"\n          ><iron-icon icon=\"[[_viewIcon]]\"></iron-icon\n          >[[viewLabel]]</paper-button\n        >\n      </div>\n    "]);_templateObject_15baee20598711e9be72c76822165544=function(){return data};return data}var HAXCMSOutlineEditorDialog=function(_PolymerElement){babelHelpers.inherits(HAXCMSOutlineEditorDialog,_PolymerElement);function HAXCMSOutlineEditorDialog(){babelHelpers.classCallCheck(this,HAXCMSOutlineEditorDialog);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(HAXCMSOutlineEditorDialog).apply(this,arguments))}babelHelpers.createClass(HAXCMSOutlineEditorDialog,[{key:"_manifestItemsChanged",value:function _manifestItemsChanged(newValue){if(newValue){window.JSONOutlineSchema.requestAvailability().items=newValue;this.manifestItemsStatic=JSON.stringify(newValue,null,2)}}},{key:"ready",value:function ready(){babelHelpers.get(babelHelpers.getPrototypeOf(HAXCMSOutlineEditorDialog.prototype),"ready",this).call(this);(0,_renderStatus.afterNextRender)(this,function(){var _this=this;this.$.editor.addEventListener("current-data-changed",function(e){if(e.detail.value){_this.set("manifestItems",e.detail.value);_this.$.outline.importJsonOutlineSchemaItems()}})})}},{key:"connectedCallback",value:function connectedCallback(){var _this2=this;babelHelpers.get(babelHelpers.getPrototypeOf(HAXCMSOutlineEditorDialog.prototype),"connectedCallback",this).call(this);this.__disposer=[];(0,_mobxModule.autorun)(function(reaction){setTimeout(function(){_this2.manifestItems=Object.assign([],(0,_mobxModule.toJS)(_haxcmsSiteStore.store.manifest.items));_this2.__disposer.push(reaction)},500)})}},{key:"disconnectedCallback",value:function disconnectedCallback(){var _this3=this;for(var i in this.__disposer){this.__disposer[i].dispose()}this.$.editor.removeEventListener("current-data-changed",function(e){if(e.detail.value){_this3.set("manifestItems",e.detail.value);_this3.$.outline.importJsonOutlineSchemaItems()}});babelHelpers.get(babelHelpers.getPrototypeOf(HAXCMSOutlineEditorDialog.prototype),"disconnectedCallback",this).call(this)}},{key:"toggleView",value:function toggleView(){this.viewMode=!this.viewMode}},{key:"_getViewLabel",value:function _getViewLabel(mode){if(mode){this._viewIcon="icons:view-list";return"Outline mode"}else{this._viewIcon="icons:code";return"Developer mode"}}},{key:"_viewModeChanged",value:function _viewModeChanged(newValue){if(!newValue){this.$.outline.importJsonOutlineSchemaItems()}else{var items=this.$.outline.exportJsonOutlineSchemaItems(!0);this.set("manifestItems",items)}}},{key:"_saveTap",value:function _saveTap(){this.dispatchEvent(new CustomEvent("haxcms-save-outline",{bubbles:!0,composed:!0,cancelable:!1,detail:this.$.outline.exportJsonOutlineSchemaItems(!0)}))}}],[{key:"tag",get:function get(){return"haxcms-outline-editor-dialog"}},{key:"template",get:function get(){return(0,_polymerElement.html)(_templateObject_15baee20598711e9be72c76822165544())}},{key:"properties",get:function get(){return{opened:{type:Boolean,notify:!0},manifestItems:{type:Array,observer:"_manifestItemsChanged"},manifestItemsStatic:{type:String},viewLabel:{type:String,computed:"_getViewLabel(viewMode)"},viewMode:{type:Boolean,value:!1,observer:"_viewModeChanged"}}}}]);return HAXCMSOutlineEditorDialog}(_polymerElement.PolymerElement);_exports.HAXCMSOutlineEditorDialog=HAXCMSOutlineEditorDialog;window.customElements.define(HAXCMSOutlineEditorDialog.tag,HAXCMSOutlineEditorDialog)});