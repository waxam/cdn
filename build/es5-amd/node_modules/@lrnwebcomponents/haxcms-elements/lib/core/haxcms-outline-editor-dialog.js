define(["../../../../@polymer/polymer/polymer-legacy.js","../../../../@polymer/polymer/lib/utils/render-status.js","./haxcms-site-store.js","../../../../mobx/lib/mobx.module.js","../../../../@polymer/paper-button/paper-button.js","../../../../@polymer/iron-icon/iron-icon.js","../../../../@polymer/iron-icons/iron-icons.js","../../../json-editor/json-editor.js","../../../editable-outline/editable-outline.js","../../../json-outline-schema/json-outline-schema.js"],function(_polymerLegacy,_renderStatus,_haxcmsSiteStore,_mobxModule){"use strict";function _templateObject_908ac2404d8611e9a2768d85e834e91f(){var data=babelHelpers.taggedTemplateLiteral(["\n    <style>\n      :host {\n        display: block;\n        height: 60vh;\n      }\n      .buttons {\n        position: absolute;\n        bottom: 0;\n        z-index: 1000000;\n        background-color: var(--simple-modal-titlebar-background, #ddd);\n        left: 0;\n        right: 0;\n      }\n      #toggle {\n        float: right;\n        text-transform: unset;\n      }\n      editable-outline,\n      json-editor {\n        margin-bottom: 32px;\n      }\n    </style>\n    <editable-outline\n      id=\"outline\"\n      edit-mode\n      hidden$=\"[[viewMode]]\"\n      items=\"[[manifestItems]]\"\n    ></editable-outline>\n    <json-editor\n      id=\"editor\"\n      label=\"JSON Outline Schema items\"\n      value=\"[[manifestItemsStatic]]\"\n      hidden$=\"[[!viewMode]]\"\n    ></json-editor>\n    <div class=\"buttons\">\n      <paper-button dialog-confirm on-tap=\"_saveTap\">Save</paper-button>\n      <paper-button dialog-dismiss>Cancel</paper-button>\n      <paper-button id=\"toggle\" on-tap=\"toggleView\"\n        ><iron-icon icon=\"[[_viewIcon]]\"></iron-icon>[[viewLabel]]</paper-button\n      >\n    </div>\n  "]);_templateObject_908ac2404d8611e9a2768d85e834e91f=function(){return data};return data}(0,_polymerLegacy.Polymer)({_template:(0,_polymerLegacy.html)(_templateObject_908ac2404d8611e9a2768d85e834e91f()),is:"haxcms-outline-editor-dialog",properties:{opened:{type:Boolean,notify:!0},manifestItems:{type:Array,observer:"_manifestItemsChanged"},manifestItemsStatic:{type:String},viewLabel:{type:String,computed:"_getViewLabel(viewMode)"},viewMode:{type:Boolean,value:!1,observer:"_viewModeChanged"}},_manifestItemsChanged:function _manifestItemsChanged(newValue){if(newValue){window.JSONOutlineSchema.requestAvailability().items=newValue;this.manifestItemsStatic=JSON.stringify(newValue,null,2)}},attached:function attached(){var _this=this;this.__disposer=[];(0,_mobxModule.autorun)(function(reaction){setTimeout(function(){_this.manifestItems=Object.assign([],(0,_mobxModule.toJS)(_haxcmsSiteStore.store.manifest.items));_this.__disposer.push(reaction)},500)});(0,_renderStatus.afterNextRender)(this,function(){var _this2=this;this.$.editor.addEventListener("current-data-changed",function(e){if(e.detail.value){_this2.set("manifestItems",e.detail.value);_this2.$.outline.importJsonOutlineSchemaItems()}})})},detached:function detached(){var _this3=this;for(var i in this.__disposer){this.__disposer[i].dispose()}this.$.editor.removeEventListener("current-data-changed",function(e){if(e.detail.value){_this3.set("manifestItems",e.detail.value);_this3.$.outline.importJsonOutlineSchemaItems()}})},toggleView:function toggleView(){this.viewMode=!this.viewMode},_getViewLabel:function _getViewLabel(mode){if(mode){this._viewIcon="icons:view-list";return"Outline mode"}else{this._viewIcon="icons:code";return"Developer mode"}},_viewModeChanged:function _viewModeChanged(newValue){if(!newValue){this.$.outline.importJsonOutlineSchemaItems()}else{var items=this.$.outline.exportJsonOutlineSchemaItems(!0);this.set("manifestItems",items)}},_saveTap:function _saveTap(){this.fire("haxcms-save-outline",this.$.outline.exportJsonOutlineSchemaItems(!0))}})});