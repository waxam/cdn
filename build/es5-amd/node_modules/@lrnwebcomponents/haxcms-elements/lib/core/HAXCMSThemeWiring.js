define(["exports","./haxcms-site-store.js","../../../../mobx/lib/mobx.module.js"],function(_exports,_haxcmsSiteStore,_mobxModule){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.HAXCMSThemeWiring=_exports.HAXCMSTheme=void 0;_exports.HAXCMSTheme=function HAXCMSTheme(SuperClass){return function(_SuperClass){babelHelpers.inherits(_class,_SuperClass);function _class(){var _this;babelHelpers.classCallCheck(this,_class);_this=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(_class).call(this));_this.HAXCMSThemeWiring=new HAXCMSThemeWiring(babelHelpers.assertThisInitialized(babelHelpers.assertThisInitialized(_this)));return _this}babelHelpers.createClass(_class,[{key:"_activeIdChanged",value:function _activeIdChanged(){window.scrollTo({top:0,left:0,behavior:"smooth"})}},{key:"_contentContainerChanged",value:function _contentContainerChanged(newValue,oldValue){if(newValue&&null===oldValue){this.HAXCMSThemeWiring.connect(this,newValue)}else if(newValue&&oldValue){this.HAXCMSThemeWiring.disconnect(this);this.HAXCMSThemeWiring.connect(this,newValue)}else if(oldValue&&null===newValue){this.HAXCMSThemeWiring.disconnect(this)}}},{key:"_locationChanged",value:function _locationChanged(newValue){if(!newValue||"undefined"===typeof newValue.route)return;var name=newValue.route.name;if("home"===name||"404"===name){var firstItem=this.manifest.items.find(function(i){return"undefined"!==typeof i.id});if(firstItem){_haxcmsSiteStore.store.activeId=firstItem.id}}}},{key:"connectedCallback",value:function connectedCallback(){var _this2=this;babelHelpers.get(babelHelpers.getPrototypeOf(_class.prototype),"connectedCallback",this).call(this);if(null===this.contentContainer){this.contentContainer=this.shadowRoot.querySelector("#contentcontainer")}this.__disposer=(0,_mobxModule.autorun)(function(){_this2.manifest=(0,_mobxModule.toJS)(_haxcmsSiteStore.store.routerManifest);if(babelHelpers.typeof(_this2.manifest.title)!=="undefined"){document.title=_this2.manifest.title}if(babelHelpers.typeof(_this2.manifest.metadata)!=="undefined"&&babelHelpers.typeof(_this2.manifest.metadata.cssVariable)!=="undefined"){var ary=_this2.manifest.metadata.cssVariable.replace("--simple-colors-default-theme-","").split("-");ary.pop();_this2.accentColor=ary.join("-");document.body.style.setProperty("--haxcms-color",_this2.manifest.metadata.hexCode)}});this.__disposer2=(0,_mobxModule.autorun)(function(){_this2._location=_haxcmsSiteStore.store.location});this.__disposer3=(0,_mobxModule.autorun)(function(){_this2.activeItem=(0,_mobxModule.toJS)(_haxcmsSiteStore.store.activeItem)});this.__disposer4=(0,_mobxModule.autorun)(function(){_this2.activeId=(0,_mobxModule.toJS)(_haxcmsSiteStore.store.activeId)});this.__disposer5=(0,_mobxModule.autorun)(function(){_this2.activeManifestIndex=(0,_mobxModule.toJS)(_haxcmsSiteStore.store.activeManifestIndex)});this.__disposer6=(0,_mobxModule.autorun)(function(){_this2.pageTitle=(0,_mobxModule.toJS)(_haxcmsSiteStore.store.pageTitle)});this.__disposer7=(0,_mobxModule.autorun)(function(){_this2.siteTitle=(0,_mobxModule.toJS)(_haxcmsSiteStore.store.siteTitle)});this.__disposer8=(0,_mobxModule.autorun)(function(){_this2.homeLink=(0,_mobxModule.toJS)(_haxcmsSiteStore.store.homeLink)});this.__disposer9=(0,_mobxModule.autorun)(function(){_this2.activeManifestIndexCounter=(0,_mobxModule.toJS)(_haxcmsSiteStore.store.activeManifestIndexCounter)})}},{key:"disconnectedCallback",value:function disconnectedCallback(){babelHelpers.get(babelHelpers.getPrototypeOf(_class.prototype),"disconnectedCallback",this).call(this);delete this.contentContainer;this.__disposer();this.__disposer2();this.__disposer3();this.__disposer4();this.__disposer5();this.__disposer6();this.__disposer7();this.__disposer8();this.__disposer9()}},{key:"resetActive",value:function resetActive(){window.history.pushState(null,null,_haxcmsSiteStore.store.location.baseUrl);window.dispatchEvent(new PopStateEvent("popstate"));this.dispatchEvent(new CustomEvent("haxcms-active-item-changed",{bubbles:!0,cancelable:!0,detail:{}}))}}],[{key:"properties",get:function get(){return{editMode:{type:Boolean,reflectToAttribute:!0},activeItem:{type:Object},manifest:{type:Object},contentContainer:{type:Object,value:null,observer:"_contentContainerChanged"},activeManifestIndex:{type:Number,notify:!0},activeManifestIndexCounter:{type:Number,notify:!0},activeId:{type:String,notify:!0,observer:"_activeIdChanged"},_location:{type:Object,observer:"_locationChanged"}}}}]);return _class}(SuperClass)};var HAXCMSThemeWiring=function(){function HAXCMSThemeWiring(element){var load=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!0;babelHelpers.classCallCheck(this,HAXCMSThemeWiring);if(load){document.body.addEventListener("haxcms-edit-mode-changed",this._globalEditChanged.bind(element));document.body.addEventListener("haxcms-active-item-changed",this._activeItemUpdate.bind(element));document.body.addEventListener("haxcms-trigger-update",this._triggerUpdate.bind(element));if(null==window.localStorage.getItem("HAXCMSSystemData")){window.localStorage.setItem("HAXCMSSystemData",JSON.stringify({}))}}}babelHelpers.createClass(HAXCMSThemeWiring,[{key:"connect",value:function connect(element,injector){if(babelHelpers.typeof(window.cmsSiteEditor)!=="undefined"){window.cmsSiteEditor.requestAvailability(element,injector)}}},{key:"disconnect",value:function disconnect(element){document.body.removeEventListener("haxcms-active-item-changed",this._activeItemUpdate.bind(element));document.body.removeEventListener("haxcms-edit-mode-changed",this._globalEditChanged.bind(element));document.body.removeEventListener("haxcms-trigger-update",this._triggerUpdate.bind(element))}},{key:"_globalEditChanged",value:function _globalEditChanged(e){this.editMode=e.detail}},{key:"_activeItemUpdate",value:function _activeItemUpdate(e){var newValue=e.detail;if(newValue&&babelHelpers.typeof(newValue.id)!=="undefined"){_haxcmsSiteStore.store.activeId=newValue.id;var evt=new CustomEvent("json-outline-schema-active-item-changed",{bubbles:!0,cancelable:!0,detail:newValue});this.dispatchEvent(evt);if(babelHelpers.typeof(newValue.title)!=="undefined"){document.title=this.manifest.title+" - "+newValue.title}else{document.title=this.manifest.title}}else{document.title=this.manifest.title}}},{key:"_triggerUpdate",value:function _triggerUpdate(){this.dispatchEvent(new CustomEvent("haxcms-active-item-changed",{bubbles:!0,cancelable:!0,detail:{}}))}}]);return HAXCMSThemeWiring}();_exports.HAXCMSThemeWiring=HAXCMSThemeWiring});