define(["exports","meta","require","../../../../@polymer/polymer/polymer-element.js","../../../../@polymer/polymer/lib/utils/resolve-url.js","./haxcms-site-store.js","../../../../@polymer/polymer/lib/utils/async.js","./haxcms-site-editor-ui.js"],function(_exports,meta,_require,_polymerElement,_resolveUrl,_haxcmsSiteStore,async){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.HAXCMSEditorBuilder=void 0;meta=babelHelpers.interopRequireWildcard(meta);_require=babelHelpers.interopRequireWildcard(_require);async=babelHelpers.interopRequireWildcard(async);var HAXCMSEditorBuilder=function(_PolymerElement){babelHelpers.inherits(HAXCMSEditorBuilder,_PolymerElement);babelHelpers.createClass(HAXCMSEditorBuilder,null,[{key:"tag",get:function get(){return"haxcms-editor-builder"}}]);function HAXCMSEditorBuilder(){var _this;babelHelpers.classCallCheck(this,HAXCMSEditorBuilder);_this=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(HAXCMSEditorBuilder).call(this));_this.applyContext();return _this}babelHelpers.createClass(HAXCMSEditorBuilder,[{key:"connectedCallback",value:function connectedCallback(){babelHelpers.get(babelHelpers.getPrototypeOf(HAXCMSEditorBuilder.prototype),"connectedCallback",this).call(this);window.addEventListener("hax-store-ready",this.storeReady.bind(this))}},{key:"disconnectedCallback",value:function disconnectedCallback(){window.removeEventListener("hax-store-ready",this.storeReady.bind(this));babelHelpers.get(babelHelpers.getPrototypeOf(HAXCMSEditorBuilder.prototype),"disconnectedCallback",this).call(this)}},{key:"storeReady",value:function storeReady(){if(!_haxcmsSiteStore.store.cmsSiteEditor.haxCmsSiteEditorUIElement){_haxcmsSiteStore.store.cmsSiteEditor.haxCmsSiteEditorUIElement=document.createElement("haxcms-site-editor-ui");document.body.appendChild(_haxcmsSiteStore.store.cmsSiteEditor.haxCmsSiteEditorUIElement);setTimeout(function(){_haxcmsSiteStore.store.cmsSiteEditor.haxCmsSiteEditorUIElement.painting=!1},5)}}},{key:"getContext",value:function getContext(){var context="";if(("undefined"===typeof DatArchive?"undefined":babelHelpers.typeof(DatArchive))!=="undefined"){context="beaker"}else if(!0===window.__haxCMSContextPublished){context="published"}else if(!0===window.__haxCMSContextNode){context="nodejs"}else if(!0===window.__haxCMSContextDemo){context="demo"}else{context="php"}return context}},{key:"applyContext",value:function applyContext(){var context=this.getContext();if("php"===context){var script=document.createElement("script");script.src="/haxcms-jwt.php";document.documentElement.appendChild(script)}if("published"!==context){var basePath=(0,_resolveUrl.pathFromUrl)(decodeURIComponent(meta.url));_haxcmsSiteStore.store.cmsSiteEditor.tag="haxcms-backend-".concat(context);new Promise(function(res,rej){return _require.default(["".concat(basePath,"backends/").concat(_haxcmsSiteStore.store.cmsSiteEditor.tag,".js")],res,rej)})}}}]);return HAXCMSEditorBuilder}(_polymerElement.PolymerElement);_exports.HAXCMSEditorBuilder=HAXCMSEditorBuilder;window.customElements.define(HAXCMSEditorBuilder.tag,HAXCMSEditorBuilder)});