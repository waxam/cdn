define(["meta","require","../../../../@polymer/polymer/polymer-legacy.js","../../../../@polymer/polymer/lib/utils/resolve-url.js","../../../../@polymer/polymer/lib/utils/async.js","./haxcms-site-editor-ui.js"],function(meta,_require,_polymerLegacy,_resolveUrl,async){"use strict";meta=babelHelpers.interopRequireWildcard(meta);_require=babelHelpers.interopRequireWildcard(_require);async=babelHelpers.interopRequireWildcard(async);window.cmsSiteEditor=window.cmsSiteEditor||{};window.cmsSiteEditor.instance=null;(0,_polymerLegacy.Polymer)({is:"haxcms-editor-builder",ready:function ready(){this.applyContext()},attached:function attached(){window.addEventListener("hax-store-ready",this.storeReady.bind(this))},detached:function detached(){window.removeEventListener("hax-store-ready",this.storeReady.bind(this))},storeReady:function storeReady(){if(!window.cmsSiteEditor.haxCmsSiteEditorUIElement){window.cmsSiteEditor.haxCmsSiteEditorUIElement=document.createElement("haxcms-site-editor-ui");document.body.appendChild(window.cmsSiteEditor.haxCmsSiteEditorUIElement);setTimeout(function(){window.cmsSiteEditor.haxCmsSiteEditorUIElement.painting=!1},5)}},getContext:function getContext(){var context="";if(("undefined"===typeof DatArchive?"undefined":babelHelpers.typeof(DatArchive))!=="undefined"){context="beaker"}else if(!0===window.__haxCMSContextPublished){context="published"}else if(!0===window.__haxCMSContextNode){context="nodejs"}else if(!0===window.__haxCMSContextDemo){context="demo"}else{context="php"}return context},applyContext:function applyContext(){var context=this.getContext();if("php"===context){var script=document.createElement("script");script.src="/haxcms-jwt.php";document.documentElement.appendChild(script)}if("published"!==context){var basePath=(0,_resolveUrl.pathFromUrl)(decodeURIComponent(meta.url));window.cmsSiteEditor.tag="haxcms-backend-".concat(context);async.microTask.run(function(){setTimeout(function(){new Promise(function(res,rej){return _require.default(["".concat(basePath,"backends/").concat(window.cmsSiteEditor.tag,".js")],res,rej)})},50)})}}});window.cmsSiteEditor.requestAvailability=function(){var element=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this,location=1<arguments.length&&arguments[1]!==void 0?arguments[1]:document.body;if(!window.cmsSiteEditor.instance){window.cmsSiteEditor.instance=document.createElement(window.cmsSiteEditor.tag);window.cmsSiteEditor.instance.appElement=element;window.cmsSiteEditor.instance.appendTarget=location;document.body.appendChild(window.cmsSiteEditor.instance)}else{if(element){window.cmsSiteEditor.instance.appElement=element;window.cmsSiteEditor.instance.appendTarget=location;if(babelHelpers.typeof(window.cmsSiteEditor.instance.haxCmsSiteEditorElement)!=="undefined"){window.cmsSiteEditor.instance.appendTarget.appendChild(window.cmsSiteEditor.instance.haxCmsSiteEditorElement)}}}return window.cmsSiteEditor.instance}});