define(["exports","../../../../mobx/lib/mobx.module.js"],function(_exports,_mobxModule){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.store=void 0;var Store=function(){function Store(){babelHelpers.classCallCheck(this,Store);this.location=null;this.editMode=!1;this.manifest=null;this.activeId=null}babelHelpers.createClass(Store,[{key:"findItem",value:function findItem(id){if(this.manifest&&id){return this.manifest.items.find(function(item){if(item.id!==id){return!1}return!0})}else{return null}}},{key:"routerManifest",get:function get(){var manifest=this.manifest;document.body.dispatchEvent(new CustomEvent("json-outline-schema-changed",{bubbles:!0,detail:manifest}));if(manifest&&"undefined"!==typeof manifest.items){var userData=JSON.parse(window.localStorage.getItem("HAXCMSSystemData")),accessData={};if(null==userData){userData={manifests:{}};userData.manifests[manifest.id]={accessData:{}};window.localStorage.setItem("HAXCMSSystemData",JSON.stringify(userData))}if(userData&&babelHelpers.typeof(userData.manifests)!=="undefined"&&babelHelpers.typeof(userData.manifests[manifest.id])!=="undefined"&&userData.manifests[manifest.id].accessData!=="undefined"){accessData=userData.manifests[manifest.id].accessData}var manifestItems=manifest.items.map(function(i){var metadata=i.metadata;if(babelHelpers.typeof(accessData[i.id])!=="undefined"){metadata.accessData=accessData[i.id]}var location=i.location.replace("pages/","").replace("/index.html","");return Object.assign({},i,{location:location,metadata:metadata})});return Object.assign({},manifest,{items:manifestItems,accessData:accessData})}}},{key:"siteTitle",get:function get(){var manifest=this.manifest;if(manifest.title){return manifest.title}return""}},{key:"homeLink",get:function get(){var firstItem=this.manifest.items.find(function(i){return"undefined"!==typeof i.id});if(firstItem){return firstItem.location.replace("pages/","").replace("/index.html","")}else{return"/"}}},{key:"activeItem",get:function get(){var item=this.findItem(this.activeId);if(item){return item}return null}},{key:"themeData",get:function get(){if(this.manifest){var themeData={};if(this.manifest.metadata.theme){themeData=this.manifest.metadata.theme}else{themeData={"haxcms-basic-theme":{element:"haxcms-basic-theme",path:"@lrnwebcomponents/haxcms-elements/lib/core/themes/haxcms-basic-theme.js",name:"Basic theme"}}}if(this.activeItem){if(this.activeItem.metadata.theme){return this.activeItem.metadata.theme}}return themeData}}},{key:"activeManifestIndex",get:function get(){if(this.manifest&&this.manifest.items&&this.activeId){for(var index in this.manifest.items){if(this.manifest.items[index].id===this.activeId){return parseInt(index)}}}return-1}},{key:"activeManifestIndexCounter",get:function get(){if(null!==this.activeManifestIndex){return 1+this.activeManifestIndex}return 0}},{key:"pageTitle",get:function get(){if(this.activeItem){return this.activeItem.title}return""}},{key:"parentTitle",get:function get(){var _this=this;if(this.manifest&&this.activeItem){var tmpItem=this.manifest.items.find(function(d){return _this.activeItem.parent===d.id});if(tmpItem){return tmpItem.title}}return""}},{key:"ancestorTitle",get:function get(){var _this2=this;if(this.manifest&&this.activeItem){var _ret=function(){var tmpItem=_this2.manifest.items.find(function(d){return _this2.activeItem.parent===d.id});while(tmpItem&&null!=tmpItem.parent){tmpItem=_this2.manifest.items.find(function(i){return i.id==tmpItem.parent})}if(tmpItem){return{v:tmpItem.title}}}();if("object"===babelHelpers.typeof(_ret))return _ret.v}return""}}]);return Store}();(0,_mobxModule.decorate)(Store,{location:_mobxModule.observable.ref,editMode:_mobxModule.observable,manifest:_mobxModule.observable,routerManifest:_mobxModule.computed,siteTitle:_mobxModule.computed,themeData:_mobxModule.computed,homeLink:_mobxModule.computed,activeId:_mobxModule.observable,activeItem:_mobxModule.computed,activeManifestIndex:_mobxModule.computed,activeManifestIndexCounter:_mobxModule.computed,pageTitle:_mobxModule.computed,parentTitle:_mobxModule.computed,ancestorTitle:_mobxModule.computed,changeActiveItem:_mobxModule.action.bound});var store=new Store;_exports.store=store;(0,_mobxModule.autorun)(function(){if(store.location&&store.location.route&&store.location.route.component){var id=store.location.route.name,found=store.manifest.items.filter(function(item){if(item.id!==id){return!1}return!0});if(found){store.activeId=id}}});(0,_mobxModule.autorun)(function(){var foundItem=(0,_mobxModule.toJS)(store.findItem(store.activeId));if(foundItem){document.body.dispatchEvent(new CustomEvent("json-outline-schema-active-item-changed",{bubbles:!0,detail:foundItem}))}})});