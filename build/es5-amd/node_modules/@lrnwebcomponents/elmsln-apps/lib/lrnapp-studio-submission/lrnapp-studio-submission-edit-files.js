define(["exports","../../../../@polymer/polymer/polymer-element.js","../../../../@polymer/paper-dialog/paper-dialog.js","../../../../@polymer/polymer/lib/elements/dom-repeat.js","../../../../@polymer/polymer/lib/elements/dom-if.js","../../../../@polymer/paper-dialog-scrollable/paper-dialog-scrollable.js","../../../secure-request/secure-request.js","../../../../@polymer/iron-icon/iron-icon.js","../../../../@polymer/paper-button/paper-button.js","../../../../@vaadin/vaadin-upload/vaadin-upload.js","./lrnapp-studio-submission-edit-add-asset.js","./lrnapp-studio-submission-edit-file.js"],function(_exports,_polymerElement,_paperDialog,_domRepeat,_domIf,_paperDialogScrollable,_secureRequest,_ironIcon,_paperButton,_vaadinUpload,_lrnappStudioSubmissionEditAddAsset,_lrnappStudioSubmissionEditFile){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.LrnappStudioSubmissionEditFiles=void 0;function _templateObject_8dc84ed06daf11e98b2b231443c29fcf(){var data=babelHelpers.taggedTemplateLiteral(["\n    <style>\n      :host {\n        display: block;\n        position: relative;\n        min-height: 200px;\n      }\n\n      #pages {\n        display: block;\n      }\n\n      .files__files {\n        display: flex;\n        flex-wrap: wrap;\n      }\n\n      .files__files > * {\n        margin-right: 16px;\n        min-width: 200px;\n      }\n\n      neon-animated-pages .iron-selected {\n        position: static;\n      }\n\n      paper-dialog {\n        width: 50%;\n        width: 50vmax;\n        padding: 16px;\n      }\n    </style>\n\n    <div class=\"files__files\">\n      <template is=\"dom-repeat\" items=\"{{files}}\" as=\"file\">\n        <lrnapp-studio-submission-edit-file\n          file=\"{{file}}\"\n          on-deleted=\"_deleteImage\"\n          data-index$=\"[[index]]\"\n        ></lrnapp-studio-submission-edit-file>\n      </template>\n      <lrnapp-studio-submission-edit-add-asset\n        on-click=\"_addImage\"\n        icon=\"editor:attach-file\"\n      ></lrnapp-studio-submission-edit-add-asset>\n    </div>\n\n    <paper-dialog\n      id=\"dialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n      with-backdrop=\"\"\n    >\n      <h2>Add Files(s)</h2>\n      <paper-dialog-scrollable>\n        <div class=\"files__upload\">\n          <template is=\"dom-if\" if=\"[[uploadUrl]]\">\n            <vaadin-upload\n              accept=\"[[fileTypes]]\"\n              target=\"[[uploadUrl]]\"\n              method=\"POST\"\n              form-data-name=\"file-upload\"\n              on-upload-success=\"_handleImageUploadSuccess\"\n            >\n              <div class=\"files__drop-label\">\n                <iron-icon icon=\"description\"></iron-icon>\n                Upload files here:\n              </div>\n            </vaadin-upload>\n          </template>\n        </div>\n      </paper-dialog-scrollable>\n      <div class=\"buttons\">\n        <paper-button dialog-dismiss=\"\">Cancel</paper-button>\n      </div>\n    </paper-dialog>"],["\n    <style>\n      :host {\n        display: block;\n        position: relative;\n        min-height: 200px;\n      }\n\n      #pages {\n        display: block;\n      }\n\n      .files__files {\n        display: flex;\n        flex-wrap: wrap;\n      }\n\n      .files__files > * {\n        margin-right: 16px;\n        min-width: 200px;\n      }\n\n      neon-animated-pages .iron-selected {\n        position: static;\n      }\n\n      paper-dialog {\n        width: 50%;\n        width: 50vmax;\n        padding: 16px;\n      }\n    </style>\n\n    <div class=\"files__files\">\n      <template is=\"dom-repeat\" items=\"{{files}}\" as=\"file\">\n        <lrnapp-studio-submission-edit-file\n          file=\"{{file}}\"\n          on-deleted=\"_deleteImage\"\n          data-index\\$=\"[[index]]\"\n        ></lrnapp-studio-submission-edit-file>\n      </template>\n      <lrnapp-studio-submission-edit-add-asset\n        on-click=\"_addImage\"\n        icon=\"editor:attach-file\"\n      ></lrnapp-studio-submission-edit-add-asset>\n    </div>\n\n    <paper-dialog\n      id=\"dialog\"\n      entry-animation=\"scale-up-animation\"\n      exit-animation=\"fade-out-animation\"\n      with-backdrop=\"\"\n    >\n      <h2>Add Files(s)</h2>\n      <paper-dialog-scrollable>\n        <div class=\"files__upload\">\n          <template is=\"dom-if\" if=\"[[uploadUrl]]\">\n            <vaadin-upload\n              accept=\"[[fileTypes]]\"\n              target=\"[[uploadUrl]]\"\n              method=\"POST\"\n              form-data-name=\"file-upload\"\n              on-upload-success=\"_handleImageUploadSuccess\"\n            >\n              <div class=\"files__drop-label\">\n                <iron-icon icon=\"description\"></iron-icon>\n                Upload files here:\n              </div>\n            </vaadin-upload>\n          </template>\n        </div>\n      </paper-dialog-scrollable>\n      <div class=\"buttons\">\n        <paper-button dialog-dismiss=\"\">Cancel</paper-button>\n      </div>\n    </paper-dialog>"]);_templateObject_8dc84ed06daf11e98b2b231443c29fcf=function _templateObject_8dc84ed06daf11e98b2b231443c29fcf(){return data};return data}var LrnappStudioSubmissionEditFiles=/*#__PURE__*/function(_SecureRequestXhr){babelHelpers.inherits(LrnappStudioSubmissionEditFiles,_SecureRequestXhr);function LrnappStudioSubmissionEditFiles(){babelHelpers.classCallCheck(this,LrnappStudioSubmissionEditFiles);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(LrnappStudioSubmissionEditFiles).apply(this,arguments))}babelHelpers.createClass(LrnappStudioSubmissionEditFiles,[{key:"_filesChanged",value:function _filesChanged(files){}},{key:"_addImage",value:function _addImage(e){// @todo switch to singleton
this.$.dialog.open()}},{key:"_selectPage",value:function _selectPage(e){var normalizedEvent=dom(e),page=normalizedEvent.localTarget.getAttribute("data-page");this.set("selectedPage",page)}},{key:"_handleImageUploadSuccess",value:function _handleImageUploadSuccess(e){this.set("selectedPage",0);var files=[],response=e.detail.xhr.response,response=JSON.parse(response);// get the newely created file
if(response.data.file){var file=response.data.file;if(null===this.files){this.set("files",[])}this.push("files",file);this.$.dialog.close()}}},{key:"_deleteImage",value:function _deleteImage(e){var normalizedEvent=dom(e),deleteIndex=normalizedEvent.localTarget.getAttribute("data-index");this.splice("files",+deleteIndex,1)}},{key:"_canUpload",value:function _canUpload(){var uploadUrl=this.uploadUrl;if(null!==uploadUrl){return!0}else{return!1}}},{key:"log",value:function log(property){}/**
   * attached life cycle
   */},{key:"connectedCallback",value:function connectedCallback(){babelHelpers.get(babelHelpers.getPrototypeOf(LrnappStudioSubmissionEditFiles.prototype),"connectedCallback",this).call(this);var uploadUrl=this.generateUrl("/api/files");if(null!==uploadUrl){this.set("uploadUrl",uploadUrl)}}}],[{key:"template",get:function get(){return(0,_polymerElement.html)(_templateObject_8dc84ed06daf11e98b2b231443c29fcf())}},{key:"tag",get:function get(){return"lrnapp-studio-submission-edit-files"}},{key:"properties",get:function get(){return{files:{type:Array,notify:!0,value:null},selectedPage:{type:String,value:0},uploadUrl:{type:String,value:null,observer:"log"},fileTypes:{type:String,value:""}}}},{key:"observers",get:function get(){return["_filesChanged(files)"]}}]);return LrnappStudioSubmissionEditFiles}((0,_secureRequest.SecureRequestXhr)(_polymerElement.PolymerElement));_exports.LrnappStudioSubmissionEditFiles=LrnappStudioSubmissionEditFiles;window.customElements.define(LrnappStudioSubmissionEditFiles.tag,LrnappStudioSubmissionEditFiles)});