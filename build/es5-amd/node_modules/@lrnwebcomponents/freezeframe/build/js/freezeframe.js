var freezeframe=function($){var warn=function(_message){console.warn("\u2728 freezeframe.js \u2728 : "+_message)},has_images=function(){return 0==this.images.length?!1:!0},filter=function(_selector,_images){var filtered_images;if(_selector!=void 0&&1<_images.length){filtered_images=_images.filter($(_selector));if(0==filtered_images.length){warn("no images found for selector '"+_selector+"'");return!1}}else{filtered_images=_images}return filtered_images},process=function($_image){var ff=this,$canvas=$_image.siblings("canvas"),transitionEnd="transitionend webkitTransitionEnd oTransitionEnd otransitionend",image_width=$_image[0].clientWidth,image_height=$_image[0].clientHeight;$canvas.attr({width:image_width,height:image_height});context=$canvas[0].getContext("2d");context.drawImage($_image[0],0,0,image_width,image_height);$canvas.addClass("ff-canvas-ready").on(transitionEnd,function(){$(this).off(transitionEnd);$_image.addClass("ff-image-ready")})};function freezeframe(_options){var options;this.options={selector:".freezeframe",animation_play_duration:5e3,non_touch_device_trigger_event:"hover"};options="string"==typeof _options?{selector:_options}:_options;if(options){for(attribute in options){if(attribute in this.options){this.options[attribute]=options[attribute]}else{warn(attribute+"not a valid option")}}}this.is_touch_device="ontouchstart"in window||"onmsgesturechange"in window}freezeframe.prototype.capture=function(_selector){var selector;if(_selector!==void 0){selector=_selector}else if(this.options.selector!==void 0){selector=this.options.selector}else{warn("no selector passed to capture function or set in options");return!1}if(this.images==void 0){this.images=$()}this.images=this.images.add($("img"+selector));for(i=0;i<this.images.length;i++){if("gif"!==this.images[i].src.split(".").pop().toLowerCase().substring(0,3)){this.images.splice(i,1)}}if(0==this.images.length){console.warn("freezeframe : no gifs found for selector \""+selector+"\"");return!1}return this};freezeframe.prototype.setup=function(_selector){var ff=this,setup_required=this.images.not(".ff-setup"),container_classnames=["ff-container"];if(!has_images.call(ff)){warn("unable to run setup(), no images captured");return!1}else if(0==setup_required.length){warn("unable to run setup(), no images require setup");return!1}filter.call(ff,_selector,setup_required).each(function(){var $image=$(this);$image.addClass("ff-setup ff-image");if($image.hasClass("freezeframe-responsive")){container_classnames.push("ff-responsive")}$canvas=$("<canvas />",{class:"ff-canvas"}).attr({width:0,height:0}).insertBefore($image);$image.add($canvas).wrapAll($("<div />",{class:container_classnames.join(" ")}))});imagesLoaded(setup_required).on("progress",function(instance,image){process.call(ff,$(image.img))});return this};freezeframe.prototype.attach=function(_selector){var ff=this;if(!has_images.call(ff)){warn("unable to run attach(), no images captured");return!1}filter.call(ff,_selector,ff.images).each(function(){var $image=$(this),$canvas=$(this).siblings("canvas");if(!ff.is_touch_device&&"hover"==ff.options.non_touch_device_trigger_event||ff.is_touch_device){$image.mouseenter(function(){(function(){if($image.hasClass("ff-image-ready")){$image.attr("src",$image[0].src);$canvas.removeClass("ff-canvas-ready").addClass("ff-canvas-active")}})()});$image.mouseleave(function(){(function(){if($image.hasClass("ff-image-ready")){$canvas.removeClass("ff-canvas-active").addClass("ff-canvas-ready")}})()})}if(!ff.is_touch_device&&"click"==ff.options.non_touch_device_trigger_event||ff.is_touch_device){var click_timeout;$image.click(function(){(function(){var clicked=$canvas.hasClass("ff-canvas-active");if($image.hasClass("ff-image-ready")){if(clicked){if(ff.options.animation_play_duration!=1/0){clearTimeout(click_timeout)}$canvas.removeClass("ff-canvas-active").addClass("ff-canvas-ready")}else{$image.attr("src",$image[0].src);$canvas.removeClass("ff-canvas-ready").addClass("ff-canvas-active");if(ff.options.animation_play_duration!=1/0){click_timeout=setTimeout(function(){$canvas.removeClass("ff-canvas-active").addClass("ff-canvas-ready")},ff.options.animation_play_duration)}}}})()})}});return this};freezeframe.prototype.trigger=function(_selector){var ff=this,errors=0;filter.call(ff,_selector,ff.images).each(function(){if($(this).hasClass("ff-image-ready")){$(this).attr("src",$(this)[0].src);$(this).siblings("canvas").removeClass("ff-canvas-ready").addClass("ff-canvas-active")}else{warn("image not done processing ! "+$(this).attr("src"));errors++}});return 0==errors?!0:!1};freezeframe.prototype.release=function(_selector){var ff=this,errors=0;filter.call(ff,_selector,ff.images).each(function(){if($(this).hasClass("ff-image-ready")){$(this).siblings("canvas").removeClass("ff-canvas-active").addClass("ff-canvas-ready")}else{warn("image not done processing ! "+$(this).attr("src"));errors++}});return 0==errors?!0:!1};freezeframe.prototype.freeze=function(){this.capture().setup().attach();return this};return freezeframe}(jQuery);$.fn.freezeframe=function(_options){if(0==this.length){console.warn("\u2728 freezeframe.js \u2728 : no images found for selector "+this.selector);return!1}var ff=new freezeframe(_options);ff.images=this;ff.setup().attach();var self=this;["trigger","release"].forEach(function(method){self[method]=function(){ff[method](self.selector);return self}});return this};