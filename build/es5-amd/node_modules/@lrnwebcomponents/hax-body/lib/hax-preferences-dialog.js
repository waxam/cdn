define(["exports", "require", "../../../lit-element/lit-element.js", "../../simple-colors/simple-colors.js", "../../utils/utils.js", "../../../@polymer/polymer/lib/elements/custom-style.js"], function (_exports, _require, _litElement, _simpleColors, _utils, _customStyle) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.HaxPreferencesDialog = void 0;
  _require = babelHelpers.interopRequireWildcard(_require);

  function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

  function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { babelHelpers.defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

  function _templateObject2_4badf280494a11eab3124f20b4f7a7f7() {
    var data = babelHelpers.taggedTemplateLiteral(["\n      <custom-style>\n        <style>\n          app-drawer {\n            --app-drawer-content-container: {\n              background-color: #ffffff;\n            }\n            --app-drawer-width: 320px;\n          }\n          eco-json-schema-object {\n            --eco-json-schema-object-form : {\n              -ms-flex: unset;\n              -webkit-flex: unset;\n              flex: unset;\n              -webkit-flex-basis: unset;\n              flex-basis: unset;\n            }\n            --paper-checkbox-size: 16px;\n            --paper-checkbox-checked-ink-color: var(--hax-color-accent1);\n            --paper-checkbox-label: {\n              font-size: 16px;\n              line-height: 16px;\n            }\n          }\n        </style>\n      </custom-style>\n      <app-drawer\n        id=\"dialog\"\n        align=\"right\"\n        transition-duration=\"300\"\n        ?opened=\"", "\"\n        @opened-changed=\"", "\"\n      >\n        <h3 class=\"title\">\n          <iron-icon icon=\"icons:settings\"></iron-icon> ", "\n        </h3>\n        <div style=\"height: 100%; overflow: auto;\" class=\"pref-container\">\n          <eco-json-schema-object\n            .schema=\"", "\"\n            @value-changed=\"", "\"\n          ></eco-json-schema-object>\n        </div>\n        <paper-button id=\"closedialog\" @click=\"", "\">\n          <iron-icon icon=\"icons:cancel\" title=\"Close dialog\"></iron-icon>\n        </paper-button>\n      </app-drawer>\n    "]);

    _templateObject2_4badf280494a11eab3124f20b4f7a7f7 = function _templateObject2_4badf280494a11eab3124f20b4f7a7f7() {
      return data;
    };

    return data;
  }

  function _templateObject_4badf280494a11eab3124f20b4f7a7f7() {
    var data = babelHelpers.taggedTemplateLiteral(["\n        :host {\n          display: block;\n        }\n        iron-icon:not(:defined),\n        paper-button:not(:defined),\n        app-drawer:not(:defined) {\n          display: none;\n        }\n        #dialog {\n          z-index: 1000;\n          margin-top: 56px;\n        }\n        #closedialog {\n          float: right;\n          top: 124px;\n          right: 0;\n          position: absolute;\n          padding: 8px;\n          margin: 0;\n          background-color: var(--hax-color-menu-heading-bg, #eeeeee);\n          color: var(--hax-color-menu-heading-color, black);\n          width: 40px;\n          height: 40px;\n          min-width: unset;\n        }\n        .title {\n          position: relative;\n          padding: 16px;\n          outline: 0;\n          font-weight: 600;\n          text-align: left;\n          margin: 0;\n          background-color: var(--hax-color-menu-heading-bg, #eeeeee);\n          color: var(--hax-color-menu-heading-color, black);\n          font-size: 18px;\n          line-height: 18px;\n          font-family: \"Noto Serif\", serif;\n        }\n        eco-json-schema-object {\n          color: white;\n        }\n        .pref-container {\n          text-align: left;\n          padding: 16px;\n        }\n      "]);

    _templateObject_4badf280494a11eab3124f20b4f7a7f7 = function _templateObject_4badf280494a11eab3124f20b4f7a7f7() {
      return data;
    };

    return data;
  }

  /**
   * `hax-export-dialog`
   * @customElement hax-export-dialog
   * `Export dialog with all export options and settings provided.`
   */
  var HaxPreferencesDialog =
  /*#__PURE__*/
  function (_winEventsElement) {
    babelHelpers.inherits(HaxPreferencesDialog, _winEventsElement);
    babelHelpers.createClass(HaxPreferencesDialog, null, [{
      key: "styles",

      /**
       * LitElement constructable styles enhancement
       */
      get: function get() {
        return [].concat(babelHelpers.toConsumableArray(babelHelpers.get(babelHelpers.getPrototypeOf(HaxPreferencesDialog), "styles", this)), [(0, _litElement.css)(_templateObject_4badf280494a11eab3124f20b4f7a7f7())]);
      }
    }]);

    function HaxPreferencesDialog() {
      var _this;

      babelHelpers.classCallCheck(this, HaxPreferencesDialog);
      _this = babelHelpers.possibleConstructorReturn(this, babelHelpers.getPrototypeOf(HaxPreferencesDialog).call(this));
      _this.__winEvents = {
        "hax-store-property-updated": "_haxStorePropertyUpdated"
      };
      _this.title = "Editor preferences";
      new Promise(function (res, rej) {
        return _require.default(["../../../@polymer/iron-icon/iron-icon.js"], res, rej);
      });
      new Promise(function (res, rej) {
        return _require.default(["../../../@polymer/iron-icons/iron-icons.js"], res, rej);
      });
      new Promise(function (res, rej) {
        return _require.default(["../../../@polymer/paper-button/paper-button.js"], res, rej);
      });
      new Promise(function (res, rej) {
        return _require.default(["../../eco-json-schema-form/eco-json-schema-form.js"], res, rej);
      });
      new Promise(function (res, rej) {
        return _require.default(["../../eco-json-schema-form/lib/eco-json-schema-object.js"], res, rej);
      });
      new Promise(function (res, rej) {
        return _require.default(["../../../@polymer/app-layout/app-drawer/app-drawer.js"], res, rej);
      });
      return _this;
    }

    babelHelpers.createClass(HaxPreferencesDialog, [{
      key: "updated",
      value: function updated(changedProperties) {
        var _this2 = this;

        changedProperties.forEach(function (oldValue, propName) {
          // notify when any of these change
          if (propName == "preferences") {
            _this2._preferencesChanged(_this2[propName]);

            _this2.dispatchEvent(new CustomEvent("".concat(propName, "-changed"), {
              detail: {
                value: _this2[propName]
              }
            }));
          }
        });
      }
    }, {
      key: "render",
      value: function render() {
        return (0, _litElement.html)(_templateObject2_4badf280494a11eab3124f20b4f7a7f7(), this.opened, this.openedChanged, this.title, this.schema, this.valueChanged, this.closeEvent);
      }
    }, {
      key: "openedChanged",
      value: function openedChanged(e) {
        // force close event to align data model if clicking away
        if (!e.detail.value && window.HaxStore.instance.openDrawer === this) {
          window.HaxStore.write("openDrawer", false, this);
        }
      }
    }, {
      key: "closeEvent",
      value: function closeEvent(e) {
        this.opened = false;
      }
    }, {
      key: "firstUpdated",
      value: function firstUpdated(changedProperties) {
        // JSON schema object needs delayed to ensure page repaints the form
        var schema = {
          $schema: "http://json-schema.org/schema#",
          title: "HAX preferences",
          type: "object",
          properties: {
            haxShowExportButton: {
              title: "View source button",
              type: "boolean",
              value: true
            },
            haxRayMode: {
              title: "X-Ray vision",
              type: "boolean",
              value: false
            },
            haxDeveloperMode: {
              title: "Developer mode",
              type: "boolean",
              value: false
            },
            haxVoiceCommands: {
              title: "Voice commands",
              type: "boolean",
              value: false
            },
            haxGithubReport: {
              title: "Report issue",
              type: "string",
              value: false,
              component: {
                name: "a",
                properties: {
                  rel: "noopener",
                  style: "color: #81a3a9;font-size: 18px;top: 100vh;position: fixed;right: 0;padding: 16px;font-style: italic;",
                  id: "reportghissue",
                  href: "https://github.com/elmsln/lrnwebcomponents/issues/new?body=URL%20base:%20" + window.location.pathname + "&title=[hax] Bug%20report%20from%20preference%20panel",
                  target: "_blank"
                },
                slot: "Report an issue with HAX"
              }
            }
          }
        };
        this.schema = _objectSpread({}, schema); // fire an event that this is a core piece of the system

        this.dispatchEvent(new CustomEvent("hax-register-core-piece", {
          bubbles: true,
          cancelable: true,
          composed: true,
          detail: {
            piece: "haxPreferences",
            object: this
          }
        }));
      }
      /**
       * Store updated, sync.
       */

    }, {
      key: "_haxStorePropertyUpdated",
      value: function _haxStorePropertyUpdated(e) {
        if (e.detail && babelHelpers.typeof(e.detail.value) !== (typeof undefined === "undefined" ? "undefined" : babelHelpers.typeof(undefined)) && e.detail.property && e.detail.property === "globalPreferences" && e.detail.owner !== this) {
          this.preferences = _objectSpread({}, e.detail.value);
        }
      }
      /**
       * Notice preferences have changed.
       */

    }, {
      key: "_preferencesChanged",
      value: function _preferencesChanged(newValue) {
        if (this.schema && this.schema.properties && window.HaxStore.ready) {
          window.HaxStore.write("globalPreferences", newValue, this);
        }
      }
    }, {
      key: "valueChanged",
      value: function valueChanged(e) {
        if (e.detail.value) {
          this.preferences = _objectSpread({}, e.detail.value);
        }
      }
      /**
       * open the dialog
       */

    }, {
      key: "open",
      value: function open() {
        this.opened = true;
      }
      /**
       * close the dialog
       */

    }, {
      key: "close",
      value: function close() {
        this.opened = false;
      }
    }], [{
      key: "tag",
      get: function get() {
        return "hax-preferences-dialog";
      }
    }, {
      key: "properties",
      get: function get() {
        return {
          /**
           * Title when open.
           */
          title: {
            type: String
          },

          /**
           * Schema that has all of inputs / manages state
           */
          schema: {
            type: Object
          },

          /**
           * Preferences managed for everything global about HAX.
           */
          preferences: {
            type: Object
          },
          opened: {
            type: Boolean
          }
        };
      }
    }]);
    return HaxPreferencesDialog;
  }((0, _utils.winEventsElement)(_simpleColors.SimpleColors));

  _exports.HaxPreferencesDialog = HaxPreferencesDialog;
  window.customElements.define(HaxPreferencesDialog.tag, HaxPreferencesDialog);
});