var _templateObject=babelHelpers.taggedTemplateLiteral(["\n    <custom-style>\n      <style is=\"custom-style\" include=\"iron-flex iron-flex-alignment\">\n        paper-input {\n          padding: 2px;\n\n          --paper-input-container-label: {\n            white-space: normal;\n            position: static;\n            font-size: 22px;\n            color: #212121;\n          }\n        }\n\n        paper-collapse-item {\n          --paper-collapse-item-header: {\n            font-weight: bold;\n            padding: 8px 0 0 8px;\n          }\n        }\n\n        #form {\n          border: 1px solid #aaaaaa;\n        }\n\n        #form div:nth-child(odd) {\n          background-color: #f2f2f2;\n          padding: 4px;\n        }\n\n        #form div:nth-child(even) {\n          background-color: #e2e2e2;\n          border-top: 1px solid #aaaaaa;\n          border-bottom: 1px solid #aaaaaa;\n          padding: 4px;\n        }\n\n        #form div:focus,\n        #form div:hover,\n        #form div:active {\n          background-color: #ffffff !important;\n        }\n\n        paper-icon-button {\n          float: right;\n          border-radius: 50%;\n        }\n\n        .array-add {\n          color: #34e79a;\n          background-color: #f8f8f8;\n        }\n\n        .array-remove-element {\n          color: #f44336;\n          background-color: #f8f8f8;\n        }\n\n        .label {\n          @apply --paper-input-container-label;\n          white-space: normal;\n          position: static;\n          font-size: 22px;\n          color: #212121;\n        }\n\n        :host {\n          display: block;\n        }\n        .label {\n          white-space: normal;\n          position: static;\n          font-size: 22px;\n          color: #212121;\n          @apply --paper-input-container-label;\n        }\n      </style>\n    </custom-style>\n    <div class=\"horizontal layout\">\n      <div class=\"flex\" hidden$=\"[[!label]]\">[[label]]</div>\n      <paper-icon-button\n        id=\"addarray\"\n        title=\"Add another item\"\n        class=\"array-add\"\n        icon=\"add\"\n        on-click=\"_onAddItem\"\n        role=\"button\"\n        aria-label=\"Add another item\"\n      ></paper-icon-button>\n    </div>\n\n    <paper-collapse-group\n      id=\"form\"\n      class=\"vertical flex layout\"\n    ></paper-collapse-group>\n  "],["\n    <custom-style>\n      <style is=\"custom-style\" include=\"iron-flex iron-flex-alignment\">\n        paper-input {\n          padding: 2px;\n\n          --paper-input-container-label: {\n            white-space: normal;\n            position: static;\n            font-size: 22px;\n            color: #212121;\n          }\n        }\n\n        paper-collapse-item {\n          --paper-collapse-item-header: {\n            font-weight: bold;\n            padding: 8px 0 0 8px;\n          }\n        }\n\n        #form {\n          border: 1px solid #aaaaaa;\n        }\n\n        #form div:nth-child(odd) {\n          background-color: #f2f2f2;\n          padding: 4px;\n        }\n\n        #form div:nth-child(even) {\n          background-color: #e2e2e2;\n          border-top: 1px solid #aaaaaa;\n          border-bottom: 1px solid #aaaaaa;\n          padding: 4px;\n        }\n\n        #form div:focus,\n        #form div:hover,\n        #form div:active {\n          background-color: #ffffff !important;\n        }\n\n        paper-icon-button {\n          float: right;\n          border-radius: 50%;\n        }\n\n        .array-add {\n          color: #34e79a;\n          background-color: #f8f8f8;\n        }\n\n        .array-remove-element {\n          color: #f44336;\n          background-color: #f8f8f8;\n        }\n\n        .label {\n          @apply --paper-input-container-label;\n          white-space: normal;\n          position: static;\n          font-size: 22px;\n          color: #212121;\n        }\n\n        :host {\n          display: block;\n        }\n        .label {\n          white-space: normal;\n          position: static;\n          font-size: 22px;\n          color: #212121;\n          @apply --paper-input-container-label;\n        }\n      </style>\n    </custom-style>\n    <div class=\"horizontal layout\">\n      <div class=\"flex\" hidden\\$=\"[[!label]]\">[[label]]</div>\n      <paper-icon-button\n        id=\"addarray\"\n        title=\"Add another item\"\n        class=\"array-add\"\n        icon=\"add\"\n        on-click=\"_onAddItem\"\n        role=\"button\"\n        aria-label=\"Add another item\"\n      ></paper-icon-button>\n    </div>\n\n    <paper-collapse-group\n      id=\"form\"\n      class=\"vertical flex layout\"\n    ></paper-collapse-group>\n  "]);import{html,Polymer}from"@polymer/polymer/polymer-legacy.js";import{dom}from"@polymer/polymer/lib/legacy/polymer.dom.js";import"@polymer/iron-flex-layout/iron-flex-layout-classes.js";import"@polymer/iron-icons/iron-icons.js";import"@polymer/iron-icons/editor-icons.js";import"@polymer/paper-icon-button/paper-icon-button.js";import"paper-collapse-item/paper-collapse-item.js";import"paper-collapse-item/paper-collapse-group.js";import"@polymer/app-localize-behavior/app-localize-behavior.js";import"./eco-json-schema-boolean.js";import"./eco-json-schema-enum.js";import"./eco-json-schema-input.js";import"./eco-json-schema-object.js";import"./eco-json-schema-file.js";Polymer({is:"eco-json-schema-array",_template:html(_templateObject),properties:{schema:{type:Object,observer:"_schemaChanged"},label:{type:String},value:{type:Array,notify:!0,value:function(){return[]},observer:"_valueChanged"},error:{type:Object,observer:"_errorChanged"},_schemaArrayItems:{type:Array,notify:!0,value:function(){return[]}}},observers:["_schemaArraySplicesChanged(_schemaArrayItems.splices)"],_valueChanged:function(b,c){var d=this;b!==c&&("undefined"===typeof b?"undefined":babelHelpers.typeof(b))!=="undefined"&&babelHelpers.typeof(this.schema)!=="undefined"&&setTimeout(function(){for(var f in d._buildSchemaArrayItems(),b)d._onAddItemWithValue(b[f],parseInt(f))},100)},ready:function(){},detached:function(){this._clearForm()},_buildSchemaArrayItems:function(){this._schemaArrayItems=[]},_setValue:function(){this.value=[],this.value=this._schemaArrayItems.map(function(b){return b.value})},_schemaArraySplicesChanged:function(b){if(!b)return console.warn("detail is undefined");var c=this;b.keySplices&&console.warn("Got keySplices, don't know what to do with them!"),b.indexSplices.forEach(function(d){var f=["value",d.index,d.removed.length];if(d.removed&&d.removed.length)for(var g=d.index,h=d.index+d.removed.length;g<h;g++)c._removeArrayEl(c.$.form.children[g]);if(d.addedCount)for(var g=d.index,h=d.index+d.addedCount;g<h;g++){var j=d.object[g],k=c.create(j.component.name,{label:j.label,schema:j.schema,schemaArrayItem:j}),l=c.create("paper-collapse-item",{header:"Item "+(g+1)}),m=c.create("paper-icon-button",{icon:"remove",title:"Remove item"});c.listen(m,"tap","_onRemoveItem"),m.classList.add("array-remove-element"),k.classList.add("flex","horizontal","layout"),dom(l).appendChild(k),dom(l).appendChild(m);var n=c.$.form.children[g];n?dom(c.$.form).insertBefore(l,n):dom(c.$.form).appendChild(l),c.listen(k,j.component.valueProperty.replace(/([A-Z])/g,"-$1").toLowerCase()+"-changed","_schemaArrayItemChanged"),f.push(c._deepClone(k[j.component.valueProperty]))}c.splice.apply(c,f)})},_schemaArrayItemChanged:function(b,c){if(!(c.path&&/\.length$/.test(c.path))){var d=this,f=b.target.schemaArrayItem,g=this._schemaArrayItems.indexOf(f),h=["value",g];c.path&&/\.splices$/.test(c.path)?(h=h.concat(c.path.split(".").slice(1,-1)),c.value.keySplices&&console.warn("Got keySplices, don't know what to do with them!"),c.value.indexSplices.forEach(function(j){var k=[h.join("."),j.index,j.removed.length];if(j.addedCount)for(var l=j.index,m=j.index+j.addedCount;l<m;l++)k.push(d._deepClone(j.object[l]));d.splice.apply(d,k)})):c.path?(h=h.concat(c.path.split(".").slice(1)),this.set(h,this._deepClone(c.value)),this.notifyPath("path")):(this.splice("value",g,1,this._deepClone(c.value)),this.notifyPath("value.1"))}},_removeArrayEl:function(b){var c=dom(b);babelHelpers.typeof(c.childNodes[0])!=="undefined"&&(this.unlisten(c.childNodes[0],c.firstChild.schemaArrayItem.component.valueProperty.replace(/([A-Z])/g,"-$1").toLowerCase()+"-changed","_schemaArrayItemChanged"),babelHelpers.typeof(c.childNodes[1])!=="undefined"&&this.unlisten(c.childNodes[1],"tap","_onRemoveItem")),b.schemaArrayItem=null,dom(this.$.form).removeChild(b)},_clearForm:function(){for(var b=dom(this.$.form);b.firstChild;)this._removeArrayEl(b.firstChild)},_schemaChanged:function(){this._clearForm(),this._buildSchemaArrayItems(),this._setValue()},_errorChanged:function(){var b=this;dom(this.$.form).childNodes.forEach(function(c,d){dom(c).childNodes[0].error=b.error&&b.error[d]?b.error[d]:null})},_onAddItemWithValue:function(b){var d=this.schema.items;if(("undefined"===typeof b?"undefined":babelHelpers.typeof(b))!=="undefined")for(var f in b)babelHelpers.typeof(d.properties[f])!=="undefined"&&(d.properties[f].value=b[f]);var g={label:d.title,schema:d,component:d.component||{}};if(g.component.valueProperty||(g.component.valueProperty="value"),!g.component.name)if(this._isSchemaEnum(d))g.component.name="eco-json-schema-enum";else if(this._isSchemaBoolean(d.type))g.component.name="eco-json-schema-boolean";else if(this._isSchemaFile(d.type))g.component.name="eco-json-schema-file";else if(this._isSchemaValue(d.type))g.component.name="eco-json-schema-input";else if(this._isSchemaObject(d.type))g.component.name="eco-json-schema-object";else if(this._isSchemaArray(d.type))g.component.name="eco-json-schema-array";else return console.error("Unknown item type %s",d.type);var h=this,j=h.create(g.component.name,{label:g.label,schema:g.schema,schemaArrayItem:g}),k=h.create("paper-collapse-item",{header:"Item "+(f+1)}),l=h.create("paper-icon-button",{icon:"remove",title:"Remove item"});h.listen(l,"tap","_onRemoveItem"),l.classList.add("array-remove-element"),j.classList.add("flex","horizontal","layout"),dom(k).appendChild(j),dom(k).appendChild(l);var m=h.$.form.children[f];m?dom(h.$.form).insertBefore(k,m):dom(h.$.form).appendChild(k),h.listen(j,g.component.valueProperty.replace(/([A-Z])/g,"-$1").toLowerCase()+"-changed","_schemaArrayItemChanged"),this._schemaArrayItems.push(g)},_onAddItem:function(){var b=this.schema.items,c={label:b.title,schema:b,component:b.component||{}};if(c.component.valueProperty||(c.component.valueProperty="value"),!c.component.name)if(this._isSchemaEnum(b))c.component.name="eco-json-schema-enum";else if(this._isSchemaBoolean(b.type))c.component.name="eco-json-schema-boolean";else if(this._isSchemaFile(b.type))c.component.name="eco-json-schema-file";else if(this._isSchemaValue(b.type))c.component.name="eco-json-schema-input";else if(this._isSchemaObject(b.type))c.component.name="eco-json-schema-object";else if(this._isSchemaArray(b.type))c.component.name="eco-json-schema-array";else return console.error("Unknown item type %s",b.type);this.push("_schemaArrayItems",c)},_onRemoveItem:function(b){var c=dom(b).localTarget.previousSibling.schemaArrayItem,d=this._schemaArrayItems.indexOf(c);this.splice("_schemaArrayItems",d,1)},_deepClone:function(b){return JSON.parse(JSON.stringify(b))},_isSchemaValue:function(b){return this._isSchemaBoolean(b)||this._isSchemaNumber(b)||this._isSchemaString(b)||this._isSchemaFile(b)},_isSchemaFile:function(b){return Array.isArray(b)?-1!==b.indexOf("file"):"file"===b},_isSchemaBoolean:function(b){return Array.isArray(b)?-1!==b.indexOf("boolean"):"boolean"===b},_isSchemaEnum:function(b){return!!b.enum},_isSchemaNumber:function(b){return Array.isArray(b)?-1!==b.indexOf("number")||-1!==b.indexOf("integer"):"number"===b||"integer"===b},_isSchemaString:function(b){return Array.isArray(b)?-1!==b.indexOf("string"):"string"===b},_isSchemaObject:function(b){return"object"===b},_isSchemaArray:function(b){return"array"===b}});