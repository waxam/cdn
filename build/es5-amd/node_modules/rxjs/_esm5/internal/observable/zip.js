define(["exports","../../../../tslib/tslib.es6.js","./fromArray.js","../util/isArray.js","../Subscriber.js","../OuterSubscriber.js","../util/subscribeToResult.js","../symbol/iterator.js"],function(_exports,tslib_1,_fromArray,_isArray,_Subscriber,_OuterSubscriber,_subscribeToResult,_iterator){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.zip=function(){for(var observables=[],_i=0;_i<arguments.length;_i++){observables[_i]=arguments[_i]}var resultSelector=observables[observables.length-1];if("function"===typeof resultSelector){observables.pop()}return(0,_fromArray.fromArray)(observables,void 0).lift(new ZipOperator(resultSelector))};_exports.ZipSubscriber=_exports.ZipOperator=void 0;tslib_1=babelHelpers.interopRequireWildcard(tslib_1);var ZipOperator=function(){function ZipOperator(resultSelector){this.resultSelector=resultSelector}ZipOperator.prototype.call=function(subscriber,source){return source.subscribe(new ZipSubscriber(subscriber,this.resultSelector))};return ZipOperator}();_exports.ZipOperator=ZipOperator;var ZipSubscriber=function(_super){tslib_1.__extends(ZipSubscriber,_super);function ZipSubscriber(destination,resultSelector,values){if(void 0===values){values=Object.create(null)}var _this=_super.call(this,destination)||this;_this.iterators=[];_this.active=0;_this.resultSelector="function"===typeof resultSelector?resultSelector:null;_this.values=values;return _this}ZipSubscriber.prototype._next=function(value){var iterators=this.iterators;if((0,_isArray.isArray)(value)){iterators.push(new StaticArrayIterator(value))}else if("function"===typeof value[_iterator.iterator]){iterators.push(new StaticIterator(value[_iterator.iterator]()))}else{iterators.push(new ZipBufferIterator(this.destination,this,value))}};ZipSubscriber.prototype._complete=function(){var iterators=this.iterators,len=iterators.length;this.unsubscribe();if(0===len){this.destination.complete();return}this.active=len;for(var i=0,iterator;i<len;i++){iterator=iterators[i];if(iterator.stillUnsubscribed){var destination=this.destination;destination.add(iterator.subscribe(iterator,i))}else{this.active--}}};ZipSubscriber.prototype.notifyInactive=function(){this.active--;if(0===this.active){this.destination.complete()}};ZipSubscriber.prototype.checkIterators=function(){for(var iterators=this.iterators,len=iterators.length,destination=this.destination,i=0,iterator;i<len;i++){iterator=iterators[i];if("function"===typeof iterator.hasValue&&!iterator.hasValue()){return}}for(var shouldComplete=!1,args=[],i=0;i<len;i++){var iterator=iterators[i],result=iterator.next();if(iterator.hasCompleted()){shouldComplete=!0}if(result.done){destination.complete();return}args.push(result.value)}if(this.resultSelector){this._tryresultSelector(args)}else{destination.next(args)}if(shouldComplete){destination.complete()}};ZipSubscriber.prototype._tryresultSelector=function(args){var result;try{result=this.resultSelector.apply(this,args)}catch(err){this.destination.error(err);return}this.destination.next(result)};return ZipSubscriber}(_Subscriber.Subscriber);_exports.ZipSubscriber=ZipSubscriber;var StaticIterator=function(){function StaticIterator(iterator){this.iterator=iterator;this.nextResult=iterator.next()}StaticIterator.prototype.hasValue=function(){return!0};StaticIterator.prototype.next=function(){var result=this.nextResult;this.nextResult=this.iterator.next();return result};StaticIterator.prototype.hasCompleted=function(){var nextResult=this.nextResult;return nextResult&&nextResult.done};return StaticIterator}(),StaticArrayIterator=function(){function StaticArrayIterator(array){this.array=array;this.index=0;this.length=0;this.length=array.length}StaticArrayIterator.prototype[_iterator.iterator]=function(){return this};StaticArrayIterator.prototype.next=function(){var i=this.index++,array=this.array;return i<this.length?{value:array[i],done:!1}:{value:null,done:!0}};StaticArrayIterator.prototype.hasValue=function(){return this.array.length>this.index};StaticArrayIterator.prototype.hasCompleted=function(){return this.array.length===this.index};return StaticArrayIterator}(),ZipBufferIterator=function(_super){tslib_1.__extends(ZipBufferIterator,_super);function ZipBufferIterator(destination,parent,observable){var _this=_super.call(this,destination)||this;_this.parent=parent;_this.observable=observable;_this.stillUnsubscribed=!0;_this.buffer=[];_this.isComplete=!1;return _this}ZipBufferIterator.prototype[_iterator.iterator]=function(){return this};ZipBufferIterator.prototype.next=function(){var buffer=this.buffer;if(0===buffer.length&&this.isComplete){return{value:null,done:!0}}else{return{value:buffer.shift(),done:!1}}};ZipBufferIterator.prototype.hasValue=function(){return 0<this.buffer.length};ZipBufferIterator.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete};ZipBufferIterator.prototype.notifyComplete=function(){if(0<this.buffer.length){this.isComplete=!0;this.parent.notifyInactive()}else{this.destination.complete()}};ZipBufferIterator.prototype.notifyNext=function(outerValue,innerValue){this.buffer.push(innerValue);this.parent.checkIterators()};ZipBufferIterator.prototype.subscribe=function(value,index){return(0,_subscribeToResult.subscribeToResult)(this,this.observable,this,index)};return ZipBufferIterator}(_OuterSubscriber.OuterSubscriber)});