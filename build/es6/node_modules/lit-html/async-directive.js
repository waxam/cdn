import{noChange as t}from"./lit-html.js";import{Directive as i,PartType as e}from"./directive.js";export{directive}from"./directive.js";import{isSingleExpression as s}from"./directive-helpers.js";
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const r=(t,i)=>{var e,s;const a=t.N;if(void 0===a)return!1;for(const t of a)null===(s=(e=t).O)||void 0===s||s.call(e,i,!1),r(t,i);return!0},o=t=>{let i,e;do{if(void 0===(i=t.M))break;e=i.N,e.delete(t),t=i}while(0===(null==e?void 0:e.size))},h=t=>{for(let i;i=t.M;t=i){let e=i.N;if(void 0===e)i.N=e=new Set;else if(e.has(t))break;e.add(t),d(i)}};function n(t){void 0!==this.N?(o(this),this.M=t,h(this)):this.M=t}function l(t,i=!1,e=0){const s=this.H,a=this.N;if(void 0!==a&&0!==a.size)if(i)if(Array.isArray(s))for(let t=e;t<s.length;t++)r(s[t],!1),o(s[t]);else null!=s&&(r(s,!1),o(s));else r(this,t)}const d=t=>{var i,s,a,u;t.type==e.CHILD&&(null!==(i=(a=t).P)&&void 0!==i||(a.P=l),null!==(s=(u=t).Q)&&void 0!==s||(u.Q=n))};class c extends i{constructor(){super(...arguments),this.isConnected=!0,this.ut=t,this.N=void 0}T(t,i,e){super.T(t,i,e),h(this)}O(t,i=!0){this.at(t),i&&(r(this,t),o(this))}at(i){var e,s;i!==this.isConnected&&(i?(this.isConnected=!0,this.ut!==t&&(this.setValue(this.ut),this.ut=t),null===(e=this.reconnected)||void 0===e||e.call(this)):(this.isConnected=!1,null===(s=this.disconnected)||void 0===s||s.call(this)))}S(t,i){if(!this.isConnected)throw Error(`AsyncDirective ${this.constructor.name} was rendered while its tree was disconnected.`);return super.S(t,i)}setValue(t){if(this.isConnected)if(s(this.Σdt))this.Σdt.I(t,this);else{const i=[...this.Σdt.H];i[this.Σct]=t,this.Σdt.I(i,this,0)}else this.ut=t}disconnected(){}reconnected(){}}export{c as AsyncDirective};