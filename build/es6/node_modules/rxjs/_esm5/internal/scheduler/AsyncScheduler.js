import*as tslib_1 from"../../../../tslib/tslib.es6.js";import{Scheduler}from"../Scheduler.js";var AsyncScheduler=function(_super){tslib_1.__extends(AsyncScheduler,_super);function AsyncScheduler(SchedulerAction,now){if(void 0===now){now=Scheduler.now}var _this=_super.call(this,SchedulerAction,function(){if(AsyncScheduler.delegate&&AsyncScheduler.delegate!==_this){return AsyncScheduler.delegate.now()}else{return now()}})||this;_this.actions=[];_this.active=!1;_this.scheduled=void 0;return _this}AsyncScheduler.prototype.schedule=function(work,delay,state){if(void 0===delay){delay=0}if(AsyncScheduler.delegate&&AsyncScheduler.delegate!==this){return AsyncScheduler.delegate.schedule(work,delay,state)}else{return _super.prototype.schedule.call(this,work,delay,state)}};AsyncScheduler.prototype.flush=function(action){var actions=this.actions;if(this.active){actions.push(action);return}var error;this.active=!0;do{if(error=action.execute(action.state,action.delay)){break}}while(action=actions.shift());this.active=!1;if(error){while(action=actions.shift()){action.unsubscribe()}throw error}};return AsyncScheduler}(Scheduler);export{AsyncScheduler};