import{Observable}from"../Observable.js";import{isArray}from"../util/isArray.js";import{isFunction}from"../util/isFunction.js";import{map}from"../operators/map.js";var toString=Object.prototype.toString;export function fromEvent(target,eventName,options,resultSelector){if(isFunction(options)){resultSelector=options;options=void 0}if(resultSelector){return fromEvent(target,eventName,options).pipe(map(function(args){return isArray(args)?resultSelector.apply(void 0,args):resultSelector(args)}))}return new Observable(function(subscriber){setupSubscription(target,eventName,function(e){if(1<arguments.length){subscriber.next(Array.prototype.slice.call(arguments))}else{subscriber.next(e)}},subscriber,options)})}function setupSubscription(sourceObj,eventName,handler,subscriber,options){var unsubscribe;if(isEventTarget(sourceObj)){sourceObj.addEventListener(eventName,handler,options);unsubscribe=function(){return sourceObj.removeEventListener(eventName,handler,options)}}else if(isJQueryStyleEventEmitter(sourceObj)){sourceObj.on(eventName,handler);unsubscribe=function(){return sourceObj.off(eventName,handler)}}else if(isNodeStyleEventEmitter(sourceObj)){sourceObj.addListener(eventName,handler);unsubscribe=function(){return sourceObj.removeListener(eventName,handler)}}else if(sourceObj&&sourceObj.length){for(var i=0,len=sourceObj.length;i<len;i++){setupSubscription(sourceObj[i],eventName,handler,subscriber,options)}}else{throw new TypeError("Invalid event target")}subscriber.add(unsubscribe)}function isNodeStyleEventEmitter(sourceObj){return sourceObj&&"function"===typeof sourceObj.addListener&&"function"===typeof sourceObj.removeListener}function isJQueryStyleEventEmitter(sourceObj){return sourceObj&&"function"===typeof sourceObj.on&&"function"===typeof sourceObj.off}function isEventTarget(sourceObj){return sourceObj&&"function"===typeof sourceObj.addEventListener&&"function"===typeof sourceObj.removeEventListener}