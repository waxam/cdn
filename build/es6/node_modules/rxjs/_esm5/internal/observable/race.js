import*as tslib_1 from"../../../../tslib/tslib.es6.js";import{isArray}from"../util/isArray.js";import{fromArray}from"./fromArray.js";import{OuterSubscriber}from"../OuterSubscriber.js";import{subscribeToResult}from"../util/subscribeToResult.js";export function race(){for(var observables=[],_i=0;_i<arguments.length;_i++){observables[_i]=arguments[_i]}if(1===observables.length){if(isArray(observables[0])){observables=observables[0]}else{return observables[0]}}return fromArray(observables,void 0).lift(new RaceOperator)}var RaceOperator=function(){function RaceOperator(){}RaceOperator.prototype.call=function(subscriber,source){return source.subscribe(new RaceSubscriber(subscriber))};return RaceOperator}();export{RaceOperator};var RaceSubscriber=function(_super){tslib_1.__extends(RaceSubscriber,_super);function RaceSubscriber(destination){var _this=_super.call(this,destination)||this;_this.hasFirst=!1;_this.observables=[];_this.subscriptions=[];return _this}RaceSubscriber.prototype._next=function(observable){this.observables.push(observable)};RaceSubscriber.prototype._complete=function(){var observables=this.observables,len=observables.length;if(0===len){this.destination.complete()}else{for(var i=0;i<len&&!this.hasFirst;i++){var observable=observables[i],subscription=subscribeToResult(this,observable,observable,i);if(this.subscriptions){this.subscriptions.push(subscription)}this.add(subscription)}this.observables=null}};RaceSubscriber.prototype.notifyNext=function(outerValue,innerValue,outerIndex){if(!this.hasFirst){this.hasFirst=!0;for(var i=0;i<this.subscriptions.length;i++){if(i!==outerIndex){var subscription=this.subscriptions[i];subscription.unsubscribe();this.remove(subscription)}}this.subscriptions=null}this.destination.next(innerValue)};return RaceSubscriber}(OuterSubscriber);export{RaceSubscriber};