import"../../../../@webcomponents/shadycss/entrypoints/apply-shim.js";import{ElementMixin}from"../mixins/element-mixin.js";import{GestureEventListeners}from"../mixins/gesture-event-listeners.js";import{DirMixin}from"../mixins/dir-mixin.js";import{dedupingMixin}from"../utils/mixin.js";import"../utils/render-status.js";import"../utils/unresolved.js";import{dom,matchesSelector}from"./polymer.dom.js";import{setTouchAction}from"../utils/gestures.js";import{Debouncer}from"../utils/debounce.js";import{timeOut,microTask}from"../utils/async.js";import{get}from"../utils/path.js";import{wrap}from"../utils/wrap.js";import{scopeSubtree}from"../utils/scope-subtree.js";let styleInterface=window.ShadyCSS;export const LegacyElementMixin=dedupingMixin(base=>{const legacyElementBase=DirMixin(GestureEventListeners(ElementMixin(base))),DIRECTION_MAP={x:"pan-x",y:"pan-y",none:"none",all:"auto"};class LegacyElement extends legacyElementBase{constructor(){super(),this.isAttached,this.__boundListeners,this._debouncers}static get importMeta(){return this.prototype.importMeta}created(){}connectedCallback(){super.connectedCallback(),this.isAttached=!0,this.attached()}attached(){}disconnectedCallback(){super.disconnectedCallback(),this.isAttached=!1,this.detached()}detached(){}attributeChangedCallback(name,old,value,namespace){old!==value&&(super.attributeChangedCallback(name,old,value,namespace),this.attributeChanged(name,old,value))}attributeChanged(name,old,value){}_initializeProperties(){let proto=Object.getPrototypeOf(this);proto.hasOwnProperty(JSCompiler_renameProperty("__hasRegisterFinished",proto))||(this._registered(),proto.__hasRegisterFinished=!0),super._initializeProperties(),this.root=this,this.created(),this._applyListeners()}_registered(){}ready(){this._ensureAttributes(),super.ready()}_ensureAttributes(){}_applyListeners(){}serialize(value){return this._serializeValue(value)}deserialize(value,type){return this._deserializeValue(value,type)}reflectPropertyToAttribute(property,attribute,value){this._propertyToAttribute(property,attribute,value)}serializeValueToAttribute(value,attribute,node){this._valueToNodeAttribute(node||this,value,attribute)}extend(prototype,api){if(!prototype||!api)return prototype||api;let n$=Object.getOwnPropertyNames(api);for(let n,i=0;i<n$.length&&(n=n$[i]);i++){let pd=Object.getOwnPropertyDescriptor(api,n);pd&&Object.defineProperty(prototype,n,pd)}return prototype}mixin(target,source){for(let i in source)target[i]=source[i];return target}chainObject(object,prototype){return object&&prototype&&object!==prototype&&(object.__proto__=prototype),object}instanceTemplate(template){let content=this.constructor._contentForTemplate(template);return document.importNode(content,!0)}fire(type,detail,options){options=options||{},detail=null==detail?{}:detail;let event=new Event(type,{bubbles:void 0===options.bubbles||options.bubbles,cancelable:Boolean(options.cancelable),composed:void 0===options.composed||options.composed});event.detail=detail;let node=options.node||this;return wrap(node).dispatchEvent(event),event}listen(node,eventName,methodName){node=node||this;let hbl=this.__boundListeners||(this.__boundListeners=new WeakMap),bl=hbl.get(node);bl||(bl={},hbl.set(node,bl));let key=eventName+methodName;bl[key]||(bl[key]=this._addMethodEventListenerToNode(node,eventName,methodName,this))}unlisten(node,eventName,methodName){node=node||this;let bl=this.__boundListeners&&this.__boundListeners.get(node),key=eventName+methodName,handler=bl&&bl[key];handler&&(this._removeEventListenerFromNode(node,eventName,handler),bl[key]=null)}setScrollDirection(direction,node){setTouchAction(node||this,DIRECTION_MAP[direction]||"auto")}$$(slctr){return this.root.querySelector(slctr)}get domHost(){let root=wrap(this).getRootNode();return root instanceof DocumentFragment?root.host:root}distributeContent(){const domApi=dom(this);window.ShadyDOM&&domApi.shadowRoot&&ShadyDOM.flush()}getEffectiveChildNodes(){return dom(this).getEffectiveChildNodes()}queryDistributedElements(selector){return dom(this).queryDistributedElements(selector)}getEffectiveChildren(){return this.getEffectiveChildNodes().filter(function(n){return n.nodeType===Node.ELEMENT_NODE})}getEffectiveTextContent(){let cn=this.getEffectiveChildNodes(),tc=[];for(let c,i=0;c=cn[i];i++)c.nodeType!==Node.COMMENT_NODE&&tc.push(c.textContent);return tc.join("")}queryEffectiveChildren(selector){let e$=this.queryDistributedElements(selector);return e$&&e$[0]}queryAllEffectiveChildren(selector){return this.queryDistributedElements(selector)}getContentChildNodes(slctr){let content=this.root.querySelector(slctr||"slot");return content?dom(content).getDistributedNodes():[]}getContentChildren(slctr){return this.getContentChildNodes(slctr).filter(function(n){return n.nodeType===Node.ELEMENT_NODE})}isLightDescendant(node){return this!==node&&wrap(this).contains(node)&&wrap(this).getRootNode()===wrap(node).getRootNode()}isLocalDescendant(node){return this.root===wrap(node).getRootNode()}scopeSubtree(container,shouldObserve=!1){return scopeSubtree(container,shouldObserve)}getComputedStyleValue(property){return styleInterface.getComputedStyleValue(this,property)}debounce(jobName,callback,wait){return this._debouncers=this._debouncers||{},this._debouncers[jobName]=Debouncer.debounce(this._debouncers[jobName],wait>0?timeOut.after(wait):microTask,callback.bind(this))}isDebouncerActive(jobName){this._debouncers=this._debouncers||{};let debouncer=this._debouncers[jobName];return!(!debouncer||!debouncer.isActive())}flushDebouncer(jobName){this._debouncers=this._debouncers||{};let debouncer=this._debouncers[jobName];debouncer&&debouncer.flush()}cancelDebouncer(jobName){this._debouncers=this._debouncers||{};let debouncer=this._debouncers[jobName];debouncer&&debouncer.cancel()}async(callback,waitTime){return waitTime>0?timeOut.run(callback.bind(this),waitTime):~microTask.run(callback.bind(this))}cancelAsync(handle){handle<0?microTask.cancel(~handle):timeOut.cancel(handle)}create(tag,props){let elt=document.createElement(tag);if(props)if(elt.setProperties)elt.setProperties(props);else for(let n in props)elt[n]=props[n];return elt}elementMatches(selector,node){return matchesSelector(node||this,selector)}toggleAttribute(name,bool){let node=this;return 3===arguments.length&&(node=arguments[2]),1==arguments.length&&(bool=!node.hasAttribute(name)),bool?(wrap(node).setAttribute(name,""),!0):(wrap(node).removeAttribute(name),!1)}toggleClass(name,bool,node){node=node||this,1==arguments.length&&(bool=!node.classList.contains(name)),bool?node.classList.add(name):node.classList.remove(name)}transform(transformText,node){(node=node||this).style.webkitTransform=transformText,node.style.transform=transformText}translate3d(x,y,z,node){node=node||this,this.transform("translate3d("+x+","+y+","+z+")",node)}arrayDelete(arrayOrPath,item){let index;if(Array.isArray(arrayOrPath)){if((index=arrayOrPath.indexOf(item))>=0)return arrayOrPath.splice(index,1)}else{if((index=get(this,arrayOrPath).indexOf(item))>=0)return this.splice(arrayOrPath,index,1)}return null}_logger(level,args){switch(Array.isArray(args)&&1===args.length&&Array.isArray(args[0])&&(args=args[0]),level){case"log":case"warn":case"error":console[level](...args)}}_log(...args){this._logger("log",args)}_warn(...args){this._logger("warn",args)}_error(...args){this._logger("error",args)}_logf(methodName,...args){return["[%s::%s]",this.is,methodName,...args]}}return LegacyElement.prototype.is="",LegacyElement});