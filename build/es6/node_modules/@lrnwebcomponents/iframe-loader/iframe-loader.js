import{LitElement as e,html as t,css as i}from"../../lit-element/lit-element.js";import{FlattenedNodesObserver as o}from"../../@polymer/polymer/lib/utils/flattened-nodes-observer.js";customElements.define("iframe-loader",class IframeLoader extends e{static get properties(){return{loading:{type:Boolean},__iframeHeight:{type:Number}}}static get styles(){return i`
      :host {
        display: block;
      }
      #container {
        position: relative;
        overflow: hidden;
        transition: height 0.4s ease-in-out;
      }
      #loading-screen {
        position: absolute;
        display: flex;
        justify-content: center;
        align-items: center;
        top: 50%;
      }
      .loaded#container {
        height: auto;
        overflow: visible;
      }
      .loaded #loading-screen {
        display: none;
      }
      #slot {
        transition: opacity 1s ease-in-out;
      }
    `}constructor(){super(),this.loading=!0,this.__iframeHeight=100,this.__iframe=null,this.__mutationObserver=new MutationObserver(e=>{e.forEach(e=>{e.target.offsetHeight&&this.loading&&e.target.offsetHeight>100&&(this.loading=!1,this.__iframeHeight=e.target.offsetHeight+25)})})}connectedCallback(){super.connectedCallback()}disconnectedCallback(){super.disconnectedCallback()}firstUpdated(){this.__observer=new o(this.shadowRoot.querySelector("slot"),e=>{e.addedNodes.length>0&&e.addedNodes.forEach(e=>{let t=null;if("IFRAME"===e.nodeName)t=e;else if(e.querySelector){const i=e.querySelector("iframe");i&&(t=i)}t&&(this.__iframe=t,t.loading="lazy",this.__mutationObserver.observe(this.__iframe,{attributes:!0}))})})}updated(e){e.forEach((e,t)=>{"loading"===t&&!1===this.loading&&this.__observer&&this.__observer.disconnect()})}render(){return t`
      <div
        id="container"
        class="${this.loading?"loading":"loaded"}"
        style="height: ${this.__iframeHeight}px;"
      >
        <div id="loading-screen">
          <loading-indicator></loading-indicator>
        </div>
        <div
          id="slot"
          style="height: ${this.__iframeHeight}px; opacity: ${this.loading?"0":"1"}"
        >
          <slot></slot>
        </div>
      </div>
    `}});