/**
 * Copyright 2019 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
import{LitElement as t,html as a,css as e}from"../../lit-element/lit-element.js";import"../responsive-utility/responsive-utility.js";import"../../@polymer/paper-button/paper-button.js";import"../../@polymer/iron-icons/iron-icons.js";import"../simple-tooltip/simple-tooltip.js";import"./lib/a11y-tab.js";class A11yTabs extends t{static get styles(){return[e`
        :host {
          display: block;
          height: var(--a11y-tabs-height);
          overflow: var(--a11y-tabs-overflow);
          font-size: var(--a11y-tabs-font-size, unset);
          font-family: var(--a11y-tabs-font-family, unset);
          --a11y-tabs-width: 100%;
          --a11y-tabs-background: white;
          --a11y-tabs-border-color: #ddd;
          --a11y-tabs-color: #000;
          --a11y-tabs-faded-color: #222;
          --a11y-tabs-focus-color: var(-a11y-tabs-color);
          --a11y-tabs-faded-background: #eee;
          --a11y-tabs-disabled-color: #999;
          --a11y-tabs-border-radius: 2px;
          --a11y-tabs-horizontal-border-radius: var(--a11y-tabs-border-radius);
          --a11y-tabs-vertical-border-radius: var(--a11y-tabs-border-radius);
          --a11y-tabs-content-background: var(--a11y-tabs-background);
          --a11y-tabs-content-padding: 16px;
          --a11y-tabs-button-padding: 8px;
          --a11y-tabs-vertical-button-padding: var(
            --a11y-tabs-button-padding,
            8px
          );
          --a11y-tabs-horizontal-border-radius: unset;
          --a11y-tabs-vertical-border-radius: unset;
          --a11y-tabs-horizontal-button-padding: var(
            --a11y-tabs-button-padding,
            8px
          );
          --a11y-tabs-width: auto;
        }

        :host([vertical]) {
          border: 1px solid var(--a11y-tabs-border-color);
          border-radius: var(--a11y-tabs-vertical-border-radius);
          display: flex;
          justify-content: space-between;
          align-items: stretch;
        }

        :host([hidden]) {
          display: none;
        }

        :host #tabs {
          align-items: stretch;
          flex-wrap: var(--a11y-tabs-wrap, unset);
          margin: 0;
          display: flex;
          list-style: none;
          padding: 0;
          overflow: auto;
          font-family: var(
            --a11y-tabs-tab-font-family,
            var(--a11y-tabs-font-family, unset)
          );
          font-size: var(
            --a11y-tabs-tab-font-size,
            var(--a11y-tabs-font-size, unset)
          );
        }

        :host([vertical]) #tabs {
          border-left: none;
          flex: 0 0 auto;
          flex-direction: column;
          overflow-y: auto;
          background-color: var(--a11y-tabs-vertical-background);
          justify-content: var(--a11y-tabs-vertical-justify-tabs);
          flex-wrap: var(--a11y-tabs-vertical-wrap);
        }

        :host(:not([vertical])) #tabs {
          z-index: 1;
          max-width: 100%;
          overflow-x: auto;
          background-color: var(--a11y-tabs-horizontal-background);
          justify-content: var(--a11y-tabs-horizontal-justify-tabs);
        }

        :host([sticky]) #tabs {
          position: sticky;
        }

        :host([sticky][vertical]) #tabs {
          left: 0;
        }

        :host([sticky]:not([vertical])) #tabs {
          top: 0;
          background-color: var(--a11y-tabs-horizontal-sticky-background);
        }

        :host #tabs li {
          display: flex;
          align-items: stretch;
        }

        :host([vertical]) #tabs li {
          flex-direction: column;
        }

        :host #tabs .flag-type {
          position: absolute;
          left: -99999px;
          height: 0;
          overflow: hidden;
        }

        :host #content {
          padding: var(--a11y-tabs-content-padding);
          background-color: var(--a11y-tabs-content-background);
          border: 1px solid var(--a11y-tabs-border-color);
          flex: 1 1 calc(100% - 2 * var(--a11y-tabs-content-padding));
          overflow: auto;
        }

        :host([vertical]) #content {
          border: none;
        }

        :host(:not([vertical])) #content {
          border-radius: var(--a11y-tabs-horizontal-border-radius);
          margin-top: -1px;
        }

        :host #tabs paper-button {
          margin: 0;
          text-transform: unset;
          color: var(--a11y-tabs-faded-color);
          border: 1px solid var(--a11y-tabs-border-color);
          padding: var(--a11y-tabs-button-padding);
        }

        :host([vertical]) #tabs paper-button {
          border-top: none;
          border-left: none;
          border-radius: 0;
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: var(--a11y-tabs-vertical-button-padding);
          color: var(--a11y-tabs-color);
          background-color: var(--a11y-tabs-background);
        }

        :host(:not([vertical])) #tabs paper-button {
          border-radius: var(--a11y-tabs-horizontal-border-radius)
            var(--a11y-tabs-horizontal-border-radius) 0 0;
          padding: var(--a11y-tabs-horizontal-button-padding);
        }

        :host(:not([vertical])) #tabs paper-button.active {
          border-bottom: none;
        }

        :host(:not([vertical])) #tabs li:not(:first-of-type) paper-button {
          border-left: none;
        }

        :host #tabs paper-button:active,
        :host #tabs paper-button:focus,
        :host #tabs paper-button:hover {
          color: var(--a11y-tabs-focus-color);
        }

        :host #tabs paper-button.active[disabled] {
          color: var(--a11y-tabs-focus-color);
          background-color: var(--a11y-tabs-background);
        }

        :host #tabs paper-button:not(.active)[disabled] {
          color: var(--a11y-tabs-disabled-color);
          background-color: var(--a11y-tabs-faded-background);
          cursor: not-allowed;
        }

        :host #tabs span.label,
        :host #tabs .flag-icon {
          margin-right: 8px;
        }

        :host #tabs.icons-only paper-button {
          justify-content: center;
        }

        :host #tabs.icons-only span.label {
          display: none;
        }

        :host #tabs:not(.icons-only) simple-tooltip {
          display: none;
        }
      `]}render(){return a`
      <ul id="tabs" .class="${this.iconClass}">
        ${this.tabs.map((t,e)=>a`
            <li>${this._tabButton(t)}</li>
          `)}
      </ul>
      <div id="content">
        <slot></slot>
      </div>
    `}static get haxProperties(){return{}}static get properties(){return{...super.properties,activeTab:{type:String,reflect:!0,attribute:"active-tab"},disabled:{type:Boolean,reflect:!0},hidden:{type:Boolean,reflect:!0},iconBreakpoint:{type:Number,attribute:"icon-breakpoint"},id:{type:String,reflect:!0},layoutBreakpoint:{type:Number,attribute:"layout-breakpoint"},responsiveSize:{type:String,reflect:!0,attribute:"responsive-size"},sticky:{type:Boolean,reflect:!0,attribute:"sticky"},vertical:{type:Boolean,reflect:!0,attribute:"vertical"},__tabs:{type:Array}}}static get tag(){return"a11y-tabs"}constructor(){super(),this.disabled=!1,this.hidden=!1,this.iconBreakpoint=400,this.layoutBreakpoint=600,this.responsiveSize="xs",this.vertical=!1,this.__tabs=[],window.ResponsiveUtility.requestAvailability()}get observer(){return new MutationObserver(()=>this.updateTabs())}get tabQuery(){return"a11y-tab"}get tabs(){return this.__tabs?Object.keys(this.__tabs).map(t=>this.__tabs[t]):[]}get iconClass(){let t=!this.vertical&&this.responsiveSize.indexOf("s")>-1,a=this.vertical&&"xs"===this.responsiveSize,e=this.iconBreakpoint>this.layoutBreakpoint&&"sm"===this.responsiveSize;return this.hasIcons&&(t||a||e)?"icons-only":"label-and-icons"}get hasIcons(){let t=!0;return this.id||(this.id=this._generateUUID()),this.__tabs&&this.__tabs.length>0&&this.__tabs.forEach((a,e)=>{a.icon||(t=!1),a.order=e+1,a.total=this.__tabs.length}),t}connectedCallback(){super.connectedCallback(),this.updateTabs(),this._breakpointChanged(),this.observer.observe(this,{attributes:!1,childList:!0,subtree:!1}),this.addEventListener("a11y-tab-changed",t=>this.updateTabs())}disconnectedCallback(){this.observer&&this.observer.disconnect&&this.observer.disconnect(),this.removeEventListener("a11y-tab-changed",t=>this.updateTabs()),this._unsetBreakpoints(),super.disconnectedCallback()}updated(t){t.forEach((t,a)=>{"id"===a&&this._idChanged(this.id,t),"activeTab"===a&&this.activeTab!==t&&this._activeTabChanged(this.activeTab,t),"iconBreakpoint"===a&&this._breakpointChanged(),"layoutBreakpoint"===a&&this._breakpointChanged(),"responsiveSize"===a&&this._setVertical()})}selectTab(t){let a=this.querySelectorAll(this.tabQuery);if(a&&a.length>0){let e=Object.keys(a||[]).filter(t=>!a[t].disabled).map(t=>a[t].id),s=e.filter(a=>a===t)[0]||e[0];a.forEach(t=>{t.hidden=t.id!==s}),this.activeTab=s}}updateTabs(t){this.__tabs=this.querySelectorAll(this.tabQuery),this.selectTab(this.activeTab)}_activeTabChanged(t,a){t!==a&&this.selectTab(t),window.dispatchEvent(new CustomEvent("active-tab-changed",{bubbles:!0,cancelable:!0,composed:!0,detail:this}))}_breakpointChanged(){this._unsetBreakpoints(),this._setBreakpoints(),this._setVertical()}_generateUUID(){return"ss-s-s-s-sss".replace(/s/g,Math.floor(65536*(1+Math.random())).toString(16).substring(1))}_handleTab(t){t.disabled||(this.activeTab=t.id)}_idChanged(t,a){t||(this.id="a11y-tabs"+this._generateUUID())}_setBreakpoints(){let t=this.layoutBreakpoint>-1?this.layoutBreakpoint:0,a=this.iconBreakpoint>-1?this.iconBreakpoint:0,e=a>t?t:a,s=a>t?a:t,i=Math.max(a,t)+1,o=Math.max(a,t)+2;window.dispatchEvent(new CustomEvent("responsive-element",{detail:{element:this,attribute:"responsive-size",relativeToParent:!0,sm:e,md:s,lg:i,xl:o}}))}_setVertical(){this.vertical=-1===this.layoutBreakpoint||(this.iconBreakpoint>this.layoutBreakpoint?"xs"===this.responsiveSize:this.responsiveSize.indexOf("s")>-1)}_tabButton(t){return a`
      <paper-button
        id="${t.id}-button"
        controls="${t.id}"
        class="${t.id===this.activeTab?"active":""}"
        @click="${a=>this._handleTab(t)}"
        ?disabled="${t.id===this.activeTab||t.disabled}"
        .flag="${t.flag}"
      >
        ${this._tabIcon(t,"flagIcon")} ${this._tabLabel(t)}
        ${this._tabFlag(t)} ${this._tabIcon(t,"icon")}
      </paper-button>
      ${this._tabTooltip(t)}
    `}_tabFlag(t){return a`
      <span class="flag-type" ?hidden="${!t.flag}">
        ${t.flag}
      </span>
    `}_tabIcon(t,e){return a`
      <iron-icon
        class="icon"
        ?hidden="${!t[e]}"
        .icon="${t[e]}"
      ></iron-icon>
    `}_tabLabel(t){return a`
      <span class="label">${t.label}</span>
    `}_tabTooltip(t){return a`
      <simple-tooltip for="${t.id}-button">
        ${t.label}
      </simple-tooltip>
    `}_unsetBreakpoints(){window.dispatchEvent(new CustomEvent("responsive-element-deleted",{bubbles:!0,cancelable:!0,composed:!0,detail:this}))}}window.customElements.define(A11yTabs.tag,A11yTabs);export{A11yTabs};