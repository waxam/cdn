import{html,PolymerElement}from"../../../@polymer/polymer/polymer-element.js";import{afterNextRender}from"../../../@polymer/polymer/lib/utils/render-status.js";import"../../simple-colors/simple-colors.js";import"./hax-shared-styles.js";class HaxTextContext extends PolymerElement{constructor(){super(),import("../../../@polymer/paper-item/paper-item.js"),import("../../../@polymer/iron-icons/iron-icons.js"),import("../../../@polymer/iron-icon/iron-icon.js"),import("../../md-extra-icons/md-extra-icons.js"),import("./hax-context-item-menu.js"),import("./hax-context-item.js"),import("./hax-context-item-textop.js"),import("./hax-toolbar.js"),this.addEventListener("hax-context-item-selected",this._haxContextOperation.bind(this))}static get template(){return html`
      <style include="hax-shared-styles">
        :host {
          display: block;
          pointer-events: none;
          background-color: white;
        }
        :host [hidden] {
          display: none;
        }
        paper-item {
          -webkit-justify-content: flex-start;
          justify-content: flex-start;
          height: 36px;
          padding: 0 8px;
          min-height: 36px;
        }
        paper-item:hover {
          background-color: #d3d3d3;
          cursor: pointer;
        }
        iron-icon {
          padding: 8px;
        }
        paper-item strong {
          padding: 8px;
          font-size: 12px;
        }
        :host(.hax-context-pin-top) hax-toolbar {
          position: fixed;
          top: 64px;
          opacity: 0.95;
        }
        :host(.hax-context-pin-bottom) hax-toolbar {
          position: fixed;
          bottom: 0;
          opacity: 0.95;
        }
      </style>
      <hax-toolbar selected="[[selection]]" hide-transform="" id="toolbar">
        <hax-context-item-menu
          slot="primary"
          selected-value="{{selectedValue}}"
          id="formatsize"
          icon="text-format"
          label="Format"
          event-name="text-tag"
        >
          <paper-item value="p"
            ><iron-icon icon="editor:format-textdirection-l-to-r"></iron-icon
            >Normal text <strong>&lt;P&gt;</strong></paper-item
          >
          <paper-item value="ul"
            ><iron-icon icon="editor:format-list-bulleted"></iron-icon>Bulleted
            list <strong>&lt;UL&gt;</strong></paper-item
          >
          <paper-item value="ol"
            ><iron-icon icon="editor:format-list-numbered"></iron-icon>Numbered
            list <strong>&lt;OL&gt;</strong></paper-item
          >
          <paper-item value="h2"
            ><iron-icon icon="editor:title"></iron-icon>Title
            <strong>&lt;H2&gt;</strong></paper-item
          >
          <paper-item value="h3"
            ><iron-icon icon="editor:title"></iron-icon>Content heading
            <strong>&lt;H3&gt;</strong></paper-item
          >
          <paper-item value="h4"
            ><iron-icon icon="editor:text-fields"></iron-icon>Subheading
            <strong>&lt;H4&gt;</strong></paper-item
          >
          <paper-item value="h5"
            ><iron-icon icon="editor:text-fields"></iron-icon>Deeper subheading
            <strong>&lt;H5&gt;</strong></paper-item
          >
          <paper-item value="blockquote"
            ><iron-icon icon="editor:format-quote"></iron-icon>Quote<strong
              >&lt;blockquote&gt;</strong
            ></paper-item
          >
          <paper-item value="code"
            ><iron-icon icon="icons:code"></iron-icon>Code block<strong
              >&lt;code&gt;</strong
            ></paper-item
          >
        </hax-context-item-menu>
        <hax-context-item-textop
          slot="primary"
          icon="editor:format-bold"
          label="Bold"
          event-name="text-bold"
        ></hax-context-item-textop>
        <hax-context-item-textop
          slot="primary"
          icon="editor:format-italic"
          label="Italic"
          event-name="text-italic"
        ></hax-context-item-textop>
        <hax-context-item-textop
          slot="primary"
          icon="editor:insert-link"
          label="Link"
          event-name="text-link"
        ></hax-context-item-textop>
        <hax-context-item-textop
          slot="primary"
          icon="editor:format-list-bulleted"
          event-name="text-list-bulleted"
          label="Bulleted list"
          hidden$="[[!_showIndent]]"
        ></hax-context-item-textop>
        <hax-context-item-textop
          slot="primary"
          icon="editor:format-list-numbered"
          label="Numbered list"
          event-name="text-list-numbered"
          hidden\$="[[!_showIndent]]"
        ></hax-context-item-textop>
        <hax-context-item-textop
          slot="primary"
          icon="editor:format-indent-decrease"
          label="Outdent"
          event-name="text-outdent"
          hidden$="[[!_showIndent]]"
        ></hax-context-item-textop>
        <hax-context-item-textop
          slot="primary"
          icon="editor:format-indent-increase"
          label="Indent"
          event-name="text-indent"
          hidden$="[[!_showIndent]]"
        ></hax-context-item-textop>
        <hax-context-item-textop
          slot="primary"
          icon="editor:format-clear"
          label="Remove format"
          event-name="text-remove-format"
        ></hax-context-item-textop>
        <hax-context-item
          slot="primary"
          icon="device:graphic-eq"
          label="Advanced item"
          event-name="insert-inline-gizmo"
          hidden$="[[isSafari]]"
        ></hax-context-item>
        <hax-context-item-textop
          slot="primary"
          icon="device:graphic-eq"
          label="Advanced item"
          event-name="insert-inline-gizmo"
          hidden$="[[!isSafari]]"
        ></hax-context-item-textop>

        <hax-context-item-textop
          menu
          slot="more"
          icon="mdextra:unlink"
          event-name="text-unlink"
          >Remove link</hax-context-item-textop
        >
        <hax-context-item-textop
          menu
          slot="more"
          icon="mdextra:subscript"
          event-name="text-subscript"
          >Subscript</hax-context-item-textop
        >
        <hax-context-item-textop
          menu
          slot="more"
          icon="mdextra:superscript"
          event-name="text-superscript"
          >Superscript</hax-context-item-textop
        >
        <hax-context-item-textop
          menu
          slot="more"
          icon="editor:format-underlined"
          event-name="text-underline"
          >Underline</hax-context-item-textop
        >
        <hax-context-item-textop
          menu
          slot="more"
          icon="editor:format-strikethrough"
          event-name="text-strikethrough"
          >Cross out</hax-context-item-textop
        >
      </hax-toolbar>
    `}static get tag(){return"hax-text-context"}static get properties(){return{_showIndent:{type:Boolean,computed:"_computeShowIndent(selectedValue, polyfillSafe)"},polyfillSafe:{type:Boolean},selectedValue:{type:String,value:"p",notify:!0},selection:{type:Boolean,value:!1},isSafari:{type:Boolean,notify:!0,computed:"_isSafari()"}}}_computeShowIndent(selectedValue,polyfillSafe){return!(!polyfillSafe||"ol"!==selectedValue&&"ul"!==selectedValue)}ready(){super.ready()}connectedCallback(){super.connectedCallback(),afterNextRender(this,function(){this.polyfillSafe=window.HaxStore.instance.computePolyfillSafe()})}disconnectedCallback(){super.disconnectedCallback()}_haxContextOperation(e){let detail=e.detail,selection=window.HaxStore.getSelection();switch(detail.eventName){case"close-menu":setTimeout(()=>{this.shadowRoot.querySelector("#formatsize").shadowRoot.querySelector("#menu").hideMenu()},200);break;case"insert-inline-gizmo":if(window.HaxStore._tmpSelection&&window.HaxStore.instance.editMode){var localRange=!1;try{"HAX-BODY"!==window.HaxStore._tmpRange.startContainer.parentNode.parentNode.tagName&&"HAX-BODY"!==window.HaxStore._tmpRange.startContainer.parentNode.parentNode.parentNode.tagName||(window.HaxStore.write("activePlaceHolder",window.HaxStore._tmpRange,this),localRange=window.HaxStore._tmpRange)}catch(err){}}if(localRange||null!=window.HaxStore.instance.activePlaceHolder){let values={text:window.HaxStore.instance.activePlaceHolder.toString()},type="inline",haxElements=window.HaxStore.guessGizmo(type,values);haxElements.length>0&&window.HaxStore.instance.haxAppPicker.presentOptions(haxElements,type,"Transform selected text to..","gizmo")}break;case"text-bold":document.execCommand("bold"),e.preventDefault(),e.stopPropagation();break;case"text-italic":document.execCommand("italic"),e.preventDefault(),e.stopPropagation();break;case"text-underline":document.execCommand("underline"),e.preventDefault(),e.stopPropagation(),this.shadowRoot.querySelector("#toolbar").shadowRoot.querySelector("#moremenu").shadowRoot.querySelector("#menu").hideMenu();break;case"text-subscript":document.execCommand("subscript"),e.preventDefault(),e.stopPropagation(),this.shadowRoot.querySelector("#toolbar").shadowRoot.querySelector("#moremenu").shadowRoot.querySelector("#menu").hideMenu();break;case"text-superscript":document.execCommand("superscript"),e.preventDefault(),e.stopPropagation(),this.shadowRoot.querySelector("#toolbar").shadowRoot.querySelector("#moremenu").shadowRoot.querySelector("#menu").hideMenu();break;case"text-remove-format":document.execCommand("removeFormat"),e.preventDefault(),e.stopPropagation();break;case"text-strikethrough":document.execCommand("strikeThrough"),e.preventDefault(),e.stopPropagation(),this.shadowRoot.querySelector("#toolbar").shadowRoot.querySelector("#moremenu").shadowRoot.querySelector("#menu").hideMenu();break;case"text-link":var href="";void 0!==selection.focusNode.parentNode.href&&(href=selection.focusNode.parentNode.href);let url=prompt("Enter a URL:",href);url&&(document.execCommand("createLink",!1,url),e.preventDefault(),e.stopPropagation());break;case"text-unlink":document.execCommand("unlink"),e.preventDefault(),e.stopPropagation();break;case"text-indent":document.execCommand("indent"),e.preventDefault(),e.stopPropagation();break;case"text-outdent":document.execCommand("outdent"),e.preventDefault(),e.stopPropagation();break;case"text-list-numbered":try{document.execCommand("insertOrderedList"),e.preventDefault(),e.stopPropagation()}catch(e){}break;case"text-list-bulleted":try{document.execCommand("insertUnorderedList"),e.preventDefault(),e.stopPropagation()}catch(e){}}}_isSafari(){let ua=navigator.userAgent.toLowerCase();return!(-1==ua.indexOf("safari")||ua.indexOf("chrome")>-1)}}window.customElements.define(HaxTextContext.tag,HaxTextContext);export{HaxTextContext};