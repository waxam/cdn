import{LitElement as e,html as t,css as s}from"../../../lit-element/lit-element.js";import{HAXElement as o,HAXWiring as r}from"../../hax-body-behaviors/hax-body-behaviors.js";import{varGet as i}from"../../utils/utils.js";class HaxAutoloader extends(o(e)){static get styles(){return[s`
        :host {
          display: none;
        }
      `]}render(){return t`
      <slot></slot>
    `}static get tag(){return"hax-autoloader"}pathFromUrl(e){return e.substring(0,e.lastIndexOf("/")+1)}static get properties(){return{...super.properties,processedList:{type:Object}}}constructor(){super(),this.processedList={}}firstUpdated(e){this.dispatchEvent(new CustomEvent("hax-register-core-piece",{bubbles:!0,cancelable:!0,composed:!0,detail:{piece:"haxAutoloader",object:this}}))}connectedCallback(){super.connectedCallback(),this.observer=new MutationObserver(e=>{e.forEach(e=>{e.addedNodes.forEach(e=>{this.processNewElements(e)})})}),this.observer.observe(this,{childList:!0})}disconnectedCallback(){this.observer.disconnect(),super.disconnectedCallback()}processNewElements(e){let t=this.childNodes;for(var s=0;s<t.length;s++){if(void 0!==t[s].tagName&&void 0===this.processedList[t[s].tagName])try{let a=t[s].tagName.toLowerCase();if("function"==typeof t[s].getHaxProperties){const e=new CustomEvent("hax-register-properties",{bubbles:!0,composed:!0,cancelable:!0,detail:{tag:a,properties:t[s].getHaxProperties(),polymer:!0}});context.dispatchEvent(e)}else if("function"==typeof t[s].HAXWiring){const e=new CustomEvent("hax-register-properties",{bubbles:!0,cancelable:!0,composed:!0,detail:{tag:a,properties:t[s].HAXWiring.getHaxProperties(),polymer:!1}});context.dispatchEvent(e)}else{const t=this.pathFromUrl(decodeURIComponent(import.meta.url));if(window.customElements.get(a)){let t=window.customElements.get(a);if(t)if("function"==typeof t.getHaxProperties)this.setHaxProperties(t.getHaxProperties(),a);else if("function"==typeof t.HAXWiring)this.setHaxProperties(t.HAXWiring.getHaxProperties(),a);else if(t.haxProperties)this.setHaxProperties(t.haxProperties,a);else{console.warn(`${a} didn't have hax wiring so HAX guessed how to work with it as best it can. See https://haxtheweb.org/hax-schema for documentation on adding custom wiring for better UX.`);try{let e,t=new r,s=t.prototypeHaxProperties();if(s.gizmo.title=a,s.gizmo.handles=[],s.settings.quick=[],s.settings.configure=[],s.settings.advanced=[],s=t.standardAdvancedProps(s),s.saveOptions={},customElements.get(a)&&(e=customElements.get(a).properties),e)for(var o in e)if(e[o].type&&e[o].type.name)switch(e[o].type.name){case"String":s.settings.configure.push({property:o,title:o,description:"",inputMethod:"textfield"});break;case"Number":s.settings.configure.push({property:o,title:o,description:"",inputMethod:"number"});break;case"Boolean":s.settings.configure.push({property:o,title:o,description:"",inputMethod:"boolean"})}t.readyToFireHAXSchema(a,s,this)}catch(e){console.warn("HAX failed to create wiring that worked")}}else console.error(`${a} was not a valid custom element yet a load was attempted`)}else{let e=i(window.HaxStore,"instance.__appStoreData.autoloader."+a,`@lrnwebcomponents/${a}/${a}.js`);import(`${t}../../../${e}`).then(e=>{let t=window.customElements.get(a);t?"function"==typeof t.getHaxProperties?this.setHaxProperties(t.getHaxProperties(),a):"function"==typeof t.HAXWiring?this.setHaxProperties(t.HAXWiring.getHaxProperties(),a):t.haxProperties?this.setHaxProperties(t.haxProperties,a):console.warn(`${a} didn't have hax wiring in the end`):console.error(`${a} was not a valid custom element yet a load was attempted`)}).catch(e=>{console.warn(e)})}}this.processedList[a]=a}catch(e){}t[s].remove()}}}window.customElements.define(HaxAutoloader.tag,HaxAutoloader);export{HaxAutoloader};