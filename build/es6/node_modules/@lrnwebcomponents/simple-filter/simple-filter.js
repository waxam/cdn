/**
 * Copyright 2020 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
import{LitElement as e}from"../../lit/index.js";export const SimpleFilterMixin=function(e){return class extends e{constructor(){super(),this.caseSensitive=!1,this.filtered=[],this.resetList()}resetList(e=[]){this.items=[...e],this.where="title",this.value="",this.like=""}static get properties(){return{...super.properties,items:{type:Array},like:{type:String},where:{type:String},caseSensitive:{type:Boolean,attribute:"case-sensitive",reflect:!0},filtered:{type:Array}}}update(e){super.update(e),e.forEach(((e,t)=>{["items","where","like","caseSensitive"].includes(t)&&this.shadowRoot&&(clearTimeout(this.__debounce),this.__debounce=setTimeout((()=>{this.filtered=this._computeFiltered(this.items,this.where,this.like,this.caseSensitive)}),0)),"filtered"==t&&this.shadowRoot&&(this.dispatchEvent(new CustomEvent("filter",{bubbles:!0,cancelable:!0,composed:!0,detail:!0})),this.dispatchEvent(new CustomEvent("filtered-changed",{bubbles:!0,cancelable:!0,composed:!0,detail:{value:this.filtered}})))}))}filter(){this.where=""}_computeFiltered(e,t,i,s){"\\"!==i[0]&&"\\"!==i||(i="\\"+i);var r=null;r=s?new RegExp(i):new RegExp(i,"i");var n=this._decomposeWhere.bind(this);return e.filter((function(e){if("object"==typeof e){var i=n(t,e);return void 0===i&&""!=t&&console.warn("grafitto-filter was unable to find a property in '"+t+"'"),r.test(i)}return"string"==typeof e?r.test(e):"number"==typeof e?r.test(e.toString()):void 0}))}_decomposeWhere(e,t){return e.split(".").reduce((function(e,t){return e&&e[t]}),t)}}};class SimpleFilter extends(SimpleFilterMixin(e)){constructor(){super()}static get tag(){return"simple-filter"}}export{SimpleFilter};