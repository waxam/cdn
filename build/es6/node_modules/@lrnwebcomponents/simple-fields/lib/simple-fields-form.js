import{LitElement as e,html as t,css as s}from"../../../lit-element/lit-element.js";import"../simple-fields.js";class SimpleFieldsForm extends e{static get styles(){return[s`
        :host {
          display: block;
        }
      `]}static get tag(){return"simple-fields-form"}render(){return t`
      <form><simple-fields id="fields" autofocus></simple-fields></form>
    `}firstUpdated(e){e.forEach((e,t)=>{"loadEndpoint"===t&&this.autoload&&this.loadData()})}updated(e){e.forEach((e,t)=>{!this.autoload||this.loadResponse||this.loading||"loadEndpoint"!==t&&"autoload"!==t||this.loadData(),"loadResponse"===t&&(this.shadowRoot.querySelector("#fields").fields=this.loadResponse.data.fields,this.shadowRoot.querySelector("#fields").value=this.loadResponse.data.value,this.dispatchEvent(new CustomEvent("response",{bubbles:!0,composed:!0,cancelable:!1,detail:this.loadResponse.data})))})}loadData(){this.loading=!0,this.fetchData(this.loadEndpoint,this.method,this.headers,this.body).then(e=>{this.loading=!1,this.loadResponse=e,this.dispatchEvent(new CustomEvent("simple-fields-form-data-loaded",{detail:{value:e}}))})}async fetchData(e,t,s,o){let i={};return i="GET"==t?await fetch(e,{method:t,headers:s}):await fetch(e,{method:t,headers:s,body:JSON.stringify(o)}),await i.json()}constructor(){super(),this.method="POST",this.loading=!1,this.autoload=!1,this.headers={Accept:"application/json","Content-Type":"application/json"},this.body={}}submit(){return this.saveEndpoint&&fetch(this.saveEndpoint,{method:this.method,headers:this.headers,body:JSON.stringify(this.shadowRoot.querySelector("#fields").value)}),this.shadowRoot.querySelector("#fields").value}static get properties(){return{autoload:{type:Boolean,reflect:!0},loading:{type:Boolean,reflect:!0},loadEndpoint:{type:String,attribute:"load-endpoint"},saveEndpoint:{type:String,attribute:"save-endpoint"},method:{type:String},headers:{type:Object},body:{type:Object},loadResponse:{type:Object}}}}window.customElements.define(SimpleFieldsForm.tag,SimpleFieldsForm);export{SimpleFieldsForm};