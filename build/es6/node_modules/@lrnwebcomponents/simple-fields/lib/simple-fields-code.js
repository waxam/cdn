import{LitElement as e,html as t,css as i}from"../../../lit-element/lit-element.js";import{SimpleFieldsContainer as s}from"./simple-fields-container.js";import"../../code-editor/code-editor.js";class SimpleFieldsCode extends s{static get tag(){return"simple-fields-code"}static get styles(){return[...super.styles,i`
        #options {
          display: var(--simple-fields-radio-option-display, flex);
          flex-wrap: var(--simple-fields-radio-option-flex-wrap, wrap);
        }
        code-editor {
          margin: 0;
          transition: height 0.5s ease-in-out;
          box-sizing: border-box;
          vertical-align: bottom;
        }
        code-editor:focus {
          outline: none;
        }
      `]}render(){return this.hasFieldSet?this.fieldsetTemplate:super.render()}static get properties(){return{...super.properties,autofocus:{type:Boolean},editorValue:{type:String,attribute:"editor-value"},fontSize:{type:Number,attribute:"font-size"},language:{type:String},mode:{type:Number},readonly:{type:Boolean,reflect:!0},requiredMessage:{type:String},theme:{type:Number},value:{reflect:!0}}}constructor(){super(),this.autofocus=!1,this.fontSize=14,this.id=this._generateUUID(),this.language="html",this.mode="html",this.readonly=!1,this.theme="vs"}disconnectedCallback(){this.removeEventListener("click",e=>this.focus()),super.disconnectedCallback()}updated(e){e.forEach((e,t)=>{"id"!==t||this.id||(this.id=this._generateUUID()),"field"!==t||this.field||this._updateField(),"value"===t&&this._fireValueChanged()})}get fieldMainTemplate(){return t`
      <div class="field-main">
        <code-editor
          ?autofocus="${this.autofocus}"
          ?disabled="${this.disabled}"
          font-size="${this.fontSize}"
          editor-value="${this.__editorValue||""}"
          theme="${this.theme}"
          language="${this.language}"
          mode="${this.mode}"
          ?read-only="${this.readonly||this.disabled}"
          @value-changed="${this._onChange}"
        >
        </code-editor>
        <input name="${this.id}" type="hidden" value="${this.value}" />
      </div>
    `}_onChange(e){e.path[0]&&this.value!==e.path[0].value&&(this.value=e.path[0].value)}get slottedFieldObserver(){}validate(){return!this.value&&this.required&&(this.error=!0,this.errorMessage=this.requiredMessage||"required"),!this.error}_fireValueChanged(){this.dispatchEvent(new CustomEvent("value-changed",{bubbles:!0,cancelable:!0,composed:!0,detail:this}))}_observeAndListen(e=!0){e?(this.addEventListener("click",this.focus),this.addEventListener("focusout",this._onFocusout),this.addEventListener("focusin",this._onFocusin)):(this.removeEventListener("click",this.focus),this.removeEventListener("focusout",this._onFocusout),this.removeEventListener("focusin",this._onFocusin))}_updateField(){this.field=this.shadowRoot&&this.shadowRoot.querySelector("code-editor")?this.shadowRoot.querySelector("code-editor"):void 0}_generateUUID(){return"ss-s-s-s-sss".replace(/s/g,Math.floor(65536*(1+Math.random())).toString(16).substring(1))}}window.customElements.define(SimpleFieldsCode.tag,SimpleFieldsCode);export{SimpleFieldsCode};