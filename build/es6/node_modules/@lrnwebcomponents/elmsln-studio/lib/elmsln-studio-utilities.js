/**
 * Copyright 2020 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
import{LitElement as t,html as e,css as i}from"../../../lit-element/lit-element.js";import"../../../@polymer/iron-ajax/iron-ajax.js";import"../../../@polymer/iron-icon/iron-icon.js";import"../../../@polymer/iron-icons/iron-icons.js";import"../../nav-card/nav-card.js";import"../../lrndesign-avatar/lrndesign-avatar.js";import{AccentCard as o}from"../../accent-card/accent-card.js";const ElmslnStudioUtilities=function(t){return class extends t{static get properties(){return{...super.properties,demoMode:{type:Boolean,attribute:"demo-mode",reflect:!0}}}constructor(){super(),this.demoMode=!1}get defaultModalToolbars(){return{bottom:{id:"bottom",type:"toolbar-group",contents:["prevbutton","homebutton","rotategroup","zoomgroup","pageXofY","pangroup","fullscreenbutton","nextbutton"]}}}sortDates(t,e=!1){return t.sort((t,i)=>{let o="string"==typeof t.date?Date.parse(t.date):t.date,r="string"==typeof i.date?Date.parse(i.date):i.date;return e?o-r:r-o})}addDays(t=new Date,e=0){return new Date(Date.parse(t)+864e5*e)}addWeeks(t=new Date,e=0){return new Date(Date.parse(t)+6048e5*e)}toArray(t,e){return Object.keys(t||{}).map(i=>{let o=t[i];return o.id=i,Object.keys(e||{}).forEach(t=>o[t]=e[t]),o})}_late(t){return new Date(t)<new Date}_recentArray(t){return this.sortDates(this.toArray(t))}getAncestor(t,e){if(t&&e&&e.length>0){e[0][1];let i=e[0][0],o=t[""+e[0][1]];return this.getAncestor(i[o],e.slice(1))}return t}getFigures(t,i="src",o="alt",r="full",s="longdesc"){return(t||[]).map(t=>({src:t[r]||t[i],info:t[o]&&t[s]?e`
                  <p>${t[o]}:</p>
                  <div>${t[s]}</div>
                `:t[o]?e` ${t[o]} `:e` ${t[s]} `})).filter(t=>!!t.src)}getThumnailGrid(t){return e`
        <div class="thumbnail-grid">
          ${(t.sources||[]).map((i,o)=>e`
              <img-view-modal
                class="thumbnail"
                page="${o}"
                title="${t.assignment} by ${t.firstName} ${t.lastName}"
                .toolbars="${this.defaultModalToolbars}"
                .figures="${this.getFigures(t.sources)}"
              >
                <button .style="${this.getThumbailStyle(i.src)}">
                  <span class="sr-only">${i.alt}</span>
                  <div class="zoombg"></div>
                  <iron-icon icon="zoom-in" class="zoomicon"></iron-icon>
                  <div class="imgbg"></div>
                </button>
              </img-view-modal>
            `)}
        </div>
      `}getThumbailStyle(t){return`--elmsln-studio-image-button-backgroundImage: url(${t});`}fullName(t,e=!1){return t&&!e?`${t.firstName} ${t.lastName}`:t?`${t.lastName}, ${t.firstName}`:""}dateFormat(t,e){return"string"==typeof t&&(t=new Date(t)),t?"long"===e?t.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"short"===e?t.toLocaleDateString(void 0,{month:"long",day:"numeric"}):t.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}):""}accentColor(t){let e=new o,i=e&&e.colors?Object.keys(e.colors):[""],r=t&&t.charCodeAt(0)?t.charCodeAt(0):Math.floor(16*Math.random());return i[r%16+1]?i[r%16+1]:i[Math.floor(Math.random()*i.length)]}getActivityLink(t,e=!1){return"submission"===t.activity?`/portfolios/${t.portfolioId||t.id}${t.portfolioId?"?submission="+t.id:""}${e?"":t.portfolioId?"&comment=true":"?comment=true"}`:"discussion"===t.activity?`/portfolios/${t.portfolioId||t.submissionId}${t.portfolioId?`?submission=${t.submissionId}&`:"?"}comment=${t.id}`:`/portfolios/${t.portfolioId||t.submissionId}${t.portfolioId?`?submission=${t.submissionId}&`:"?"}comment=${t.feedbackId}`}getActivityTitle(t){return e`
        ${[t.firstName,t.lastName].join(" ")}
        ${"submission"===t.activity?" submitted "+t.assignment:"discussion"===t.activity?" left feedback for "+[t.creatorFirstName,t.creatorLastName].join(" "):" replied to "+[t.reviewerFirstName,t.reviewerLastName].join(" ")}
      `}activityLink(t,e){return"submission"===e?this.submissionLink(t):"feedback"===t.activity?this.feedbackLink(t):this.replyLink(t)}activityTitle(t,e){return"submission"===e?this.submissionTitle(t):"feedback"===t.activity?this.feedbackTitle(t):this.replyTitle(t)}submissionLink(t){return`/portfolios/${t.userId}-${t.projectId}?submission=${t.id}`}submissionTitle(t){return`${t.firstName} submitted ${t.assignment}`}feedbackLink(t){return`/portfolios/${t.creator}-${t.projectId}?submission=${t.submissionId}&comment=${t.id}`}feedbackTitle(t){return`${t.firstName} left feedback on ${t.creatorFirstName}'s\n        ${t.assignment}`}replyLink(t){return`/portfolios/${t.creator}-${t.projectId}?submission=${t.submissionId}&comment=${t.id}`}replyTitle(t){return`${t.firstName} replied to ${t.feedbackFirstName}'s feedback`}_getValign(t){return t&&t.indexOf("top")>-1?"top":t&&t.indexOf("bottom")>-1?"bottom":"center"}_getAlign(t){return t&&t.indexOf("left")>-1?"left":t&&t.indexOf("right")>-1?"right":"center"}_handleLinkButton(t,e){location.href=e,this.dispatchEvent(new CustomEvent("link-button-click",{bubbles:!0,cancelable:!0,composed:!0,detail:e}))}}};export{ElmslnStudioUtilities};