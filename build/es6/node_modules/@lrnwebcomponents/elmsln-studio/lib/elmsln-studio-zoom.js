/**
 * Copyright 2020 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
import{LitElement as t,html as o,css as e}from"../../../lit-element/lit-element.js";import{navigator as i}from"../../../lit-element-router/lit-element-router.js";import"./elmsln-studio-modal.js";import"./elmsln-studio-modal-button.js";import"../../../@polymer/iron-icon/iron-icon.js";import"../../../@polymer/iron-icons/iron-icons.js";import"../../../@polymer/iron-icons/image-icons.js";class ElmslnStudioZoom extends(i(t)){static get tag(){return"elmsln-studio-zoom"}static get properties(){return{path:{type:String},prev:{type:Number,attribute:"prev"},next:{type:Number,attribute:"next"},src:{type:String},modal:{type:Object}}}static get styles(){return e`
      :host {
        display: block;
      }
      :host([hidden]) {
        display: none;
      }
    `}constructor(){super(),this.modal=window.SimpleModal.requestAvailability(),this.path="",this.src="",this.prev=-1,this.next=-1,import("../../img-pan-zoom/img-pan-zoom.js")}updated(t){super.updated&&super.updated(t),t.forEach((t,o)=>{"src"===o&&this.__img&&(this.__img.src=this.src,this.__img.resetZoom())})}render(){return o`
      <elmsln-studio-modal id="zoom" @modal-button-click="${this.setModal}">
        <iron-icon aria-hidden="true" icon="zoom-in"></iron-icon>
        <slot></slot>
      </elmsln-studio-modal>
    `}setModal(){let t=this.shadowRoot.getElementById("zoom");this.__img=document.createElement("img-pan-zoom"),this.__img.minZoomImageRatio=1,this.__img.maxZoomPixelRatio=3,this.__img.src=this.src,this.__img.style.height="calc(90vh - 55px - 36px)",t.buttons=this._buttonGroup([this._buttonGroup([this._button("prev",t=>this.swapImg(this.prev,t),"chevron-left",!0),this._buttonGroup([this._button("rotate counterclockwise",t=>this.rotateCCW(this.__img,t),"image:rotate-left"),this._button("rotate clockwise",t=>this.rotateCW(this.__img,t),"image:rotate-right")],!0,"flex-start"),this._buttonGroup([this._button("zoom in",t=>this.zoomIn(this.__img,t),"zoom-in"),this._button("zoom out",t=>this.zoomOut(this.__img,t),"zoom-out")],!0,"center"),this._buttonGroup([this._button("pan up",t=>this.panUp(this.__img,t),"arrow-upward"),this._button("pan down",t=>this.panDown(this.__img,t),"arrow-downward"),this._button("pan left",t=>this.panLeft(this.__img,t),"arrow-back"),this._button("pan right",t=>this.panRight(this.__img,t),"arrow-forward")],!0,"flex-end"),this._button("next",t=>this.swapImg(this.next,t),"chevron-right",!0)],!0)]),t.header=this._buttonGroup([this.__img])}swapImg(t,o){let e=this.closest("#primary"),i=!!e&&e.querySelector(`#zoom-${t}`);i&&(this.prev=i.prev,this.next=i.next,this.src=i.src)}rotateCCW(t,o){t.rotate(-90)}rotateCW(t,o){t.rotate()}zoomIn(t,o){t.zoomIn(.2)}zoomOut(t,o){t.zoomOut(.2)}panUp(t,o){t.pan(0,.2)}panDown(t,o){t.pan(0,-.2)}panLeft(t,o){t.pan(.2,0)}panRight(t,o){t.pan(-.2,0)}_buttonGroup(t,o=!1,e){let i=document.createElement("div");return o&&(i.style.display="flex",i.style.alignItems="stretch",i.style.justifyContent=e||"space-between",i.style.flexWrap="wrap"),e&&(i.style.border="1px solid #ddd"),t.forEach(t=>i.appendChild(t)),i}_button(t,o,e,i=!1){let s=document.createElement("elmsln-studio-modal-button");return s.text=t,s.callback=o,s.icon=e,s.border=i,"prev"===t||"next"===t?("prev"===t&&(s.align="left",s.disabled=!this.prev),"next"===t&&(s.align="right",s.disabled=!this.next),s.flexible=!0):s.hideText=!0,s}_buttonEvent(t){this.dispatchEvent(new CustomEvent(t,{bubbles:!0,cancelable:!0,composed:!0,detail:this}))}}customElements.define("elmsln-studio-zoom",ElmslnStudioZoom);export{ElmslnStudioZoom};