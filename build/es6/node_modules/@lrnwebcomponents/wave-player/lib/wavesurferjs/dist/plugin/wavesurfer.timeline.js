/*!
 * wavesurfer.js 2.1.0 (Mon Oct 01 2018 11:34:43 GMT+0200 (Central European Summer Time))
 * https://github.com/katspaugh/wavesurfer.js
 * @license BSD-3-Clause
 */
!function webpackUniversalModuleDefinition(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("timeline",[],t):"object"==typeof exports?exports.timeline=t():(e.WaveSurfer=e.WaveSurfer||{},e.WaveSurfer.timeline=t())}(window,(function(){return function(e){var t={};function __webpack_require__(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,__webpack_require__),a.l=!0,a.exports}return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,r){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(__webpack_require__.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)__webpack_require__.d(r,a,function(t){return e[t]}.bind(null,a));return r},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="localhost:8080/dist/plugin/",__webpack_require__(__webpack_require__.s="./src/plugin/timeline.js")}({"./src/plugin/timeline.js":
/*!********************************!*\
      !*** ./src/plugin/timeline.js ***!
      \********************************/
/*! no static exports found */
function(e,t,r){function _defineProperties(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){function TimelinePlugin(e,t){var r=this;if(function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TimelinePlugin),i.call(this),this.container="string"==typeof e.container?document.querySelector(e.container):e.container,!this.container)throw new Error("No container for wavesurfer timeline");this.wavesurfer=t,this.util=t.util,this.params=this.util.extend({},{height:20,notchPercentHeight:90,labelPadding:5,unlabeledNotchColor:"#c0c0c0",primaryColor:"#000",secondaryColor:"#c0c0c0",primaryFontColor:"#000",secondaryFontColor:"#000",fontFamily:"Arial",fontSize:10,zoomDebounce:!1,formatTimeCallback:this.defaultFormatTimeCallback,timeInterval:this.defaultTimeInterval,primaryLabelInterval:this.defaultPrimaryLabelInterval,secondaryLabelInterval:this.defaultSecondaryLabelInterval},e),this.canvases=[],this.wrapper=null,this.drawer=null,this.pixelRatio=null,this.maxCanvasWidth=null,this.maxCanvasElementWidth=null,this._onZoom=this.params.zoomDebounce?this.wavesurfer.util.debounce((function(){return r.render()}),this.params.zoomDebounce):function(){return r.render()}}return _createClass(TimelinePlugin,null,[{key:"create",value:function create(e){return{name:"timeline",deferInit:!(!e||!e.deferInit)&&e.deferInit,params:e,instance:TimelinePlugin}}}]),_createClass(TimelinePlugin,[{key:"init",value:function init(){this.wavesurfer.on("ready",this._onReady),this.wavesurfer.isReady&&this._onReady()}},{key:"destroy",value:function destroy(){this.unAll(),this.wavesurfer.un("redraw",this._onRedraw),this.wavesurfer.un("zoom",this._onZoom),this.wavesurfer.un("ready",this._onReady),this.wavesurfer.drawer.wrapper.removeEventListener("scroll",this._onScroll),this.wrapper&&this.wrapper.parentNode&&(this.wrapper.removeEventListener("click",this._onWrapperClick),this.wrapper.parentNode.removeChild(this.wrapper),this.wrapper=null)}},{key:"createWrapper",value:function createWrapper(){var e=this.wavesurfer.params;this.container.innerHTML="",this.wrapper=this.container.appendChild(document.createElement("timeline")),this.util.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:"".concat(this.params.height,"px")}),(e.fillParent||e.scrollParent)&&this.util.style(this.wrapper,{width:"100%",overflowX:"hidden",overflowY:"hidden"}),this.wrapper.addEventListener("click",this._onWrapperClick)}},{key:"render",value:function render(){this.wrapper||this.createWrapper(),this.updateCanvases(),this.updateCanvasesPositioning(),this.renderCanvases()}},{key:"updateCanvases",value:function updateCanvases(){for(var e=this,t=function addCanvas(){var t=e.wrapper.appendChild(document.createElement("canvas"));e.canvases.push(t),e.util.style(t,{position:"absolute",zIndex:4})},r=function removeCanvas(){var t=e.canvases.pop();t.parentElement.removeChild(t)},a=Math.round(this.drawer.wrapper.scrollWidth),i=Math.ceil(a/this.maxCanvasElementWidth);this.canvases.length<i;)t();for(;this.canvases.length>i;)r()}},{key:"updateCanvasesPositioning",value:function updateCanvasesPositioning(){var e=this,t=this.canvases.length;this.canvases.forEach((function(r,a){var i=a===t-1?e.drawer.wrapper.scrollWidth-e.maxCanvasElementWidth*(t-1):e.maxCanvasElementWidth;r.width=i*e.pixelRatio,r.height=(e.params.height+1)*e.pixelRatio,e.util.style(r,{width:"".concat(i,"px"),height:"".concat(e.params.height,"px"),left:"".concat(a*e.maxCanvasElementWidth,"px")})}))}},{key:"renderCanvases",value:function renderCanvases(){var e=this,t=this.wavesurfer.backend.getDuration();if(!(t<=0)){var r,a=this.wavesurfer.params,i=this.params.fontSize*a.pixelRatio,n=parseInt(t,10)+1,l=a.fillParent&&!a.scrollParent?this.drawer.getWidth():this.drawer.wrapper.scrollWidth*a.pixelRatio,s=this.params.height*this.pixelRatio,o=this.params.height*(this.params.notchPercentHeight/100)*this.pixelRatio,c=l/t,u=this.params.formatTimeCallback,p=function intervalFnOrVal(e){return"function"==typeof e?e(c):e},h=p(this.params.timeInterval),d=p(this.params.primaryLabelInterval),f=p(this.params.secondaryLabelInterval),v=0,m=0,_=[];for(r=0;r<n/h;r++)_.push([r,m,v]),m+=h,v+=c*h;var w=function renderPositions(e){_.forEach((function(t){e(t[0],t[1],t[2])}))};this.setFillStyles(this.params.primaryColor),this.setFonts("".concat(i,"px ").concat(this.params.fontFamily)),this.setFillStyles(this.params.primaryFontColor),w((function(t,r,a){t%d==0&&(e.fillRect(a,0,1,s),e.fillText(u(r,c),a+e.params.labelPadding*e.pixelRatio,s))})),this.setFillStyles(this.params.secondaryColor),this.setFonts("".concat(i,"px ").concat(this.params.fontFamily)),this.setFillStyles(this.params.secondaryFontColor),w((function(t,r,a){t%f==0&&(e.fillRect(a,0,1,s),e.fillText(u(r,c),a+e.params.labelPadding*e.pixelRatio,s))})),this.setFillStyles(this.params.unlabeledNotchColor),w((function(t,r,a){t%f!=0&&t%d!=0&&e.fillRect(a,0,1,o)}))}}},{key:"setFillStyles",value:function setFillStyles(e){this.canvases.forEach((function(t){t.getContext("2d").fillStyle=e}))}},{key:"setFonts",value:function setFonts(e){this.canvases.forEach((function(t){t.getContext("2d").font=e}))}},{key:"fillRect",value:function fillRect(e,t,r,a){var i=this;this.canvases.forEach((function(n,l){var s=l*i.maxCanvasWidth,o={x1:Math.max(e,l*i.maxCanvasWidth),y1:t,x2:Math.min(e+r,l*i.maxCanvasWidth+n.width),y2:t+a};o.x1<o.x2&&n.getContext("2d").fillRect(o.x1-s,o.y1,o.x2-o.x1,o.y2-o.y1)}))}},{key:"fillText",value:function fillText(e,t,r){var a,i=0;this.canvases.forEach((function(n){var l=n.getContext("2d"),s=l.canvas.width;i>t+a||(i+s>t&&(a=l.measureText(e).width,l.fillText(e,t-i,r)),i+=s)}))}},{key:"defaultFormatTimeCallback",value:function defaultFormatTimeCallback(e,t){if(e/60>1){var r=parseInt(e/60,10);return e=(e=parseInt(e%60,10))<10?"0"+e:e,"".concat(r,":").concat(e)}return Math.round(1e3*e)/1e3}},{key:"defaultTimeInterval",value:function defaultTimeInterval(e){return e>=25?1:5*e>=25?5:15*e>=25?15:60*Math.ceil(.5/e)}},{key:"defaultPrimaryLabelInterval",value:function defaultPrimaryLabelInterval(e){return e>=25?10:5*e>=25?6:4}},{key:"defaultSecondaryLabelInterval",value:function defaultSecondaryLabelInterval(e){return e>=25?5:2}}]),TimelinePlugin}();t.default=a;var i=function _initialiseProps(){var e=this;this._onScroll=function(){e.wrapper&&e.drawer.wrapper&&(e.wrapper.scrollLeft=e.drawer.wrapper.scrollLeft)},this._onRedraw=function(){return e.render()},this._onReady=function(){var t=e.wavesurfer;e.drawer=t.drawer,e.pixelRatio=t.drawer.params.pixelRatio,e.maxCanvasWidth=t.drawer.maxCanvasWidth||t.drawer.width,e.maxCanvasElementWidth=t.drawer.maxCanvasElementWidth||Math.round(e.maxCanvasWidth/e.pixelRatio),t.drawer.wrapper.addEventListener("scroll",e._onScroll),t.on("redraw",e._onRedraw),t.on("zoom",e._onZoom),e.render()},this._onWrapperClick=function(t){t.preventDefault();var r="offsetX"in t?t.offsetX:t.layerX;e.fireEvent("click",r/e.wrapper.scrollWidth||0)}};e.exports=t.default}})}));