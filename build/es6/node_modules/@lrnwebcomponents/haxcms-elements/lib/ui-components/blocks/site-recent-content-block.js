import{html,PolymerElement}from"../../../../../@polymer/polymer/polymer-element.js";import{store}from"../../core/haxcms-site-store.js";import{autorun,toJS}from"../../../../../mobx/lib/mobx.module.js";import"../../../../../@polymer/polymer/lib/elements/dom-repeat.js";import"../query/site-query.js";import"../../../../../@polymer/iron-image/iron-image.js";class SiteRecentContentBlock extends PolymerElement{static get tag(){return"site-recent-content-block"}static get template(){return html`
      <style>
        :host {
          display: block;
          background-color: #fff;
          box-shadow: 0 1px 2px #dcdcdc;
          padding: 10px;
          margin-top: 10px;
          --site-recent-content-block-header-color: #363533;
          --site-recent-content-block-item-link-color: #363533;
          --site-recent-content-block-active-color: var(
            --haxcms-color,
            #e2801e
          );
        }
        .header h3 {
          font-size: 26px;
          margin: 0 0 10px;
          color: var(--site-recent-content-block-header-color);
        }
        .item-wrap {
          display: flex;
          align-items: center;
          border-bottom: solid 1px #dcdcdc;
          padding-bottom: 8px;
          padding-top: 8px;
          @apply --site-recent-content-block-item-wrap;
        }
        .item-heading a {
          text-decoration: none;
          color: var(--site-recent-content-block-item-link-color);
          font-size: 16px;
          @apply --site-recent-content-block-item-link;
        }
        .item-heading a:hover,
        .item-heading a:focus,
        .item-heading a:active {
          @apply --site-recent-content-block-item-link-hover;
        }
        .active {
          color: ;
          border-left: solid 4px var(--site-recent-content-block-active-color);
          background-color: whitesmoke;
          padding-left: 5px;
          @apply --site-recent-content-block-item-active;
        }
        .image-wrapper {
          display: flex;
          margin-right: 10px;
          @apply --site-recent-content-block-image-wrapper;
        }
        .image-wrapper iron-image {
          height: 50px;
          width: 50px;
          @apply --site-recent-content-block-image;
        }
      </style>
      <aside>
        <div class="header">
          <h3>[[title]]</h3>
        </div>
        <site-query
          result="{{__items}}"
          sort="[[sort]]"
          conditions="[[conditions]]"
          limit="[[limit]]"
          start-index="[[startIndex]]"
        >
        </site-query>
        <dom-repeat items="[[__items]]" mutable-data>
          <template>
            <div class="item-wrap" data-id$="[[item.id]]">
              <div class="image-wrapper">
                <iron-image
                  sizing="cover"
                  src="[[item.metadata.fields.image]]"
                ></iron-image>
              </div>
              <div class="item-heading">
                <a href\$="[[item.location]]">[[item.title]]</a>
              </div>
            </div>
          </template>
        </dom-repeat>
      </aside>
    `}static get properties(){return{limit:{type:Number,value:10},startIndex:{type:Number,value:0},sort:{type:Object,value:{"metadata.created":"ASC"}},conditions:{type:Object,value:{}},title:{type:String,value:"Recent content"},activeId:{type:String,observer:"_activeIdChanged"}}}_activeIdChanged(newValue){if(newValue){let el=null;if(this.shadowRoot.querySelector("[data-id=\""+newValue+"\"]")){el=this.shadowRoot.querySelector("[data-id=\""+newValue+"\"]")}else{let tmpItem=store.manifest.items.find(i=>i.id==newValue);while(null===el&&tmpItem&&null!=tmpItem.parent){tmpItem=store.manifest.items.find(i=>i.id==tmpItem.parent);if(tmpItem&&this.shadowRoot.querySelector("[data-id=\""+tmpItem.id+"\"]")){el=this.shadowRoot.querySelector("[data-id=\""+tmpItem.id+"\"]")}}}if(this._prevEl){this._prevEl.classList.remove("active")}if(el){el.classList.add("active");this._prevEl=el}}}connectedCallback(){super.connectedCallback();setTimeout(()=>{this.__disposer=autorun(()=>{this.activeId=toJS(store.activeId)})},50)}disconnectedCallback(){if(this.__disposer){this.__disposer()}super.disconnectedCallback()}}window.customElements.define(SiteRecentContentBlock.tag,SiteRecentContentBlock);export{SiteRecentContentBlock};