import{html,PolymerElement}from"../../../../../@polymer/polymer/polymer-element.js";import{store}from"../../core/haxcms-site-store.js";import{autorun,toJS}from"../../../../../mobx/lib/mobx.module.js";class SiteQueryMenuSlice extends PolymerElement{static get tag(){return"site-query-menu-slice"}static get properties(){return{start:{type:Number,value:1},end:{type:Number,value:1e3},parent:{type:String},fixedId:{type:Boolean,value:!1},noDynamicLevel:{type:Boolean,value:!1},result:{type:Array,notify:!0,computed:"_computeItems(start, end, parent, _routerManifest)"},_routerManifest:{type:Object}}}_computeItems(start,end,parent,_routerManifest){if(_routerManifest){let items=[],data=[];_routerManifest.items.forEach(element=>{if(!element.parent){items.push(element)}});items.forEach(item=>{this._setChildren(item,_routerManifest.items)});items.forEach(item=>{this._spiderChildren(item,data,start,end,parent,!1)});console.log(data);return data}}_spiderChildren(item,data,start,end,parent,parentFound){if(item.id===parent||parentFound){if(!parentFound){parentFound=!0;if(!this.noDynamicLevel&&item.indent>=start){start+=item.indent;end+=item.indent}}if(item.indent>=start&&item.indent<=end){data.push(item)}if(0<item.children.length){item.children.forEach(child=>{this._spiderChildren(child,data,start,end,parent,parentFound)})}}else{if(0<item.children.length){item.children.forEach(child=>{this._spiderChildren(child,data,start,end,parent,parentFound)})}}}_setChildren(item,data){const children=data.filter(d=>item.id===d.parent);item.children=children;if(0<item.children.length){item.children.forEach(child=>{this._setChildren(child,data)})}}connectedCallback(){super.connectedCallback();this.__disposer=autorun(()=>{this._routerManifest=Object.assign({},toJS(store.routerManifest))});if(!this.fixedId){this.__disposer2=autorun(()=>{this.parent=toJS(store.activeId)})}}disconnectedCallback(){this.__disposer();if(!this.fixedId){this.__disposer2()}super.disconnectedCallback()}}window.customElements.define(SiteQueryMenuSlice.tag,SiteQueryMenuSlice);export{SiteQueryMenuSlice};