import{html,Polymer}from"../../../@polymer/polymer/polymer-legacy.js";import*as async from"../../../@polymer/polymer/lib/utils/async.js";import{Router}from"../../../@vaadin/router/dist/vaadin-router.js";import{autorun}from"../../../mobx/lib/mobx.module.js";import{store}from"./haxcms-site-store.js";Polymer({_template:html`
    <style>
      :host {
        display: block;
      }
    </style>
  `,is:"haxcms-site-router",properties:{manifest:{type:Object,notify:!0,observer:"_manifestChanged"},baseUri:{type:String}},created:function(){autorun(()=>{this._manifestChanged(store.routerManifest)});window.addEventListener("vaadin-router-location-changed",this._routerLocationChanged.bind(this))},detached:function(){window.removeEventListener("vaadin-router-location-changed",this._routerLocationChanged.bind(this))},_manifestChanged:function(routerManifest){if(routerManifest){this._updateRouter(routerManifest)}},_updateRouter:function(manifest){if(!manifest||"undefined"===typeof manifest.items)return;let options={};if(this.baseUri){options.baseUrl=this.baseUri}const router=new Router(this,options),routerItems=manifest.items.map(i=>{return{path:i.location,name:i.id,component:"haxcms-site-router-location"}});router.setRoutes([...routerItems,{path:"/",component:"haxcms-site-router-location",name:"home"},{path:"/(.*)",component:"haxcms-site-router-location",name:"404"}])},_routerLocationChanged:function(e){store.location=e.detail.location}});