import{store as t}from"../haxcms-site-store.js";import{HAXStore as e}from"../../../../hax-body/lib/hax-store.js";import{HAXCMSButton as i}from"../utils/HAXCMSButton.js";import{toJS as s}from"../../../../../mobx/dist/mobx.esm.js";export class HAXCMSButtonAdd extends i{static get tag(){return"haxcms-button-add"}constructor(){super(),this.t=this.t||{},this.t.newPageAdded="New page added",this.t.newPage="New page",this.t.copy="Copy",this.t.newChildPage="New child page",this.t.duplicatePage="Duplicate page",this.icon="hax:add-page",this.voiceCommand="add page",this.dark=!1,this.type="sibling",this.autoEdit=!1}static get properties(){return{...super.properties,autoEdit:{type:Boolean,attribute:"auto-edit"},type:{type:String}}}render(){switch(this.type){case"sibling":return this.renderButton(this.t.newPage,this.t.newPage);case"child":return this.icon="hax:add-child-page",this.renderButton(this.t.newChildPage,this.t.newChildPage);case"duplicate":return this.icon="hax:duplicate",this.renderButton(this.t.duplicatePage,this.t.duplicatePage)}}connectedCallback(){super.connectedCallback(),window.addEventListener("haxcms-create-node-success",this.HAXCMSButtonClickResponse.bind(this))}disconnectedCallback(){window.removeEventListener("haxcms-create-node-success",this.HAXCMSButtonClickResponse.bind(this)),super.disconnectedCallback()}HAXCMSButtonClick(e){t.playSound("click");let i=null,a=this.t.newPage,n=null;const d=s(t.activeItem);d&&("sibling"===this.type?(n=d.parent,i=parseInt(d.order)+1):"child"===this.type?(n=d.id,i=0):"duplicate"===this.type&&(a=d.title+" "+this.t.copy,n=d.parent,i=parseInt(d.order)+1)),""===a&&(a="New");var o={node:{title:a,location:""},order:i,parent:n};"duplicate"===this.type&&(o.node.duplicate=d.id),this.HAXCMSFireButtonEvent("haxcms-create-node",this,o)}HAXCMSButtonClickResponse(i){this===i.detail.originalTarget&&this.autoEdit&&(e.haxTray.collapsed=!1,setTimeout((()=>{t.editMode=!0}),250))}}customElements.define(HAXCMSButtonAdd.tag,HAXCMSButtonAdd);