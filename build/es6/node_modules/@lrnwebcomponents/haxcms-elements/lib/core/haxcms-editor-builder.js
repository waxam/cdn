import{PolymerElement}from"../../../../@polymer/polymer/polymer-element.js";import{pathFromUrl}from"../../../../@polymer/polymer/lib/utils/resolve-url.js";import{store}from"./haxcms-site-store.js";import*as async from"../../../../@polymer/polymer/lib/utils/async.js";import"./haxcms-site-editor-ui.js";class HAXCMSEditorBuilder extends PolymerElement{static get tag(){return"haxcms-editor-builder"}constructor(){super();this.applyContext()}connectedCallback(){super.connectedCallback();window.addEventListener("hax-store-ready",this.storeReady.bind(this))}disconnectedCallback(){window.removeEventListener("hax-store-ready",this.storeReady.bind(this));super.disconnectedCallback()}storeReady(){if(!store.cmsSiteEditor.haxCmsSiteEditorUIElement){store.cmsSiteEditor.haxCmsSiteEditorUIElement=document.createElement("haxcms-site-editor-ui");document.body.appendChild(store.cmsSiteEditor.haxCmsSiteEditorUIElement);setTimeout(()=>{store.cmsSiteEditor.haxCmsSiteEditorUIElement.painting=!1},5)}}getContext(){let context="";if(typeof DatArchive!==typeof void 0){context="beaker"}else if(!0===window.__haxCMSContextPublished){context="published"}else if(!0===window.__haxCMSContextNode){context="nodejs"}else if(!0===window.__haxCMSContextDemo){context="demo"}else{context="php"}return context}applyContext(){let context=this.getContext();if("php"===context){let script=document.createElement("script");script.src=`/haxcms-jwt.php`;document.documentElement.appendChild(script)}if("published"!==context){const basePath=pathFromUrl(decodeURIComponent(import.meta.url));store.cmsSiteEditor.tag=`haxcms-backend-${context}`;import(`${basePath}backends/${store.cmsSiteEditor.tag}.js`)}}}window.customElements.define(HAXCMSEditorBuilder.tag,HAXCMSEditorBuilder);export{HAXCMSEditorBuilder};