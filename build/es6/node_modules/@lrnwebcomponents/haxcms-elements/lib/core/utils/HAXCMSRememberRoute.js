import{store as t}from"../haxcms-site-store.js";import{HAXCMSI18NMixin as e}from"./HAXCMSI18NMixin.js";import{autorun as a,toJS as s}from"../../../../../mobx/dist/mobx.esm.js";function localStorageGet(t){try{return localStorage.getItem(t)}catch(t){return!1}}const HAXCMSRememberRoute=function(o){return class extends(e(o)){constructor(){super();this.__evaluateRoute=!1,this.t=this.t||{},this.t={...this.t,resumeMessage:"Resume where you left off last session?",resume:"Resume"},a((e=>{const a=s(t.location.pathname);a&&this.__evaluateRoute&&function localStorageSet(t,e){try{return localStorage.setItem(t,e)}catch(t){return!1}}(`HAXCMSlastRoute-${t.manifest.metadata.site.name}`,a)}))}firstUpdated(e){super.firstUpdated&&super.firstUpdated(e),setTimeout((()=>{t&&t.location&&t.location.pathname&&localStorageGet(`HAXCMSlastRoute-${t.manifest.metadata.site.name}`)&&localStorageGet(`HAXCMSlastRoute-${t.manifest.metadata.site.name}`)!=s(t.location.pathname)&&import("../../../../simple-toast/simple-toast.js").then((()=>{window.SimpleToast.requestAvailability();let e=document.createElement("a");e.setAttribute("href",localStorageGet(`HAXCMSlastRoute-${t.manifest.metadata.site.name}`)),e.addEventListener("click",this.resumeLastRoute.bind(this)),e.innerHTML=`<button>${this.t.resume}</button>`;new URLSearchParams(window.location.search).get("format")||t.toast(this.t.resumeMessage,8e3,"capsule",null,null,e)})),this.__evaluateRoute=!0}),1e3)}resumeLastRoute(t){window.dispatchEvent(new CustomEvent("simple-toast-hide",{bubbles:!0,composed:!0,cancelable:!1,detail:!1}))}}};export{HAXCMSRememberRoute};