import{html as t}from"../../../../../lit/index.js";import{store as i}from"../haxcms-site-store.js";import"../../../../hax-iconset/lib/simple-hax-iconset.js";import{b64toBlob as e}from"../../../../utils/utils.js";import{MicroFrontendRegistry as r}from"../../../../micro-frontend-registry/micro-frontend-registry.js";import{HAXCMSI18NMixin as o}from"./HAXCMSI18NMixin.js";import{toJS as n}from"../../../../../mobx/dist/mobx.esm.js";import{enableServices as s}from"../../../../micro-frontend-registry/lib/microServices.js";export const PrintBranchMixin=function(a){return class extends(o(a)){constructor(){super(),s(["haxcms"]),this.t=this.t||{},this.t={...this.t,printBranch:"Print Branch"}}PrintBranchButton(){return t`
      ${r.has("@haxcms/siteToHtml")?t`
      <div class="print-branch-btn" part="${this.editMode?"edit-mode-active":""}">
        <simple-icon-button-lite
          part="print-branch-btn"
          label="${this.t.printBranch}"
          icon="print"
          @click="${this.printBranchOfSite}"
          show-text-label
          icon-position="top"
        >
        </simple-icon-button-lite>
      </div>`:""}
      `}async printBranchOfSite(t){let o=n(i.ancestorItem);var s="";document.querySelector("base")&&(s=document.querySelector("base").href);const a=n(i.manifest),c={type:"site",site:{file:s+"site.json",id:a.id,title:a.title,author:a.author,description:a.description,license:a.license,metadata:a.metadata,items:a.items},ancestor:o?o.id:n(i.activeId),link:s,magic:window.__appCDN,base:s},m=await r.call("@haxcms/siteToHtml",c);if(200==m.status&&m.data){const t=document.createElement("a");t.href=window.URL.createObjectURL(e(btoa(unescape(encodeURIComponent(m.data))),"text/html")),t.download=o?`${n(i.ancestorTitle)}.html`:`${n(i.activeTitle)}.html`,t.target="_blank",this.appendChild(t),t.click(),this.removeChild(t)}else window.open(window.location.href+"?format=print-page","","left=0,top=0,width=800,height=800,toolbar=0,scrollbars=0,status=0,noopener=1,noreferrer=1")}}};