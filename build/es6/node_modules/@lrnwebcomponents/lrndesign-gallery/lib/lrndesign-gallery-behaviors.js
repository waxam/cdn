/**
 * Copyright 2018 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
import{html as e,PolymerElement as t}from"../../../@polymer/polymer/polymer-element.js";import{SimpleColorsPolymer as l}from"../../simple-colors/lib/simple-colors-polymer.js";import{ResponsiveUtility as i}from"../../responsive-utility/responsive-utility.js";import"../../../@polymer/iron-image/iron-image.js";import"../../../@polymer/iron-icons/iron-icons.js";import"../../../@polymer/paper-button/paper-button.js";import"../../simple-tooltip/simple-tooltip.js";import"./lrndesign-gallery-shared-styles.js";class LrndesignGalleryBehaviors extends l{static get tag(){return"lrndesign-gallery-behaviors"}static get properties(){return{anchorData:{type:Object,computed:"_getAnchorData()"},aspectRatio:{type:Number,value:"1.33333333"},extraWide:{type:Boolean,value:!1,reflectToAttribute:!0},galleryId:{type:String,value:null},grid:{type:Boolean,value:!1},items:{type:Array,computed:"_itemsLoaded(sources,sizing)"},responsiveSize:{type:String,value:"xs",reflectToAttribute:!0},selected:{type:Object,value:{},notify:!0,reflectToAttribute:!0},sizing:{type:String,value:"cover"},sources:{type:Array,value:[],reflectToAttribute:!1},title:{type:String,value:null}}}connectedCallback(){super.connectedCallback()}_addResponsiveUtility(e){window.ResponsiveUtility.requestAvailability(),window.dispatchEvent(new CustomEvent("responsive-element",{detail:void 0!==e?e:{element:this,attribute:"responsive-size",relativeToParent:!0}}))}_getAnchorData(){let e=null!==window.location.hash&&""!==window.location.hash?window.location.hash.replace("#","").split("---"):[],t=e.length>0?e[0]:-1,l=e.length>1?e[1]:-1,i=null!==this.sources?this.sources.findIndex(e=>e.id===l):1,r=t===this.galleryId,s=scroll&&e.length>2&&"zoom"===e[2];return{selectedItemId:l,selectedItemIndex:i>0?i:0,selectedGallery:r,zoom:s}}_getItemData(e,t,l){null===this.galleryId&&(this.galleryId="gallery-"+this._generateUUID());let i=this._getAnchorData(),r={};return r.details=e.details,r.index=t,r.id=this._selfOrDefault(e.id,this.galleryId+"-item-"+t),r.src=e.src,r.large=this._selfOrDefault(e.large,r.src),r.thumbnail=this._selfOrDefault(e.thumbnail,r.src),r.xofy=parseInt(t+1)+" of "+l,r.next=t+1<l?t+1:-1,r.prev=t-1>-1?t-1:-1,r.sizing=this._selfOrDefault(e.sizing,this.sizing),r.title=e.title,r.tooltip=this._selfOrDefault(r.title,"Full-Sized Image"," (Full-Sized)"),r.heading=this._selfOrDefault(r.title,"Full-Sized Image"," (Full-Sized)"),r.zoom=i.zoom&&i.selectedItemId===r.id,r.scroll=i.selectedGallery&&i.selectedItemId===r.id,r.tooltip=this._selfOrDefault(e.title,"Zoom In"," Zoom"),i.selectedItemIndex===t&&this.set("selected",r),r}_getParentOffset(e){let t=e.parentNode;return null!=t&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&(t=t.host),t.offsetTop}_scrollIntoView(e=[0]){window.scrollTo({top:e.reduce((e,t)=>e+t),behavior:"smooth"})}_isAttrSet(e=null){return null!==e}_isSelected(e={},t={}){return e.id===t.id}_itemsLoaded(e,t){new Image;let l=[];if(this.set("items",[]),null===this.galleryId&&(this.id="gallery-"+this._generateUUID()),null!=e&&e.length>0)for(var i in this._setAspectProperties(e[0].src),e)l[i]=this._getItemData(e[i],parseInt(i),e.length);return l}_selfOrDefault(e=null,t=!1,l=null){let i=t;return null!=e&&(i=null!==l?e+l:e),i}_setAspectProperties(e){if(null!=e){let t=new Image;t.src=e,this.aspectRatio=t.naturalWidth>0&&t.naturalHeight>0?t.naturalWidth/t.naturalHeight:1.33333333,this.extraWide=this.aspectRatio>2}}_testAttribute(e=null,t=!1){return e===t}_generateUUID(){return"ss-s-s-s-sss".replace(/s/g,this._uuidPart)}_uuidPart(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}}window.customElements.define(LrndesignGalleryBehaviors.tag,LrndesignGalleryBehaviors);export{LrndesignGalleryBehaviors};