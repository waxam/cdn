!function(b,j){"object"==typeof exports&&"undefined"!=typeof module?j(exports,require("@polymer/polymer/polymer-legacy.js"),require("@polymer/paper-card/paper-card.js"),require("@polymer/app-layout/app-toolbar/app-toolbar.js"),require("@polymer/paper-input/paper-input.js"),require("@polymer/iron-input/iron-input.js"),require("@polymer/paper-spinner/paper-spinner.js"),require("@polymer/paper-icon-button/paper-icon-button.js"),require("@lrnwebcomponents/hax-body-behaviors/lib/HAXWiring.js"),require("@lrnwebcomponents/schema-behaviors/schema-behaviors.js"),require("pdfjs-dist/build/pdf.js"),require("pdfjs-dist/build/pdf.worker.js"),require("@polymer/polymer/lib/legacy/polymer.dom.js")):"function"==typeof define&&define.amd?define(["exports","@polymer/polymer/polymer-legacy.js","@polymer/paper-card/paper-card.js","@polymer/app-layout/app-toolbar/app-toolbar.js","@polymer/paper-input/paper-input.js","@polymer/iron-input/iron-input.js","@polymer/paper-spinner/paper-spinner.js","@polymer/paper-icon-button/paper-icon-button.js","@lrnwebcomponents/hax-body-behaviors/lib/HAXWiring.js","@lrnwebcomponents/schema-behaviors/schema-behaviors.js","pdfjs-dist/build/pdf.js","pdfjs-dist/build/pdf.worker.js","@polymer/polymer/lib/legacy/polymer.dom.js"],j):j(b.PdfElement={},b.polymerLegacy_js,null,null,null,null,null,null,null,null,null,null,b.polymer_dom_js)}(this,function(b,j,k,q,w,x,y,z,A,B,C,D,E){"use strict";function F(){var J,K,L=(J=["\n    <style>\n      :host {\n        display: block;\n        width: 100%;\n        height: 100%;\n      }\n\n      app-toolbar.pdf-toolbar {\n        --app-toolbar-background: #323639;\n      }\n\n      .pdf-viewer {\n        text-align: center;\n        border: 1px solid #4d4d4d;\n      }\n\n      .pdf-viewport-out {\n        overflow: auto;\n        background-color: #525659;\n        position: relative;\n        width: 100%;\n        height: 100%;\n      }\n\n      .pdf-viewport {\n        display: block;\n        position: relative;\n        border: 1px solid #eeeeee;\n        transition: all 200ms ease-in-out;\n        width: 100%;\n        height: 100%;\n      }\n\n      .sidebar {\n        background-color: gray;\n        float: left;\n        height: 0px;\n        overflow: scroll;\n        margin-left: -25%;\n        visibility: hidden;\n      }\n\n      .main {\n        margin-left: 0%;\n      }\n\n      .pageselector {\n        width: 3ch;\n        background-color: black;\n        font-size: 17px;\n        background-color: transparent;\n        border: 0px solid;\n      }\n\n      .pageselector:focus {\n        outline: none;\n      }\n\n      #input {\n        -webkit-margin-start: -3px;\n        color: #fff;\n        line-height: 18px;\n        padding: 3px;\n        text-align: end;\n      }\n\n      #input:focus,\n      #input:hover {\n        background-color: rgba(0, 0, 0, 0.5);\n        border-radius: 2px;\n      }\n\n      #slash {\n        padding: 0 3px;\n      }\n\n      paper-spinner {\n        position: absolute;\n        left: 50%;\n      }\n\n      .textLayer {\n        transition: all 200ms ease-in-out;\n      }\n\n      .positionRelative {\n        position: relative;\n      }\n    </style>\n\n    <paper-material elevation=\"{{elevation}}\">\n      <div class=\"card-content\" style=\"width: {{width}}px\">\n        <paper-card class=\"paperCard\" style=\"width: {{width}}px\">\n          <div class=\"pdf-viewer\">\n            <app-toolbar class=\"pdf-toolbar\">\n              <paper-icon-button\n                icon=\"menu\"\n                on-click=\"sideBar\"\n              ></paper-icon-button>\n              <paper-icon-button\n                icon=\"arrow-back\"\n                on-click=\"showPrev\"\n              ></paper-icon-button>\n              <input\n                class=\"pageselector\"\n                id=\"input\"\n                is=\"iron-input\"\n                value=\"{{currentPage}}\"\n                prevent-invalid-input=\"\"\n                allowed-pattern=\"\\d\"\n                on-change=\"pageNumSearch\"\n              />\n              <span id=\"slash\">/</span><span id=\"totalPages\"></span>\n              <paper-icon-button\n                icon=\"arrow-forward\"\n                on-click=\"showNext\"\n              ></paper-icon-button>\n              <span class=\"title\" hidden=\"{{!showFileName}}\">Testing</span>\n              <span class=\"title\" hidden=\"{{showFileName}}\"></span>\n              <span class=\"pageRendering\"></span>\n              <paper-icon-button\n                icon=\"zoom-in\"\n                on-click=\"zoomIn\"\n              ></paper-icon-button>\n              <paper-icon-button\n                icon=\"zoom-out\"\n                on-click=\"zoomOut\"\n              ></paper-icon-button>\n              <paper-icon-button\n                id=\"zoomIcon\"\n                icon=\"fullscreen\"\n                on-click=\"zoomFit\"\n              ></paper-icon-button>\n              <paper-icon-button\n                icon=\"file-download\"\n                hidden$=\"{{!downloadable}}\"\n                on-click=\"download\"\n              ></paper-icon-button>\n            </app-toolbar>\n            <div id=\"container\" class=\"sidebar\" style=\"width:25%\"></div>\n            <div id=\"main\">\n              <div id=\"test\" class=\"pdf-viewport-out\">\n                <canvas class=\"pdf-viewport\"></canvas>\n                <div\n                  id=\"text-layer\"\n                  class=\"textLayer\"\n                  hidden$=\"{{!enableTextSelection}}\"\n                ></div>\n              </div>\n              <paper-spinner\n                class=\"spinner\"\n                hidden$=\"{{!showSpinner}}\"\n              ></paper-spinner>\n            </div>\n          </div>\n        </paper-card>\n      </div>\n    </paper-material>\n  "],(K=["\n    <style>\n      :host {\n        display: block;\n        width: 100%;\n        height: 100%;\n      }\n\n      app-toolbar.pdf-toolbar {\n        --app-toolbar-background: #323639;\n      }\n\n      .pdf-viewer {\n        text-align: center;\n        border: 1px solid #4d4d4d;\n      }\n\n      .pdf-viewport-out {\n        overflow: auto;\n        background-color: #525659;\n        position: relative;\n        width: 100%;\n        height: 100%;\n      }\n\n      .pdf-viewport {\n        display: block;\n        position: relative;\n        border: 1px solid #eeeeee;\n        transition: all 200ms ease-in-out;\n        width: 100%;\n        height: 100%;\n      }\n\n      .sidebar {\n        background-color: gray;\n        float: left;\n        height: 0px;\n        overflow: scroll;\n        margin-left: -25%;\n        visibility: hidden;\n      }\n\n      .main {\n        margin-left: 0%;\n      }\n\n      .pageselector {\n        width: 3ch;\n        background-color: black;\n        font-size: 17px;\n        background-color: transparent;\n        border: 0px solid;\n      }\n\n      .pageselector:focus {\n        outline: none;\n      }\n\n      #input {\n        -webkit-margin-start: -3px;\n        color: #fff;\n        line-height: 18px;\n        padding: 3px;\n        text-align: end;\n      }\n\n      #input:focus,\n      #input:hover {\n        background-color: rgba(0, 0, 0, 0.5);\n        border-radius: 2px;\n      }\n\n      #slash {\n        padding: 0 3px;\n      }\n\n      paper-spinner {\n        position: absolute;\n        left: 50%;\n      }\n\n      .textLayer {\n        transition: all 200ms ease-in-out;\n      }\n\n      .positionRelative {\n        position: relative;\n      }\n    </style>\n\n    <paper-material elevation=\"{{elevation}}\">\n      <div class=\"card-content\" style=\"width: {{width}}px\">\n        <paper-card class=\"paperCard\" style=\"width: {{width}}px\">\n          <div class=\"pdf-viewer\">\n            <app-toolbar class=\"pdf-toolbar\">\n              <paper-icon-button\n                icon=\"menu\"\n                on-click=\"sideBar\"\n              ></paper-icon-button>\n              <paper-icon-button\n                icon=\"arrow-back\"\n                on-click=\"showPrev\"\n              ></paper-icon-button>\n              <input\n                class=\"pageselector\"\n                id=\"input\"\n                is=\"iron-input\"\n                value=\"{{currentPage}}\"\n                prevent-invalid-input=\"\"\n                allowed-pattern=\"\\\\d\"\n                on-change=\"pageNumSearch\"\n              />\n              <span id=\"slash\">/</span><span id=\"totalPages\"></span>\n              <paper-icon-button\n                icon=\"arrow-forward\"\n                on-click=\"showNext\"\n              ></paper-icon-button>\n              <span class=\"title\" hidden=\"{{!showFileName}}\">Testing</span>\n              <span class=\"title\" hidden=\"{{showFileName}}\"></span>\n              <span class=\"pageRendering\"></span>\n              <paper-icon-button\n                icon=\"zoom-in\"\n                on-click=\"zoomIn\"\n              ></paper-icon-button>\n              <paper-icon-button\n                icon=\"zoom-out\"\n                on-click=\"zoomOut\"\n              ></paper-icon-button>\n              <paper-icon-button\n                id=\"zoomIcon\"\n                icon=\"fullscreen\"\n                on-click=\"zoomFit\"\n              ></paper-icon-button>\n              <paper-icon-button\n                icon=\"file-download\"\n                hidden\\$=\"{{!downloadable}}\"\n                on-click=\"download\"\n              ></paper-icon-button>\n            </app-toolbar>\n            <div id=\"container\" class=\"sidebar\" style=\"width:25%\"></div>\n            <div id=\"main\">\n              <div id=\"test\" class=\"pdf-viewport-out\">\n                <canvas class=\"pdf-viewport\"></canvas>\n                <div\n                  id=\"text-layer\"\n                  class=\"textLayer\"\n                  hidden\\$=\"{{!enableTextSelection}}\"\n                ></div>\n              </div>\n              <paper-spinner\n                class=\"spinner\"\n                hidden\\$=\"{{!showSpinner}}\"\n              ></paper-spinner>\n            </div>\n          </div>\n        </paper-card>\n      </div>\n    </paper-material>\n  "])||(K=J.slice(0)),Object.freeze(Object.defineProperties(J,{raw:{value:Object.freeze(K)}})));return F=function(){return L},L}var G=Math.round,H=function(J){this.element=J,this.reader=E.dom(J.root).querySelector(".pdf-viewer"),this.viewportOut=this.reader.querySelector(".pdf-viewport-out"),this.element=this.reader.querySelector(".pdf-element"),this.container=this.reader.querySelector(".sidebar"),this.toolbar=this.reader.querySelector(".pdf-toolbar"),this.card=E.dom(J.root).querySelector(".style-scope"),this.toolbarHeight=0,this.title=this.toolbar.querySelector(".title"),this.enableTextSelection=J.enableTextSelection,this.fitWidth=J.fitWidth,this.HEIGHT=J.getAttribute("height"),this.WIDTH=J.getAttribute("width"),this.viewport=this.reader.querySelector(".pdf-viewport"),this.enableTextSelection&&(this.textLayerDiv=this.reader.querySelector(".textLayer"),this.textLayerDivStyle=this.textLayerDiv.style),this.spinner=this.reader.querySelector(".spinner"),this.totalPages=this.reader.querySelector("#totalPages"),this.viewportStyle=this.viewport.style,this.viewportOutStyle=this.viewportOut.style,this.ctx=this.viewport.getContext("2d"),this.SRC=J.src,this.pageRendering=!1,this.pageNumPending=null};H.prototype.setSize=function(J,K){this.WIDTH||(this.WIDTH=this.viewportOut.offsetWidth),this.HEIGHT||(this.HEIGHT=this.viewportOut.offsetHeight),this.WIDTH;var L=this.HEIGHT;"height"===J&&(L=K),this.viewportOutStyle.height=L+"px",this.spinner.style.top=(L-this.toolbarHeight)/2+"px"},H.prototype.setSrc=function(J){this.SRC=J},H.prototype.setFitWidth=function(J){this.fitWidth=J},H.prototype.queueRenderPage=function(J){this.pdfExists=!0,this.pageRendering?this.pageNumPending=J:this.renderPDF(J)},H.prototype.loadPDF=function(){var K=this;this.setSize();var L=this;PDFJS.getDocument(this.SRC).then(function(M){L.PDF=M,L.queueRenderPage(1),L.currentPage=1,L.totalPages.innerHTML=L.PDF.numPages,L.totalPagesNum=L.PDF.numPages,L.currentZoomVal=L.fitZoomVal=L.widthZoomVal=0,L.createDownloadLink()}).catch(function(){K.pdfExists=!1})},H.prototype.renderPages=function(){var J=this;J.viewportOut.innerHTML="",PDFJS.getDocument(this.SRC).then(function(K){J.PDF=K;for(var L=1;L<=J.PDF.numPages;L++)K.getPage(L).then(J.renderPDF(L,null,!0));J.currentPage=1,J.totalPages.innerHTML=J.PDF.numPages,J.totalPagesNum=J.PDF.numPages,J.currentZoomVal||(J.currentZoomVal=J.fitZoomVal=J.widthZoomVal=0),J.createDownloadLink()})},H.prototype.sidebarSetup=function(J){function K(Q){var R,S=L.container;R=35e-5*(J.sidebarOpen,L.WIDTH);var T=Q.getViewport(R),U=document.createElement("div");(Q.pageIndex+1).toString(),M.split("/").pop(),U.style.backgroundColor="gray";var V=document.querySelector("pdf-element"),W=document.createElement("canvas");U.appendChild(W),S.appendChild(U),E.dom(L.container).childNodes[Q.pageIndex].addEventListener("click",function(){var Y=Q.pageIndex+1;V.sideBarClick(Y,J.instance,J)});var X=W.getContext("2d");W.height=T.height,W.width=T.width,Q.render({canvasContext:X,viewport:T}),N++,null!==P&&N<=O&&P.getPage(N).then(K)}var L=this,M=J.src,N=1,O=0,P=null;0==L.container.innerHTML.length?(L.container.innerHTML="",PDFJS.getDocument(this.SRC).then(function(Q){O=(P=Q).numPages,L.container,Q.getPage(1).then(K)}),L.setViewportPos(!0)):J.changedSideBar&&(L.container.innerHTML="",PDFJS.getDocument(this.SRC).then(function(Q){O=(P=Q).numPages,L.container,Q.getPage(1).then(K)}),L.setViewportPos(!1))},H.prototype.renderPDF=function(J,K,L){var M=this;M.pageRendering=!0,M.spinner.active=!0,this.PDF.getPage(J).then(function(N){var O,P,Q,R,S,T=Math.abs,U=Math.sin,V=Math.cos;if(S=N.pageInfo.rotate*Math.PI/180,M.pageW=T(N.view[2]*V(S)+N.view[3]*U(S)),M.pageH=T(N.view[3]*V(S)+N.view[2]*U(S)),(0===M.currentZoomVal||K)&&(O=G(100*(M.WIDTH/M.pageW))/100,P=G(100*((M.HEIGHT-M.toolbarHeight)/M.pageH))/100,R=Math.min(P,O),M.fitZoomVal=R,M.widthZoomVal=M.WIDTH/M.pageW,M.currentZoomVal=M.fitWidth?M.widthZoomVal:M.fitZoomVal),K)M.zoomPage({target:M.zoomLvl});else{if(R=M.currentZoomVal,Q=N.getViewport(R),M.ctx.height=Q.height,M.ctx.width=Q.width,M.pageW*=R,M.pageH*=R,M.WIDTH==M.currentWidth||null==M.currentWidth?M.setViewportPos(!1):M.setViewportPos(!0),M.viewport.width=M.pageW,M.viewport.height=M.pageH,M.viewportStyle.width=M.pageW+"px",M.viewportStyle.height=M.pageH+"px",M.enableTextSelection&&(M.textLayerDivStyle.width=M.pageW+"px",M.textLayerDivStyle.height=M.pageH+"px"),M.ctx.clearRect(0,0,M.viewport.width,M.viewport.height),L){var W=document.createElement("div");W.setAttribute("style","position: relative");var X=document.createElement("canvas"),Y=document.createElement("div");Y.setAttribute("style","left: "+M.viewportStyle.left),Y.className="textLayer";var Z=X.getContext("2d");Y.height=Q.height,Y.width=Q.width,M.viewportOut.appendChild(W),W.appendChild(X),W.appendChild(Y),N.render({canvasContext:Z,viewport:Q}),M.enableTextSelection&&(M.textLayerDiv.innerHTML="",N.getTextContent().then(function($){PDFJS.renderTextLayer({textContent:$,container:Y,pageIndex:J,viewport:Q,textDivs:[]})}))}else N.render({canvasContext:M.ctx,viewport:Q}).promise.then(function(){M.pageRendering=!1,M.spinner.active=!1,null!==M.pageNumPending&&(M.renderPDF(M.pageNumPending),M.pageNumPending=null)});M.enableTextSelection&&(M.textLayerDiv.innerHTML="",N.getTextContent().then(function($){PDFJS.renderTextLayer({textContent:$,container:M.textLayerDiv,pageIndex:J,viewport:Q,textDivs:[]})}))}})},H.prototype.setViewportPos=function(J){var K=Math.floor;this.currentWidth=J?.75*this.WIDTH:this.WIDTH,this.viewportStyle.left=this.pageW<this.currentWidth?(this.currentWidth-this.pageW)/2+"px":0,this.pageH<this.HEIGHT?(this.viewportStyle.top=(this.HEIGHT-this.pageH-this.toolbarHeight)/2+"px",this.viewportStyle.topNum=K((this.HEIGHT-this.pageH-this.toolbarHeight)/2)+this.toolbarHeight,this.enableTextSelection&&(this.textLayerDivStyle.topNum=K((this.HEIGHT-this.pageH-this.toolbarHeight)/2)+this.toolbarHeight)):this.viewportStyle.top=0,this.enableTextSelection&&(this.textLayerDivStyle.left=this.viewportStyle.left,this.textLayerDivStyle.top=this.viewportStyle.top)},H.prototype.changePDFSource=function(J){this.setSrc(J),this.loadPDF(1)},H.prototype.zoomInOut=function(J){this.currentZoomVal=G(10*(G(10*this.currentZoomVal)/10+J))/10,this.queueRenderPage(this.currentPage)},H.prototype.zoomIn=function(){this.currentZoomVal=G(10*(G(10*this.currentZoomVal)/10+.1))/10,this.queueRenderPage(this.currentPage)},H.prototype.zoomOut=function(){this.currentZoomVal=G(10*(G(10*this.currentZoomVal)/10-.1))/10,this.queueRenderPage(this.currentPage)},H.prototype.zoomPageFit=function(){this.currentZoomVal=this.fitZoomVal,this.queueRenderPage(this.currentPage)},H.prototype.zoomWidthFit=function(){this.currentZoomVal=this.widthZoomVal,this.queueRenderPage(this.currentPage)},H.prototype.getPageNum=function(){return this.PDF.numPages},H.prototype.createDownloadLink=function(){var J=this;this.PDF.getData().then(function(K){var L=PDFJS.createBlob(K,"application/pdf");J.downloadLink=URL.createObjectURL(L)})},H.prototype.download=function(){var J=document.createElement("a"),K=this.SRC.split("/");J.href=this.downloadLink,J.target="_parent","download"in J&&(J.download=decodeURIComponent(K[K.length-1])),this.reader.appendChild(J),J.click(),J.parentNode.removeChild(J)},window.Reader=H;var I=j.Polymer({_template:j.html(F()),is:"pdf-element",behaviors:[HAXBehaviors.PropertiesBehaviors,SchemaBehaviors.Schema],properties:{src:{type:String,reflectToAttribute:!0},elevation:{type:Number,value:1},downloadable:{type:Boolean,value:!1},showFileName:{type:Boolean,value:!1},showSpinner:{type:Boolean,value:!1},enableTextSelection:{type:Boolean,value:!1},fitWidth:{type:Boolean,value:!1},width:{type:Number,value:500}},attached:function(){this.src=this.getAttribute("src"),this._initializeReader(),this.src&&this.instance.loadPDF(),this._setFitWidth(),this.setHaxProperties({canScale:!0,canPosition:!0,canEditSource:!1,gizmo:{title:"PDF viewer",descrption:"This can nicely present a PDF in a standard inplace, cross browser way.",icon:"image:picture-as-pdf",color:"red",groups:["Presentation","PDF","Data"],handles:[{type:"pdf",url:"src",source:"src"},{type:"document",url:"src",source:"src"}],meta:{author:"LRNWebComponents"}},settings:{quick:[{property:"src",title:"File",description:"The URL for the pdf",inputMethod:"textfield",icon:"link",required:!0}],configure:[{property:"src",title:"Source",description:"The URL for this csv file",inputMethod:"textfield",icon:"link",required:!0},{property:"downloadable",title:"Downloadable",description:"User can download this",inputMethod:"boolean",icon:"file-download"},{property:"enableTextSelection",title:"Text Selection",description:"User can select text in this element.",inputMethod:"boolean",icon:"file-download"},{property:"elevation",title:"Elevation",description:"Visual elevation of the element",inputMethod:"number",icon:"flip-to-front"}],advanced:[]}})},loadPDF:function(){this.getAttribute("src")&&(this.instance.changePDFSource(this.getAttribute("src")),this.currentPage=1,this.totalPages=this.instance.totalPages,this.fileName=this.src.split("/").pop(),this._setFitWidth(),this.$.zoomIcon.icon="fullscreen")},attributeChanged:function(J){"src"===J?void 0===this.instance?this._initializeReader():(this.loadPDF(),this.changedSideBar=!0,this.fromChange=!0,this.sideBar()):"fitWidth"===J&&this._setFitWidth()},_initializeReader:function(){this.instance=new Reader(this),null!=this.src&&(this.fileName=this.src.split("/").pop()),this.currentPage=1},_setFitWidth:function(){this.instance.setFitWidth(this.fitWidth)},zoomInOut:function(J){2<=this.instance.currentZoomVal?this.instance.currentZoomVal=2:.1>=this.instance.currentZoomVal?this.instance.currentZoomVal=.1:(this.$.zoomIcon.icon="fullscreen",this.instance.zoomInOut(J))},zoomIn:function(){this.instance.pdfExists&&this.zoomInOut(.1)},zoomOut:function(){this.instance.pdfExists&&this.instance.zoomInOut(-.1)},zoomFit:function(){this.instance.pdfExists&&(this.instance.currentZoomVal==this.instance.widthZoomVal?(this.instance.zoomPageFit(),this.$.zoomIcon.icon="fullscreen"):(this.instance.zoomWidthFit(),this.$.zoomIcon.icon="fullscreen-exit"))},pageNumSearch:function(){var J=parseInt(this.$.input.value);1<=J&&J<=this.instance.totalPagesNum?(this.instance.currentPage=J,this.instance.queueRenderPage(this.instance.currentPage),this.currentPage=J,this.$.input.blur()):(this.$.input.value=this.currentPage,this.$.input.blur())},sideBarClick:function(J,K,L){L.src.split("/").pop();var M=K;L.sidebarOpen=!0,1<=J&&J<=K.totalPagesNum?(M.currentPage=J,M.queueRenderPage(M.currentPage),K.currentPage=J,L.currentPage=J,this.$.input.blur()):(this.$.input.value=M.currentPage,this.$.input.blur())},showPrev:function(){1<this.instance.currentPage&&(this.instance.currentPage--,this.instance.queueRenderPage(this.instance.currentPage),this.currentPage--)},showNext:function(){this.instance.totalPagesNum>this.instance.currentPage&&(this.instance.currentPage++,this.instance.queueRenderPage(this.instance.currentPage),this.currentPage++)},sideBar:function(){this.instance.pdfExists&&(this.fromChange||(this.$.container.style.height=this.$.test.style.height,this.$.container.style.width=this.$.test.style.width,"25%"==this.$.main.style.marginLeft?(this.sidebarOpen=!1,this.instance.setViewportPos(!1),this.$.main.style.marginLeft="0%",this.$.container.style.marginLeft="-25%",this.$.container.style.visibility="hidden"):(this.sidebarOpen=!0,this.$.main.style.marginLeft="25%",this.$.container.style.marginLeft="0%",this.$.container.style.visibility="visible",this.instance.setViewportPos(!0))),this.fromChange=!1,this.instance.sidebarSetup(this),this.changedSideBar=!1)},download:function(){this.instance.pdfExists&&this.instance.download()}});b.PdfElement=I,Object.defineProperty(b,"__esModule",{value:!0})});