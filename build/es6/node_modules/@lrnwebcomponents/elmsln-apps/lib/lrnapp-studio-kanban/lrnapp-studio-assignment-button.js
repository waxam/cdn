import{html,Polymer}from"../../../../@polymer/polymer/polymer-legacy.js";import"../../../../@polymer/iron-ajax/iron-ajax.js";import"../../../../@polymer/paper-toast/paper-toast.js";import"../../../lrnsys-button/lrnsys-button.js";Polymer({_template:html`
    <style>
      :host {
        display: block;
      }
    </style>
    <lrnsys-button
      on-tap="_createAssignment"
      icon-class="[[iconClass]]"
      alt="[[alt]]"
      class\$="[[classes]]"
      button-class\$="[[classes]]"
      hover-class="[[hoverClass]]"
      icon="[[icon]]"
    ></lrnsys-button>
    <iron-ajax
      id="ajaxCreateStub"
      url="[[createAssignmentUrl]]"
      method="POST"
      body="[[projectId]]"
      handle-as="json"
      on-response="_ajaxCreateStubHandler"
    ></iron-ajax>
    <template is="dom-if" if="[[displayErrors]]">
      <paper-toast id="toast"></paper-toast>
    </template>
  `,is:"lrnapp-studio-assignment-button",properties:{auto:{type:Boolean,reflectToAttribute:!0,value:!1,notify:!0},displayErrors:{type:Boolean,value:!0},projectId:{type:String},createAssignmentUrl:{type:String,value:null},iconClass:{type:String,value:null},alt:{type:String,value:null},classes:{type:String,value:null},hoverClass:{type:String,value:null},icon:{type:String,value:null},endPoint:String,csrfToken:String},ready:function(){this.createAssignmentUrl=this.endPoint+"/api/assignments/create-stub?token="+this.csrfToken},_createAssignment:function(){this.shadowRoot.querySelector("#ajaxCreateStub").generateRequest()},_ajaxCreateStubHandler:function(e){var status=e.detail.response.status,response=e.detail.response;if(201===status){var assignment=e.detail.response.data;if(assignment){this.fire("assignment-created",{assignment:assignment})}}if("undefined"!==typeof response.errors){var ul=document.createElement("ul"),text="";response.errors.forEach(function(error){text=text+" "+error});this.shadowRoot.querySelector("#toast").show(text)}}});