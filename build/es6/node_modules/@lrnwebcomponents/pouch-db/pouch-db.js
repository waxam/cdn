/**
 * Copyright 2019
 * @license Apache-2.0, see License.md for full text.
 */
import{html as e,PolymerElement as t}from"../../@polymer/polymer/polymer-element.js";import"./lib/pouchdb.min.js";window.PouchDb=window.PouchDb||{},window.PouchDb.requestAvailability=()=>(window.PouchDb.instance||(window.PouchDb.instance=document.createElement("pouch-db"),document.body.appendChild(window.PouchDb.instance)),window.PouchDb.instance);class PouchDb extends t{static get template(){return e`
      <style>
        :host {
          display: block;
        }

        :host([hidden]) {
          display: none;
        }
      </style>
      <slot></slot>
    `}static get properties(){return{...super.properties,title:{name:"title",type:String,value:"pouch-db-default-value",reflectToAttribute:!1,observer:!1}}}static get tag(){return"pouch-db"}connectedCallback(){super.connectedCallback(),window.addEventListener("user-engagement",this.userEngagmentFunction.bind(this)),window.addEventListener("get-data",this.getDataFunction.bind(this))}userEngagmentFunction(e){var t=e.detail;switch(event.target.tagName){case"MULTIPLE-CHOICE":var n="xapistatements",a=t.activityDisplay,s="http://adlnet.gov/expapi/verbs/"+a,i="http://haxcms.psu.edu/haxQuiz",o=t.objectName,c="HAX Quiz",l=1,u=0,r=100,d=100,p=t.resultSuccess,m=!0,b="sample",h="sample"}var w=new PouchDB(n),g={actor:{mbox:"mailto:dave@gmail.com",name:"Dave Fusco",objectType:"Agent"},verb:{id:s,display:{"en-US":a}},object:{id:i,definition:{name:{"en-US":o},description:{"en-US":c}},objectType:"Activity"},result:{score:{scaled:l,min:u,max:r,raw:d},success:p,completion:m,response:b,duration:h}},v={_id:(new Date).toISOString(),title:JSON.stringify(g),completed:!1};w.put(v,(function callback(e,t){e||console.log("Successfully posted a statement!")})),w.allDocs({include_docs:!0,descending:!0},(function(e,t){console.log(t.rows)}))}getDataFunction(e){var t=e.detail;event.target.tagName;switch(t.queryRequest){case"all-quizzes":var n="xapistatements";break;case"single-quiz":n="xapistatements",t.objectName;break;case"future-query":n="xapistatements",t.activityDisplay,t.objectName,t.resultSuccess,t.resultCompletion;break;default:n="xapistatements"}new PouchDB(n).allDocs({include_docs:!0,descending:!0},(function(e,t){!function processxAPI(e,t){var n=[];e.forEach((function(e){var t=JSON.parse(e.doc.title).object.definition.name["en-US"];n.push(t)})),t(n)}(t.rows,(function displayxAPI(e){!function processItems(e,t){var n={};e.forEach((function(e){n[e]=(n[e]||0)+1})),t(n)}(e,(function display(e){var t=[],n=[];for(let n of Object.keys(e))t.push(n);for(let t of Object.values(e))n.push(t);let a=[""];a={labels:t,series:[n]},window.dispatchEvent(new CustomEvent("show-data",{bubbles:!0,composed:!0,cancelable:!1,detail:a}))}))}))}))}disconnectedCallback(){window.removeEventListener("user-engagement",this.userEngagmentFunction.bind(this)),window.removeEventListener("get-data",this.getDataFunction.bind(this)),super.disconnectedCallback()}}window.customElements.define(PouchDb.tag,PouchDb);export{PouchDb};