/**
 * Copyright 2018 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
import{html,PolymerElement}from"../../@polymer/polymer/polymer-element.js";class SimpleTimer extends PolymerElement{static get template(){return html`
      <style>
        :host {
          display: block;
        }
      </style>
      [[_formattedTime]]
    `}static get tag(){return"simple-timer"}static get properties(){return{startTime:{type:Number,value:60},currentTime:{type:Number,notify:!0},isRunning:{type:Boolean,reflectToAttribute:!0,notify:!0,value:!1},countUp:{type:Boolean,value:!1},_elapsedTime:{type:Number,value:0},_formattedTime:{type:String,value:"0"}}}ready(){super.ready(),this.countUp?(this.set("currentTime",0),this.set("_formattedTime","0")):(this.set("currentTime",this.startTime),this.set("_formattedTime",this.startTime.toString()))}start(){(this.currentTime<=0&&!this.countUp||this.currentTime>=this.startTime&&this.countUp)&&(this.currentTime=this.countUp?this.startTime:0),this.startTime&&!this.isRunning?(this._elapsed=performance.now()/1e3,this.isRunning=!0,window.requestAnimationFrame(this._decreaseTimer.bind(this))):this.pause()}pause(){this.isRunning=!1}_decreaseTimer(timestamp){if(this.isRunning){if(this.currentTime<=0&&!this.countUp||this.currentTime>=this.startTime&&this.countUp)return this.currentTime=this.countUp?this.startTime:0,this.pause(),void this.dispatchEvent(new CustomEvent("simple-timer-end",{bubbles:!0,cancelable:!0,composed:!0,detail:!0}));var now=timestamp/1e3,progress=now-this._elapsed;this.currentTime=this.countUp?this.currentTime+progress:this.currentTime-progress,this._formattedTime=this._formatTime(this.currentTime),this._elapsed=now,window.requestAnimationFrame(this._decreaseTimer.bind(this))}}_formatTime(time){var timeString=time.toString().split(".");return 0===timeString[0].indexOf("-")?0:timeString[0]+"."+timeString[1].substring(0,2)}}window.customElements.define(SimpleTimer.tag,SimpleTimer);export{SimpleTimer};