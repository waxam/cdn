function valueMapTransform(e,t){let n=[];return t&&e.forEach(e=>{let r={};for(var a in t){let n=t[a];if(!0===n||!1===n||null===n)r[a]=n;else if("function"==typeof n)try{r[a]=n(e)}catch(e){console.warn(e)}else"string"==typeof n&&varExists(e,n)?r[a]=varGet(e,n):r[a]=n}n.push(r)}),n}function dashToCamelCase(e){return e.toLowerCase().replace(/-(.)/g,(function(e,t){return t.toUpperCase()}))}function camelToDash(e){return e.replace(/\W+/g,"-").replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase()}function dashToCamel(e){return e.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}))}function haxElementToNode(e){let t=e.tag,n=e.content?e.content:"",r=e.properties?e.properties:{};window.HaxStore&&window.HaxStore.instance&&window.HaxStore.instance._isSandboxed&&"iframe"===t&&(t="webview");var a=document.createElement(t);a.innerHTML=n;var i=a.cloneNode(!0);for(var o in r){let e=camelToDash(o);r.hasOwnProperty(o)&&(!0===r[o]?i.setAttribute(e,r[o]):!1===r[o]?i.removeAttribute(e):null!=r[o]&&r[o].constructor===Array?a.properties&&a.properties[o]&&a.properties[o].readOnly||(i.set?i.set(e,r[o]):i[e]=[...r[o]]):null!=r[o]&&r[o].constructor===Object?a.properties&&a.properties[o]&&a.properties[o].readOnly||(i.set?i.set(e,r[o]):i[e]={...r[o]}):i.setAttribute(e,r[o]))}return i}function camelCaseToDash(e){return e.replace(/([A-Z])/g,e=>`-${e[0].toLowerCase()}`)}function encapScript(e){return e&&"function"==typeof e.replace&&(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/<script[\s\S]*?>/gi,"&lt;script&gt;")).replace(/<\/script>/gi,"&lt;/script&gt;")).replace(/<hax[\s\S]*?>/gi,"")).replace(/<\/hax[\s\S]*?>/gi,"")).replace(/<h-a-x[\s\S]*?>/gi,"")).replace(/<\/h-a-x*?>/gi,"")).replace(/<style[\s\S]*?>/gi,"&lt;style&gt;")).replace(/<\/style>/gi,"&lt;/style&gt;")).replace(/<template[\s\S]*?>[\s\S]*?&lt;script[\s\S]*?&gt;[\s\S]*?&lt;\/script&gt;/gi,(function(e,t,n,r){return e=(e=(e=(e=e.replace("&lt;script&gt;","<script>")).replace("&lt;/script&gt;","<\/script>")).replace("&lt;style&gt;","<style>")).replace("&lt;/style&gt;","</style>")}))),e}function findTagsInHTML(e){let t={},n="";var r=e.match(/<\/([a-z,0-9]*?)-(\S*?)>/g);for(var a in r)n=r[a].replace("</","").replace(">",""),t[n]=n;return t}function wipeSlot(e,t="*"){if("*"===t)for(;null!==e.firstChild;)e.removeChild(e.firstChild);else for(var n in e.childNodes)void 0!==e.childNodes[n]&&e.childNodes[n].slot===t&&e.removeChild(e.childNodes[n])}function generateResourceID(e="#"){function idPart(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e+idPart()+idPart()+"-"+idPart()+"-"+idPart()+"-"+idPart()+"-"+idPart()+idPart()+idPart()}function stripMSWord(e){var t=e.split("\n\r").join("\n").split("\r").join("\n").split("\n\n").join("\n").split("\n\n").join("\n").split("\n\n").join("\n").split("\n").join(" ").replace(/( class=(")?Mso[a-zA-Z]+(")?)/g,"");t=(t=(t=t.replace(/<\!--(\s|.)*?-->/gim,"")).replace(/<\!(\s|.)*?>/gim,"")).replace(/<(\/)*(meta|link|html|head|body|span|font|br|\\\\?xml:|xml|st1:|o:|w:|m:|v:)(\s|.)*?>/gim,"");var n=["style","script","applet","embed","noframes","noscript"];for(var r in n){let e=new RegExp("<"+n[r]+"(s|.)*?"+n[r]+"(.*?)>","gim");t=t.replace(e,"")}for(var r in t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/ style='(\s|.)*?'/gim,"")).replace(/ face="(\s|.)*?"/gim,"")).replace(/ align=.*? /g,"")).replace(/ start='.*?'/g,"")).replace(/ dir="(\s|.)*?"/gim,"")).replace(/ role="(\s|.)*?"/gim,"")).replace(/ id="(\s|.)*?"/gim,"")).replace(/ style="(\s|.)*?"/gim,"")).replace(/ data-editable="(\s|.)*?"/gim,"")).replace(/ data-hax-ray="(\s|.)*?"/gim,"")).replace(/ class=""/gim,"")).replace(/ class="hax-active"/gim,"")).replace(/ contenteditable="(\s|.)*?"/gim,"")).replace(/&nbsp;/gm," ")).replace(/<p><p>/gm,"<p>")).replace(/<p><p>/gm,"<p>")).replace(/<\/p><\/p>/gm,"</p>")).replace(/<\/p><\/p>/gm,"</p>")).replace(/<b><p>/gm,"<p>")).replace(/<\/p><\/b>/gm,"</p>")).replace(/<span><p>/gm,"<p>")).replace(/<\/p><\/span>/gm,"</p>")).replace(/<p>(\s*)<\/p>/gm," ")).replace(/<p><\/p>/gm,"")).replace(/<p>&nbsp;<\/p>/gm," ")).replace(/<p><br\/><\/p>/gm,"")).replace(/<p><br><\/p>/gm,"")).replace(/<\/p>(\s*)<p>/gm,"</p><p>"),n){let e=new RegExp("<"+n[r]+"></"+n[r]+">","gi");t=t.replace(e,"")}return t=t.trim()}function varExists(e,t){return"__failedToFind__"!=objectValFromStringPos(e,t,"__failedToFind__")}function varGet(e,t,n=""){return objectValFromStringPos(e,t,n)}function objectValFromStringPos(e,t,n=null){for(var r=(t=(t=t.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),a=0,i=r.length;a<i;++a){var o=r[a];if(!e)return n;if(!(o in e))return n;e=e[o]}return e}function nodeToHaxElement(e,t="insert-element"){if(!e)return null;var n={};let r;if(void 0!==e.style&&(n.style=e.getAttribute("style")),null!==n.style&&"null"!==n.style||delete n.style,void 0!==e.attributes.class&&(n.class=e.attributes.class.nodeValue.replace("hax-active","")),void 0!==e.attributes.id&&(n.id=e.getAttribute("id")),customElements.get(e.tagName.toLowerCase())&&(r=customElements.get(e.tagName.toLowerCase()).properties),void 0===r&&(r=e.__data),void 0!==r){for(var a in r)"class"!=a&&"style"!=a&&r.hasOwnProperty(a)&&void 0!==typeof e[a]&&null!=e[a]&&""!=e[a]?n[a]=e[a]:!1===e[a]&&(n[a]=e[a]);for(var i in e.attributes)void 0!==e.attributes[i].name&&"class"!=e.attributes[i].name&&"style"!=e.attributes[i].name&&"id"!=e.attributes[i].name&&e.attributes.hasOwnProperty(i)&&void 0!==typeof e.attributes[i].value&&null!=e.attributes[i].value&&""!=e.attributes[i].value&&!r.hasOwnProperty(window.HaxStore.dashToCamel(e.attributes[i].name))&&(n[window.HaxStore.dashToCamel(e.attributes[i].name)]=e.attributes[i].value)}else for(var i in e.attributes)void 0!==e.attributes[i].name&&"class"!=e.attributes[i].name&&"style"!=e.attributes[i].name&&"id"!=e.attributes[i].name&&e.attributes.hasOwnProperty(i)&&void 0!==typeof e.attributes[i].value&&null!=e.attributes[i].value&&""!=e.attributes[i].value&&(n[window.HaxStore.dashToCamel(e.attributes[i].name)]=e.attributes[i].value);let o=e.tagName.toLowerCase();window.HaxStore.instance._isSandboxed&&"iframe"===o&&(o="webview");let l=window.HaxStore.getHAXSlot(e);""==l&&(l=e.innerText),"a"===o?n.innerText=l:"p"!==o&&"table"!==o&&"ol"!==o&&"ul"!==o&&"div"!==o||(n.innerHTML=l);let s={tag:o,properties:n,content:l};return null!==t&&(s.eventName=t),s}export const winEventsElement=function(e){return class extends e{__applyWinEvents(e){if(this.__winEvents)for(var t in this.__winEvents)window[`${e?"add":"remove"}EventListener`](t,this[this.__winEvents[t]].bind(this))}connectedCallback(){super.connectedCallback&&super.connectedCallback(),this.__applyWinEvents(!0)}disconnectedCallback(){this.__applyWinEvents(!1),super.disconnectedCallback&&super.disconnectedCallback()}}};export{valueMapTransform,dashToCamelCase,haxElementToNode,dashToCamel,camelToDash,camelCaseToDash,encapScript,findTagsInHTML,wipeSlot,generateResourceID,stripMSWord,varExists,varGet,objectValFromStringPos,nodeToHaxElement};const e=[Node.ELEMENT_NODE,Node.TEXT_NODE,Node.DOCUMENT_FRAGMENT_NODE];function findNode(t,n,r){const a=n.childNodes||n.children;if(!a)return n;for(let n=0;n<a.length;++n){const o=a[r?n:a.length-1-n];if((i=o,e.includes(i.nodeType))&&t.containsNode(o,!0))return t.containsNode(o,!1)?o:findNode(t,o,r)}var i;return n}const t=(()=>{if(document.createElement("div").attachShadow({mode:"open"}).getSelection)return document.addEventListener("selectionchange",e=>{document.dispatchEvent(new CustomEvent("-shadow-selectionchange"))}),()=>{};let e=!1;const t=[];return document.addEventListener("selectionchange",n=>{e||(document.dispatchEvent(new CustomEvent("-shadow-selectionchange")),e=!0,window.setTimeout(()=>{e=!1},0),t.forEach(e=>e(n)))}),e=>t.push(e)})();let n=!1,r=null;function containsNextElement(e,t,n){const r=t;for(;(t=walkFromNode(t,n))&&t.contains(r););return!!t&&(t instanceof Element&&e.containsNode(t,!0))}function walkFromNode(e,t){if(!t)return e.previousSibling||e.parentNode||null;for(;e;){if(e.nextSibling)return e.nextSibling;e=e.parentNode}return null}function initialSpace(e){return e.nodeType!==Node.TEXT_NODE?0:/^\s*/.exec(e.textContent)[0].length}t(e=>{"Caret"===window.getSelection().type?n=!0:n&&!r&&(r=Promise.resolve(!0).then(()=>{n=!1,r=null}))});const a=new Map;export function getRange(e){if(e.getSelection){const t=e.getSelection();return t.rangeCount?t.getRangeAt(0):null}const t=a.get(e);if(t)return t;const n=window.getSelection().toString(),r=internalGetShadowSelection(e),i=r.range&&r.range.toString()||null;return null!==i&&i!==n&&i.replace(/\s/g,"")!==n.replace(/\s/g,"")&&(console.warn("invalid range, initial text:",n),console.warn("vs",i,r.mode,r.range)),a.set(e,r.range),window.setTimeout(()=>{a.delete(e)},0),r.range}const i=document.createTextNode("");export function internalGetShadowSelection(e){const t=document.createRange(),r=window.getSelection();if(!r.containsNode(e.host,!0))return{range:null,mode:"none"};e.insertBefore(i,e.childNodes[0]);const a=r.containsNode(i);if(i.remove(),a)return{range:null,mode:"outside-before"};e.appendChild(i);const o=r.containsNode(i);if(i.remove(),o)return{range:null,mode:"outside-after"};const measure=()=>r.toString().length;r.toString();if("Caret"!==r.type&&"Range"!==r.type)throw new TypeError("unexpected type: "+r.type);r.type;const l=findNode(r,e,!0);let s,c=void 0;if("Range"===r.type&&(s=findNode(r,e,!1),c=function getSelectionDirection(e,t,r){if("Range"!==e.type)return;const measure=()=>e.toString().length,a=measure();if(1===a&&n&&t===r)return e.extend(t,0),void e.collapseToEnd();let i;return e.modify("extend","forward","character"),i=measure(),i>a||containsNextElement(e,r,!0)?(e.modify("extend","backward","character"),!0):i<a||!e.containsNode(t)?(e.modify("extend","backward","character"),!1):(e.modify("extend","backward","character"),i=measure(),i>a||containsNextElement(e,t,!1)?(e.modify("extend","forward","character"),!1):i<a||!e.containsNode(r)?(e.modify("extend","forward","character"),!0):void 0)}(r,l,s)),"Caret"===r.type){r.extend(l,0);const e=measure();return r.collapseToEnd(),t.setStart(l,e),t.setEnd(l,e),{range:t,mode:"caret"}}if(void 0===c){if("Range"!==r.type)throw new TypeError("unexpected type: "+r.type);return t.setStart(l,0),t.setEnd(s,s.length),{range:t,mode:"all"}}const p=measure();let d,u;const g=s.length-function ignoredTrailingSpace(e){if(e.nodeType!==Node.TEXT_NODE)return 0;const t=/\s*$/.exec(e.textContent)[0].length;return t?t-1:0}(s);return c?(r.extend(l,0),d=measure()+initialSpace(l),r.extend(s,g),u=g-(measure()-p),r.extend(s,u)):(r.extend(s,g),u=g-measure(),r.extend(l,0),d=measure()-p+initialSpace(l),r.extend(l,d)),t.setStart(l,d),t.setEnd(s,u),{mode:c?"right":"left",range:t}}