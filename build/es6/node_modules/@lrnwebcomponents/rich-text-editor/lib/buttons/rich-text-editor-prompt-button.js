/**
 * Copyright 2019 Penn State University
 * @license Apache-2.0, see License.md for full text.
 */
import{LitElement as t,html as e,css as i}from"../../../../lit-element/lit-element.js";import{RichTextEditorButtonBehaviors as n}from"./rich-text-editor-button.js";import"../singletons/rich-text-editor-selection.js";import"../singletons/rich-text-editor-prompt.js";const RichTextEditorPromptButtonBehaviors=function(t){return class extends(n(t)){static get tag(){return"rich-text-editor-prompt-button"}render(){return super.render()}static get properties(){return{...super.properties,fields:{type:Array},inlineWidget:{name:"inlineWidget",type:Boolean},id:{name:"id",type:String,reflect:!0,attribute:"id"},tag:{name:"tag",type:String},value:{type:Object},prompt:{name:"prompt",type:Object},__wrap:{name:"__wrap",type:Object},__oldValue:{name:"__oldValue",type:Object}}}constructor(){super(),this.editableSelection=!1,this.inlineWidget=!1,this.fields=[{property:"innerHTML",title:"Text",inputMethod:"textfield"}],this.tag="span",this.value={innerHTML:void 0},this.prompt=window.RichTextEditorPrompt.requestAvailability()}get promptCommand(){return this.toggledCommand&&!this.toggled?this.toggledCommand:this.command}get promptCommandVal(){return this.commandVal}get setsInnerHTML(){let t=(this.fields||[]).filter(t=>"innerHTML"===t.property);return t&&t.length>0}cancel(){}confirm(t){this.value=t,this.update(),this.setToggled(),this.promptCommandVal,this.updateSelection()}expandSelection(){let t=this.rangeQuery();t&&this.highlightNode(t)}getInnerHTML(){let t,e,i=this.range&&this.range.cloneContents?this.range.cloneContents():void 0,n=this.rangeElement()?this.rangeElement():void 0;return this.rangeIsElement()?e=n?n.innerHTML:void 0:(t=document.createElement("span"),i&&t.appendChild(i),e=t.innerHTML,t.remove()),e}getPropValue(t){let e=!!this.value&&this.value,i=!(!e||!e[t])&&(e[t].trim?e[t].trim():e[t]);return!(!i||""===i)&&i}getValue(){return{innerHTML:this.getInnerHTML()||""}}open(){this.expandSelection(),this.value=this.getValue(),this.prompt.fields=[...this.fields],this.prompt.value={...this.value},this.dispatchEvent(new CustomEvent("rich-text-editor-prompt-open",{bubbles:!0,cancelable:!0,composed:!0,detail:this}))}setInnerHTML(t){let e=this.rangeElement();e&&this.rangeIsElement()?e.innerHTML=t:this.range&&this.sendCommand("insertHtml",t)}setToggled(){this.toggled=!this.value}updateSelection(){let t=this.range.cloneRange();this.sendCommand(this.promptCommand,this.promptCommandVal),this.selectRange(t),this.setsInnerHTML&&this.setInnerHTML(this.getPropValue("innerHTML"))}_buttonTap(t){t.preventDefault(),this.open()}_rangeChanged(t,e){this.value=this.getValue(),this.setToggled()}}};class RichTextEditorPromptButton extends(RichTextEditorPromptButtonBehaviors(t)){}window.customElements.define(RichTextEditorPromptButton.tag,RichTextEditorPromptButton);export{RichTextEditorPromptButton,RichTextEditorPromptButtonBehaviors};