import{html,PolymerElement}from"../../../@polymer/polymer/polymer-element.js";import{A11yMediaBehaviors}from"./a11y-media-behaviors.js";export{A11yMediaHtml5};class A11yMediaHtml5 extends A11yMediaBehaviors{static get properties(){return{controls:{type:String,value:"video"},crossorigin:{type:String,value:null},disabled:{type:Boolean,value:null},icon:{type:String,value:null},label:{type:String,value:null},mediaLang:{name:"mediaLang",type:String,value:"en"},paused:{type:Boolean,value:!0},seekable:{type:Object,value:{length:0,start:null,stop:null}},thumbnailSrc:{name:"thumbnailSrc",type:String,value:null,reflectToAttribute:!0}}}static get tag(){return"a11y-media-html5"}constructor(){super(),this.inheritStyles=!0}static get template(){return html`
      <style>
        :host {
          height: 100%;
          display: flex;
          align-items: stretch;
          position: relative;
        }
        :host([hidden]) {
          display: none;
        }
        #video {
          width: 100%;
          max-width: 100%;
        }
      </style>
      <video
        id="video"
        aria-hidden$="[[isYoutube]]"
        autoplay$="[[autoplay]]"
        crossorigin$="[[crossorigin]]"
        hidden$="[[audioOnly]]"
        lang$="[[mediaLang]]"
        on-loadedmetadata="_handleMetadata"
        poster$="[[thumbnailSrc]]"
        src$="[[manifest]]"
        preload="metadata"
      >
        HTML5 video not supported
      </video>
      <audio
        id="audio"
        autoplay$="[[autoplay]]"
        crossorigin$="[[crossorigin]]"
        hidden$="[[!audioOnly]]"
        lang$="[[mediaLang]]"
        on-loadedmetadata="_handleMetadata"
        poster$="[[thumbnailSrc]]"
        preload="metadata"
      >
        HTML5 audio not supported
      </audio>
    `}connectedCallback(){super.connectedCallback()}ready(){super.ready();this.media=void 0===this.$.video||this.audioOnly?this.$.audio:this.$.video}_handleMetadata(){this.duration=this.media.duration>0?this.media.duration:0,this.tracks=[],this.volume=this.muted?0:Math.max(this.volume,10),this.seekable=this.media.seekable,this.setVolume(this.volume),this.setMute(this.muted),this.setCC(this.cc),this.setLoop(this.loop),this.setPlaybackRate(this.playbackRate),this.aspectRatio=this.media.videoWidth/this.media.videoHeight,this.dispatchEvent(new CustomEvent("media-loaded",{detail:this}))}getBufferedTime(){return this.media.buffered.length>0?this.media.buffered.end(0):this.getCurrentTime()}getCurrentTime(){return this.media.currentTime}play(){this.paused=!1,this.media.play()}pause(){this.paused=!0,this.media.pause()}selectTrack(index){this.selectedTrack=this.media.textTracks[index];for(let i=0;i<this.media.textTracks.length;i++)parseInt(index)===i?this.media.textTracks[i].mode="showing":null!==this.media.textTracks[i]&&(this.media.textTracks[i].mode="hidden")}stop(){this.pause(),this.seek(0)}restart(){this.seek(0),this.play()}seek(time){this.media.currentTime=time}setCC(mode){this.media.cc=!0===mode,void 0!==this.selectedTrack&&1==mode?(this.selectedTrack.mode="showing",this.$.video.textTracks.value=this.selectedTrackId):void 0!==this.selectedTrack&&null!==this.selectedTrack&&(this.selectedTrack.mode="hidden",this.$.video.textTracks.value="")}setVolume(value){this.media.volume=value/100}setPlaybackRate(value){this.media.playbackRate=null!==value?value:1}setLoop(mode){this.media.loop=!0===mode}setMute(mode){this.media.muted=mode}}window.customElements.define(A11yMediaHtml5.tag,A11yMediaHtml5);