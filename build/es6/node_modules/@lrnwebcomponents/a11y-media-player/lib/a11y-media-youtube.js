import{html,PolymerElement}from"../../../@polymer/polymer/polymer-element.js";window.A11yMediaYoutube=window.A11yMediaYoutube||{};window.A11yMediaYoutube.requestAvailability=()=>{if(!window.A11yMediaYoutube.instance){window.A11yMediaYoutube.instance=document.createElement("a11y-media-youtube");document.body.appendChild(window.A11yMediaYoutube.instance)}return window.A11yMediaYoutube.instance};class A11yMediaYoutube extends PolymerElement{static get tag(){return"a11y-media-youtube"}static get properties(){return{apiReady:{type:"Boolean",value:window.YT!==void 0},counter:{type:"Number",value:0}}}connectedCallback(){super.connectedCallback();let root=this,api=document.createElement("script");api.setAttribute("src","https://www.youtube.com/iframe_api");api.setAttribute("type","text/javascript");document.body.appendChild(api);window.onYouTubeIframeAPIReady=()=>{var event=new CustomEvent("youtube-api-ready");root.apiReady=!0;document.dispatchEvent(event)}}initYoutubePlayer(options){let temp="a11y-media-yt-",div=document.createElement("div"),vdata=options.videoId.split(/[\?&]/),vid=vdata[0],start=null,end=null,cue={videoId:vid};this.counter++;temp+=this.counter;document.body.appendChild(div);div.setAttribute("id",temp);let loadVideo=e=>{var _Mathmax=Math.max;for(let i=1,param;i<vdata.length;i++){param=vdata[i].split("=");if("t"===param[0]){let hh=param[1].match(/(\d)+h/),mm=param[1].match(/(\d)+m/),ss=param[1].replace(/\d+h/,"").replace(/\d+m/,"").replace(/s/,"").match(/(\d)+/),h=null!==hh&&1<hh.length?360*parseInt(hh[1]):0,m=null!==mm&&1<mm.length?60*parseInt(mm[1]):0,s=null!==ss&&1<ss.length?parseInt(ss[1]):0;start=parseInt(h+m+s)}else if("start"===param[0]){start=parseInt(param[1])}else if("end"===param[0]){end=parseInt(param[1])}}if(null!==start){start=_Mathmax(0,start);cue.startSeconds=start}if(null!==end){end=null!==start?_Mathmax(start,end):_Mathmax(0,end);cue.endSeconds=end}e.target.cueVideoById(cue)},iframe=new YT.Player(temp,{width:options.width,height:options.height,events:{onReady:loadVideo},playerVars:{color:"white",controls:0,autoplay:options.autoplay,disablekb:1,enablejsapi:1,iv_load_policy:3,modestbranding:1,showinfo:0,rel:0}});iframe.tracks=[];iframe.seekable={length:0};iframe.duration=0;iframe.paused=!0;iframe.timeupdate;iframe.play=()=>{if(iframe.playVideo!==void 0)iframe.playVideo()};iframe.addEventListener("onStateChange",()=>{iframe.paused=1!==iframe.getPlayerState();if(iframe.paused){clearInterval(iframe.timeupdate)}else{iframe.timeupdate=setInterval(()=>{document.dispatchEvent(new CustomEvent("timeupdate",{detail:iframe}))},1)}});iframe.pause=()=>{if(iframe.pauseVideo!==void 0)iframe.pauseVideo()};iframe.seek=(time=0)=>{if(iframe.seekTo!==void 0){iframe.pause();iframe.seekTo(time);document.dispatchEvent(new CustomEvent("timeupdate",{detail:iframe}))}};iframe.setMute=mode=>{if(iframe.mute!==void 0)mode?iframe.mute():iframe.unMute()};return iframe}}window.customElements.define(A11yMediaYoutube.tag,A11yMediaYoutube);export{A11yMediaYoutube};