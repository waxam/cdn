/**
 * Copyright 2019 Penn State University
 * @license Apache-2.0, see License.md for full text.
 */
import{SimplePicker as t}from"../simple-picker/simple-picker.js";import{IronMeta as e}from"../../@polymer/iron-meta/iron-meta.js";class SimpleIconPicker extends t{static get properties(){return{...super.properties,allowNull:{type:Boolean},icons:{type:Array},value:{type:String,reflect:!0},optionsPerRow:{type:Number},__iconList:{type:Array}}}static get tag(){return"simple-icon-picker"}constructor(){super(),this.hideOptionLabels=!0,this.allowNull=!1,this.icons=[],this.value=null,this.options=[],this.optionsPerRow=10}updated(t){super.updated&&super.updated(t),t.forEach((t,e)=>{["optionsPerRow","icons","allowNull","__iconList"].includes(e)&&(clearTimeout(this.__rebuild),this.__rebuild=setTimeout(()=>{setTimeout(()=>{this._getOptions()},100)},0)),"value"==e&&this.dispatchEvent(new CustomEvent("value-changed",{detail:{value:this[e]}}))})}firstUpdated(t){super.firstUpdated&&super.firstUpdated(t);const i=new e({type:"iconset"});if(0===this.icons.length&&void 0!==i&&i.list&&i.list.length){var s=[];i.list.forEach((function(t){t.getIconNames().forEach(t=>{s.push(t)})})),this.__iconList=s,this._setSelectedOption()}}_getOptions(){let t="string"==typeof this.icons?JSON.parse(this.icons):this.icons,e=this.optionsPerRow;0===t.length&&this.__iconList&&this.__iconList.length>0&&(t=this.__iconList);let i=!1===this.allowNull?[]:[[{alt:"null",value:null}]],s=!1===this.allowNull?0:1;e=Math.sqrt(t.length+s)<=this.optionsPerRow?Math.ceil(Math.sqrt(t.length+s)):this.optionsPerRow;for(let o=0;o<t.length;o++){let l=s+o,n=Math.floor(l/e),r=l-n*e;void 0!==i[n]&&null!==i[n]||(i[n]=[]),i[n][r]={alt:t[o],icon:t[o],value:t[o]}}this.options=i}_setSelectedOption(){this.options.length>1&&super._setSelectedOption()}}window.customElements.define(SimpleIconPicker.tag,SimpleIconPicker);export{SimpleIconPicker};