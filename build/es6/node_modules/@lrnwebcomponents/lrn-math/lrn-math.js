const t=window.document,e=1,n=2,o=3,r=4,a=5;let i,s,l=[],c=e,h="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js";function flush_typesets(){if(!l.length)return;const e=[],n=[];l.forEach((function(o){const r=t.createElement("script"),a=t.createElement("div");r.type=o[1]?"math/tex; mode=display":"math/tex",r.text=o[0],a.style.position="fixed",a.style.top=0,a.style.left="99999px",a.appendChild(r),t.body.appendChild(a),e.push(r),n.push([a,o[2]])})),l=[],c=r,i.Queue(["Typeset",i,e]),i.Queue((function(){s||function getStyleNode(){const e=t.querySelectorAll("style"),n=Array.prototype.filter.call(e,(function(t){return t.sheet&&t.sheet.cssRules.length>100&&".mjx-chtml"===t.sheet.cssRules[0].selectorText}));s=n[0]}(),n.forEach((function(e){const n=e[0],o="SPAN"===n.firstElementChild.tagName?n.firstElementChild:null;e[1](o,s),t.body.removeChild(n)})),c=o,flush_typesets()}))}function load_library(){c=n,window.MathJax={skipStartupTypeset:!0,showMathMenu:!1,jax:["input/TeX","output/CommonHTML"],TeX:{extensions:["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]},AuthorInit(){i=window.MathJax.Hub,i.Register.StartupHook("End",(function(){c=o,flush_typesets()}))}};var e=t.createElement("script");e.type="text/javascript",e.src=h,e.async=!0,e.onerror=function(){console.warn("Error loading MathJax library "+h),c=a,l=[]},t.head.appendChild(e)}class LrnMathController extends HTMLElement{connectedCallback(){this.hasAttribute("src")&&(h=this.getAttribute("src")),this.hasAttribute("lazy")||load_library()}typeset(t,n,r){c!==a&&(l.push([t,n,r]),c===e?load_library():c===o&&flush_typesets())}}export{LrnMathController};window.customElements.define("lrn-math-controller",LrnMathController);const d={childList:!0,characterData:!0,attributes:!0,subtree:!0};let u;function update(t){const e=t.shadowRoot,n=t.textContent.trim(),o="display"===t.getAttribute("mode"),r=(o?"D":"I")+n;if(r!==t._private.check){for(;e.firstChild;)e.removeChild(e.firstChild);t._private.check=r,n.length&&u.typeset(n,o,(function(t,n){e.appendChild(n.cloneNode(!0)),e.appendChild(t)}))}}class LrnMath extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}static get tag(){return"lrn-math"}connectedCallback(){const e=this;!function check_handler(){u||(u=t.querySelector("lrn-math-controller")||t.createElement("lrn-math-controller"),u.setAttribute("lazy","lazy"),u&&"function"==typeof u.typeset?t.contains(u)||t.head.appendChild(u):(console.warn("no %s element defined; %s element will not work","lrn-math-controller","lrn-math"),u=void 0))}(),window.requestAnimationFrame((function(){e._private={check:"",observer:new MutationObserver((function(){update(e)}))},update(e),e._private.observer.observe(e,d)}))}static get haxProperties(){return{canScale:!0,canPosition:!0,canEditSource:!0,gizmo:{title:"Math",description:"Present math in a nice looking way.",icon:"hax:pi",iconLib:"@lrnwebcomponents/hax-iconset/hax-iconset.js",color:"grey",groups:["Content"],handles:[{type:"math",math:"mathText"},{type:"inline",text:"mathText"}],meta:{author:"ELMS:LN",inlineOnly:!0}},settings:{quick:[],configure:[{slot:"",title:"Math",description:"Enter equation as MathML",inputMethod:"code-editor",icon:"editor:format-quote"}],advanced:[]}}}refresh(){let e=t.createElement("lrn-math");this.parentNode.insertBefore(e,this),e.innerHTML=this.innerHTML,this.remove()}disconnectedCallback(){this._private&&(this._private.observer.disconnect(),delete this._private)}}window.customElements.define(LrnMath.tag,LrnMath);export{LrnMath};