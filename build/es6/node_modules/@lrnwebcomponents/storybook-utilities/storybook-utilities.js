import{storiesOf}from"../../@storybook/polymer/dist/client/index.js";import*as storybookBridge from"../../@storybook/addon-knobs/polymer.js";export class StorybookUtilities{cleanHTML(template,replacements=[]){let pattern=/<body[^>]*>((.|[\n\r])*)<\/body>/im;var array_matches=pattern.exec(template);template=array_matches[1];replacements.forEach(replacement=>{template=template.replace(new RegExp(replacement.find,"g"),replacement.replace)});template=template.replace(/=\\"\\"/g,"").replace(/\\"/g,"\"");return template}addPattern(story){let template=this.cleanHTML(story.file,story.replacements);story.demo=storiesOf(story.of,module);story.demo.add(story.name,()=>{return`${template}`})}getBindings(props){let binding={};for(var key in props){if(!props.hasOwnProperty(key))continue;let editable=!1===key.startsWith("__")&&(props[key].computed===void 0||"undefined"===props[key].computed)&&!0!==props[key].readOnly;if(editable){let val=`${props[key].value}`,keyType=props[key].type.name||props[key].type;if(keyType){let method=keyType.toLowerCase(),kebab=key.replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,function(match){return"-"+match.toLowerCase()});binding[key]={id:kebab,value:"select"===method?storybookBridge.select(key,props[key].options||[],props[key].value):"number"===method?storybookBridge.number(key,parseFloat(props[key].value)):"boolean"===method?storybookBridge.boolean(key,!1):"date"===method?storybookBridge.date(key,new Date(props[key].value)):"files"===method?storybookBridge.files(key,props[key].options||{},props[key].value||""):"radios"===method?storybookBridge.radios(key,props[key].options||{},props[key].value):"object"===method?storybookBridge.text(key,JSON.stringify(props[key].value||{})):"array"===method?storybookBridge.text(key,JSON.stringify(props[key].value||{})):"options"===method?storybookBridge.radios(key,props[key].valuesObj||{},props[key].value,props[key].options||{}):storybookBridge.text(key,props[key].value||``)}}}}return binding}addLiveDemo(story){story.demo=storiesOf(story.of,module);story.demo.addDecorator(storybookBridge.withKnobs);story.demo.add(story.name,()=>{story.slotted2=``;Object.values(this.getBindings(story.slots)).forEach(slot=>{story.slotted2+="slot"!==slot.id?`<div slot="${slot.id}">${slot.value}</div>`:`${slot.value}`});story.attr2=``;Object.values(this.getBindings(story.props)).forEach(prop=>{if(!1!==prop.value&&""!==prop.value)story.attr2+=` ${prop.id}="${prop.value}"`});return`
        <h1>${story.name}</h1>
        <${story.name}${story.attr2}${story.attr}>
          ${story.slotted2}
          ${story.slotted}
        </${story.name}>
      `},{knobs:{escapeHTML:!1}})}}window.StorybookUtilities=window.StorybookUtilities||{};window.StorybookUtilities.requestAvailability=()=>{if(!window.StorybookUtilities.instance){window.StorybookUtilities.instance=new StorybookUtilities}};