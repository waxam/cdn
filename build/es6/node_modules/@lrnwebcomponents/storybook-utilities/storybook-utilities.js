import{storiesOf}from"../../@storybook/polymer/dist/client/index.js";import*as storybookBridge from"../../@storybook/addon-knobs/polymer.js";import"../simple-colors/lib/simple-colors-polymer.js";import"../es-global-bridge/es-global-bridge.js";
/**
 * Copyright 2018 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */export class StorybookUtilities{cleanHTML(template,replacements=[]){var array_matches=/<body[^>]*>((.|[\n\r])*)<\/body>/im.exec(template);return template=array_matches[1],replacements.forEach(replacement=>{template=template.replace(new RegExp(replacement.find,"g"),replacement.replace)}),template=template.replace(/=\\"\\"/g,"").replace(/\\"/g,'"')}addPattern(story){let template=this.cleanHTML(story.file,story.replacements);return story.before=story.before||"",story.after=story.after||"",story.demo=storiesOf(story.of,module),story.demo.add(story.name,()=>`${story.before}${template}${story.after}`),[story.before,template,story.after]}getBindings(props){let binding={};return Object.keys(props).sort().forEach(key=>{if(!1===key.startsWith("__")&&(void 0===props[key].computed||"undefined"===props[key].computed)&&!0!==props[key].readOnly){let keyType=props[key].type.name||props[key].type;if(keyType){let method=keyType.toLowerCase(),stringifiedVal=JSON.stringify(props[key].value||""),kebab=key.replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,(function(match){return"-"+match.toLowerCase()}));binding[key]={id:kebab,value:"select"===method?storybookBridge.select(key,props[key].options||[],props[key].value):"number"===method?storybookBridge.number(key,void 0!==props[key].value&&null!==props[key].value?parseFloat(props[key].value):""):"boolean"===method?storybookBridge.boolean(key,props[key].value):"date"===method?storybookBridge.date(key,new Date(props[key].value)):"files"===method?storybookBridge.files(key,props[key].options||{},props[key].value||""):"radios"===method?storybookBridge.radios(key,props[key].options||{},props[key].value||""):"object"===method?storybookBridge.text(key,stringifiedVal||"{}"):"array"===method?storybookBridge.text(key,stringifiedVal||"[]"):"options"===method?storybookBridge.radios(key,props[key].valuesObj||{},props[key].value||"",props[key].options||{}):storybookBridge.text(key,props[key].value||"")}}}}),binding}getSimpleColorsPolymer(color="blue"){return{accentColor:{name:"accentColor",type:"Select",value:color,options:Object.keys(window.SimpleColorsStyles.colors)},dark:{name:"dark",type:"Boolean",value:!1}}}addLiveDemo(story,escape=!1){story.alias=void 0!==story.alias?story.alias:story.name,story.before=void 0!==story.before?story.before:"",story.after=void 0!==story.after?story.after:"",story.attr=void 0!==story.attr?story.attr:"",story.slotted=void 0!==story.slotted?story.slotted:"",story.slots=void 0!==story.slots?story.slots:{},story.props=void 0!==story.props?story.props:{},story.demo=storiesOf(story.of,module),story.demo.addDecorator(storybookBridge.withKnobs),story.demo.add(story.alias,()=>(story.attrBindings="",Object.values(this.getBindings(story.props)).forEach(prop=>{!1!==prop.value&&""!==prop.value&&(story.attrBindings+="string"!=typeof prop.value?` ${prop.id}="${prop.value}"`:` ${prop.id}="${prop.value.replace(/'/g,"&apos;").replace(/"/g,"&quot;")}"`)}),story.slotBindings="",Object.values(this.getBindings(story.slots)).forEach(slot=>{story.slotBindings+="slot"!==slot.id?`<div slot="${slot.id}">${slot.value}</div>`:`${slot.value}`}),`\n        <h1>${story.alias}</h1>\n        ${story.before}\n        <${story.name}${story.attrBindings}${story.attr}>\n          ${story.slotBindings}\n          ${story.slotted}\n        </${story.name}>\n        ${story.after}\n      `),{knobs:{escapeHTML:escape}})}addGlobalScript(name,location){window.ESGlobalBridge.requestAvailability(),window.ESGlobalBridge.webpack||(window.ESGlobalBridge.webpack={}),window.ESGlobalBridge.webpack[name]=!0,window.ESGlobalBridge.instance.load(name,location,!0)}}window.StorybookUtilities=window.StorybookUtilities||{},window.StorybookUtilities.requestAvailability=()=>{window.StorybookUtilities.instance||(window.StorybookUtilities.instance=new StorybookUtilities)};