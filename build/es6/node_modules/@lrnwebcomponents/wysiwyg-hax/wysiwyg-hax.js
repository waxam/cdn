import{html,PolymerElement}from"../../@polymer/polymer/polymer-element.js";import"../cms-hax/cms-hax.js";import{FlattenedNodesObserver}from"../../@polymer/polymer/lib/utils/flattened-nodes-observer.js";class WysiwygHax extends PolymerElement{static get template(){return html`
      <style>
        :host {
          display: block;
        }
      </style>
      <textarea id\$="[[fieldId]]" name="[[fieldName]]" hidden="">
[[bodyValue]]</textarea
      >
      <cms-hax
        open-default="[[openDefault]]"
        hide-message=""
        body-offset-left="[[bodyOffsetLeft]]"
        update-page-data="[[updatePageData]]"
        end-point="[[endPoint]]"
        app-store-connection="[[appStoreConnection]]"
        hide-export-button="[[hideExportButton]]"
        align="[[align]]"
      >
      </cms-hax>
    `}static get tag(){return"wysiwyg-hax"}static get properties(){return{openDefault:{type:Boolean,value:!1},hideExportButton:{type:Boolean,value:!0},align:{type:String,value:"right"},bodyValue:{type:String},appStoreConnection:{type:Object},fieldId:{type:String,value:"textarea-input-field"},fieldName:{type:String,value:"data[content]"},bodyOffsetLeft:{type:Number,value:-22},editMode:{type:Boolean,reflectToAttribute:!0},endPoint:{type:String},updatePageData:{type:String},activeHaxBody:{type:Object,observer:"_activeHaxBodyUpdated"},__imported:{type:Boolean,value:!1}}}_attachDom(dom){this.appendChild(dom)}_activeHaxBodyUpdated(newValue,oldValue){if(null!=newValue&&!this.__imported){this.__imported=!0;let children=this.querySelector("template");null!=children&&(newValue.importContent(children.innerHTML),this.editMode=!1,window.HaxStore.write("editMode",this.editMode,this),setTimeout(()=>{this.editMode=!0,window.HaxStore.write("editMode",this.editMode,this)},200))}}connectedCallback(){super.connectedCallback(),document.body.addEventListener("hax-save",this._bodyContentUpdated.bind(this)),document.body.addEventListener("hax-store-property-updated",this._haxStorePropertyUpdated.bind(this))}disconnectedCallback(){document.body.removeEventListener("hax-save",this._bodyContentUpdated.bind(this)),document.body.removeEventListener("hax-store-property-updated",this._haxStorePropertyUpdated.bind(this)),super.disconnectedCallback()}_haxStorePropertyUpdated(e){e.detail&&void 0!==e.detail.value&&e.detail.property&&("object"==typeof e.detail.value&&this.set(e.detail.property,null),this.set(e.detail.property,e.detail.value))}_bodyContentUpdated(e){this.bodyValue=window.HaxStore.instance.activeHaxBody.haxToContent()}}window.customElements.define(WysiwygHax.tag,WysiwygHax);export{WysiwygHax};