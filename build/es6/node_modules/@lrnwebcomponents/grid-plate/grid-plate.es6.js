import{html,Polymer}from"./node_modules/@polymer/polymer/polymer-legacy.js";import{dom}from"./node_modules/@polymer/polymer/lib/legacy/polymer.dom.js";import*as async from"./node_modules/@polymer/polymer/lib/utils/async.js";import"./node_modules/@polymer/iron-a11y-keys/iron-a11y-keys.js";import"./node_modules/@polymer/paper-icon-button/paper-icon-button.js";import"./node_modules/@polymer/iron-icons/iron-icons.js";import"./node_modules/@lrnwebcomponents/hax-body-behaviors/lib/HAXWiring.js";import{SimpleColors}from"./node_modules/@lrnwebcomponents/simple-colors/simple-colors.js";import"./node_modules/@lrnwebcomponents/responsive-grid/lib/responsive-grid-row.js";import"./node_modules/@lrnwebcomponents/responsive-grid/lib/responsive-grid-col.js";let GridPlate=Polymer({_template:html`
    <custom-style>
      <style is="custom-style" include="simple-colors">
        :host {
          display: block;
        }

        responsive-grid-col {
          --responsive-grid-col-inner: {
            padding-left: 0;
            padding-right: 0;
          }
        }

        responsive-grid-row {
          --responsive-grid-row-inner: {
            margin-left: 0;
            margin-right: 0;
          }
        }

        :host([edit-mode]) responsive-grid-col.mover {
          min-height: 150px;
          background-color: #d1d1d1;
        }

        :host responsive-grid-row ::slotted(*) .mover,
        :host responsive-grid-col[data-draggable].mover {
          outline: 2px dotted #d1d1d1;
          outline-offset: 2px;
          background-color: rgba(240, 240, 240, 0.2);
        }

        :host responsive-grid-row ::slotted(*) .active-item {
          outline: 2px dashed #aaaaaa !important;
          outline-offset: 2px;
          background-color: rgba(220, 220, 220, 0.6) !important;
        }

        :host responsive-grid-row ::slotted(*) [data-draggable]:focus,
        :host responsive-grid-row ::slotted(*) [data-draggable]:hover,
        :host responsive-grid-row ::slotted(*) [data-draggable]:active {
          outline: 2px dotted #d1d1d1;
          outline-offset: 2px;
          background-color: rgba(240, 240, 240, 0.2);
          cursor: move !important;
        }

        paper-icon-button {
          display: none;
          position: absolute;
          margin: 0;
          padding: 0;
          outline: none;
          width: 20px;
          height: 20px;
          color: black;
          background-color: #eeeeee;
          border-radius: 50%;
          box-sizing: content-box !important;
          z-index: 1;
          min-width: unset;
        }

        paper-icon-button.active {
          display: block;
        }

        .button-holding-pen {
          position: relative;
        }
      </style>
    </custom-style>
    <div class="button-holding-pen">
      <paper-icon-button
        icon="icons:arrow-upward"
        title="move item up"
        id="up"
        on-tap="moveActiveElement"
      >
      </paper-icon-button>
      <paper-icon-button
        icon="icons:arrow-forward"
        title="move item right"
        id="right"
        on-tap="moveActiveElement"
      ></paper-icon-button>
      <paper-icon-button
        icon="icons:arrow-downward"
        title="move item down"
        id="down"
        on-tap="moveActiveElement"
      >
      </paper-icon-button>
      <paper-icon-button
        icon="icons:arrow-back"
        title="move item left"
        id="left"
        on-tap="moveActiveElement"
      >
      </paper-icon-button>
    </div>
    <responsive-grid-row gutter="0">
      <template is="dom-if" if="[[!hideCol1]]" strip-whitespace>
        <responsive-grid-col
          id="col1"
          style\$="background-color:[[__col1Color]];"
          xl\$="[[col1_xl]]"
          lg\$="[[col1_lg]]"
          md\$="[[col1_md]]"
          sm\$="[[col1_sm]]"
          xs\$="[[col1_xs]]"
        >
          <slot name="col-1"></slot>
        </responsive-grid-col>
      </template>
      <template is="dom-if" if="[[!hideCol2]]" strip-whitespace>
        <responsive-grid-col
          id="col2"
          style\$="background-color:[[__col2Color]];"
          xl\$="[[col2_xl]]"
          lg\$="[[col2_lg]]"
          md\$="[[col2_md]]"
          sm\$="[[col2_sm]]"
          xs\$="[[col2_xs]]"
        >
          <slot name="col-2"></slot>
        </responsive-grid-col>
      </template>
      <template is="dom-if" if="[[!hideCol3]]" strip-whitespace>
        <responsive-grid-col
          id="col3"
          style\$="background-color:[[__col3Color]];"
          xl\$="[[col3_xl]]"
          lg\$="[[col3_lg]]"
          md\$="[[col3_md]]"
          sm\$="[[col3_sm]]"
          xs\$="[[col3_xs]]"
        >
          <slot name="col-3"></slot>
        </responsive-grid-col>
      </template>
      <template is="dom-if" if="[[!hideCol4]]" strip-whitespace>
        <responsive-grid-col
          id="col4"
          style\$="background-color:[[__col4Color]];"
          xl\$="[[col4_xl]]"
          lg\$="[[col4_lg]]"
          md\$="[[col4_md]]"
          sm\$="[[col4_sm]]"
          xs\$="[[col4_xs]]"
        >
          <slot name="col-4"></slot>
        </responsive-grid-col>
      </template>
      <responsive-grid-col xl="12" lg="12" md="12" sm="12" xs="12">
        <slot></slot>
      </responsive-grid-col>
    </responsive-grid-row>
    <iron-a11y-keys
      stop-keyboard-event-propagation
      target="[[__activeItem]]"
      keys="enter"
      on-keys-pressed="setActiveElement"
    ></iron-a11y-keys>
    <iron-a11y-keys
      target="[[__activeItem]]"
      keys="esc"
      on-keys-pressed="cancelActive"
    ></iron-a11y-keys>
  `,is:"grid-plate",listeners:{focusin:"_focusIn",focusout:"_focusOut"},behaviors:[HAXBehaviors.PropertiesBehaviors],properties:{layout:{type:String,value:"12",observer:"_layoutChanged"},editMode:{reflectToAttribute:!0,type:Boolean,value:!1,observer:"_editModeChanged"},colors:{type:String,value:""},col1Color:{type:String,value:""},col2Color:{type:String,value:""},col3Color:{type:String,value:""},col4Color:{type:String,value:""},_colors:{type:String,computed:"_colorCreation(colors, col1Color, col2Color, col3Color, col4Color)",observer:"_colColors"},__activeItem:{type:Object,observer:"_activeItemChanged"}},cancelActive:function(){this.__activeItem=null},moveActiveElement:function(a){var b=dom(a),c=b.localTarget;let d=this.__activeItem.getAttribute("slot").split("-"),f=1,g=[1,2,3,4];for(var h in g)this["hideCol"+g[h]]||(f=g[h]);switch(c.id){case"up":null!==this.__activeItem.previousElementSibling&&dom(this).insertBefore(this.__activeItem,this.__activeItem.previousElementSibling);break;case"down":null!==this.__activeItem.nextElementSibling&&dom(this).insertBefore(this.__activeItem.nextElementSibling,this.__activeItem);break;case"left":1<parseInt(d[1])&&(this.__activeItem.setAttribute("slot","col-"+(parseInt(d[1])-1)),dom(this).appendChild(this.__activeItem));break;case"right":parseInt(d[1])<f&&(this.__activeItem.setAttribute("slot","col-"+(parseInt(d[1])+1)),dom(this).appendChild(this.__activeItem));}setTimeout(()=>{this.positionArrows(this.__activeItem),this.__activeItem.focus()},100)},_activeItemChanged:function(a,b){typeof a!=="undefined"&&null!=a?(a.classList.add("active-item"),this.positionArrows(a)):null==a&&this.positionArrows(a),typeof b!=="undefined"&&null!=b&&(b.classList.remove("active-item"),b.blur())},setActiveElement:function(a){var b=dom(a),c=b.localTarget;this.$.up.focus(),a.preventDefault(),a.stopPropagation()},_focusIn:function(a){if(this.editMode){var b=dom(a),c=b.localTarget;dom(c).parentNode===this&&(this.__activeItem=c)}},_focusOut:function(a){if(this.editMode){var b=dom(a),c=b.localTarget;c.parentNode!==this&&document.activeElement.parentNode!==this&&document.activeElement!==this}},positionArrows:function(a){if(null==a)this.$.up.classList.remove("active"),this.$.down.classList.remove("active"),this.$.left.classList.remove("active"),this.$.right.classList.remove("active");else{this.$.up.classList.add("active"),this.$.down.classList.add("active"),this.$.left.classList.add("active"),this.$.right.classList.add("active"),this.$.up.disabled=!1,this.$.down.disabled=!1,this.$.left.disabled=!1,this.$.right.disabled=!1;let c=this.getBoundingClientRect(),d=a.getBoundingClientRect(),f=d.top-c.top,g=d.left-c.left;this.$.up.style.top=f-20+"px",this.$.down.style.top=f+d.height+"px",this.$.left.style.top=f+d.height/2+"px",this.$.right.style.top=f+d.height/2+"px",this.$.up.style.left=g+d.width/2-10+"px",this.$.down.style.left=g+d.width/2-10+"px",this.$.left.style.left=g-20+"px",this.$.right.style.left=g+d.width+"px";let h=a.getAttribute("slot").split("-"),k=1,l=[1,2,3,4];for(var b in l)this["hideCol"+l[b]]||(k=l[b]);null===a.previousElementSibling&&(this.$.up.disabled=!0),null===a.nextElementSibling&&(this.$.down.disabled=!0),1===parseInt(h[1])&&(this.$.left.disabled=!0),parseInt(h[1])===k&&(this.$.right.disabled=!0)}},_editModeChanged:function(a,b){let c=dom(this).getEffectiveChildNodes();if("object"===typeof c)if(a&&!b){for(var d in c)"undefined"!==typeof c[d].tagName&&(c[d].addEventListener("drop",this.dropEvent.bind(this)),c[d].addEventListener("dragstart",this.dragStart.bind(this)),c[d].addEventListener("dragend",this.dragEnd.bind(this)),c[d].addEventListener("dragover",function(f){f.preventDefault()}),c[d].setAttribute("draggable",!0),c[d].setAttribute("data-draggable",!0),c[d].setAttribute("tabindex",0));async.microTask.run(()=>{let f=[1,2,3,4];for(var g in f)this["hideCol"+f[g]]||(this.shadowRoot.querySelector("#col"+f[g]).addEventListener("drop",this.dropEvent.bind(this)),this.shadowRoot.querySelector("#col"+f[g]).addEventListener("dragstart",this.dragStart.bind(this)),this.shadowRoot.querySelector("#col"+f[g]).addEventListener("dragend",this.dragEnd.bind(this)),this.shadowRoot.querySelector("#col"+f[g]).addEventListener("dragover",function(h){h.preventDefault()}),this.shadowRoot.querySelector("#col"+f[g]).setAttribute("data-draggable",!0))})}else if(!a&&b){for(var d in c)"undefined"!==typeof c[d].tagName&&(c[d].removeEventListener("drop",this.dropEvent.bind(this)),c[d].removeEventListener("dragstart",this.dragStart.bind(this)),c[d].removeEventListener("dragend",this.dragEnd.bind(this)),c[d].removeEventListener("dragover",function(f){f.preventDefault()}),c[d].removeAttribute("draggable"),c[d].removeAttribute("data-draggable"),c[d].removeAttribute("tabindex"));async.microTask.run(()=>{let f=[1,2,3,4];for(var g in f)this["hideCol"+f[g]]||(this.shadowRoot.querySelector("#col"+f[g]).removeEventListener("drop",this.dropEvent.bind(this)),this.shadowRoot.querySelector("#col"+f[g]).removeEventListener("dragstart",this.dragStart.bind(this)),this.shadowRoot.querySelector("#col"+f[g]).removeEventListener("dragend",this.dragEnd.bind(this)),this.shadowRoot.querySelector("#col"+f[g]).removeEventListener("dragover",function(h){h.preventDefault()}),this.shadowRoot.querySelector("#col"+f[g]).removeAttribute("data-draggable"))})}},dropEvent:function(a){var b=dom(a),c=b.localTarget;if(typeof this.__activeItem!=="undefined"&&typeof c!=="undefined"&&null!=c.getAttribute("slot")&&this.__activeItem!==c)this.__activeItem.setAttribute("slot",c.getAttribute("slot")),dom(this).insertBefore(this.__activeItem,c),a.preventDefault(),a.stopPropagation();else if("RESPONSIVE-GRID-COL"===c.tagName){var d=c.id.replace("col","");this.__activeItem.setAttribute("slot","col-"+d),dom(this).appendChild(this.__activeItem),a.preventDefault(),a.stopPropagation()}let f=dom(this).children;for(var g in f)"undefined"!==typeof f[g].classList&&f[g].classList.remove("mover");let h=[1,2,3,4];for(var k in h)this["hideCol"+h[k]]||this.shadowRoot.querySelector("#col"+h[k]).classList.remove("mover");setTimeout(()=>{this.positionArrows(this.__activeItem),this.__activeItem.focus()},100)},_colorCreation:function(a,b,c,d,f){let g=a.split("/"),h=[b,c,d,f];for(var k in h)""!=h[k]&&(g[k]=h[k]);return g},dragStart:function(){let b=dom(this).children;for(var c in b)"undefined"!==typeof b[c].classList&&b[c].classList.add("mover");let d=[1,2,3,4];for(var f in d)this["hideCol"+d[f]]||this.shadowRoot.querySelector("#col"+d[f]).classList.add("mover")},dragEnd:function(){let b=dom(this).children;for(var c in b)"undefined"!==typeof b[c].classList&&b[c].classList.remove("mover");let d=[1,2,3,4];for(var f in d)this["hideCol"+d[f]]||this.shadowRoot.querySelector("#col"+d[f]).classList.remove("mover")},splitColor:function(a){return""!=a&&"undefined"!==typeof SimpleColors.colors[a]?SimpleColors.colors[a][0]:a},_colColors:function(a){if(""!=a)for(var c in a)this["__col"+(parseInt(c)+1)+"Color"]=this.splitColor(a[c])},_layoutChanged:function(a){let b=a.split("/");switch(this.__colCount=b.length,b.length){case 1:this.hideCol1=!1,this.hideCol2=!0,this.hideCol3=!0,this.hideCol4=!0;break;case 2:this.hideCol1=!1,this.hideCol2=!1,this.hideCol3=!0,this.hideCol4=!0;break;case 3:this.hideCol1=!1,this.hideCol2=!1,this.hideCol3=!1,this.hideCol4=!0;break;case 4:this.hideCol1=!1,this.hideCol2=!1,this.hideCol3=!1,this.hideCol4=!1;}for(var c in b){let d=+c+1;this["col"+d+"_xl"]=b[c],this["col"+d+"_lg"]=b[c],this["col"+d+"_md"]=b[c],this["col"+d+"_sm"]=b[c],this["col"+d+"_xs"]=b[c]}},attached:function(){document.body.addEventListener("hax-store-property-updated",this._haxStorePropertyUpdated.bind(this)),document.body.addEventListener("hax-insert-content",this.haxInsertContent.bind(this));var a=[];for(var b in SimpleColors.colors)a[b]=b;this.setHaxProperties({canScale:!0,canPosition:!0,canEditSource:!1,settings:{quick:[],configure:[{property:"layout",title:"Layout",description:"Style to present these items",inputMethod:"select",options:{12:"1 col, full width","8/4":"2 cols, 66% / 33% split","6/6":"2 cols, 50% split","4/8":"2 cols, 33% / 66% split","4/4/4":"3 cols, 33% each","3/3/3/3":"4 cols, 25% each"}},{property:"col1Color",title:"Col 1 color",description:"Color for the 1st column",inputMethod:"select",options:a},{property:"col2Color",title:"Col 2 color",description:"Color for the 1st column",inputMethod:"select",options:a},{property:"col3Color",title:"Col 3 color",description:"Color for the 1st column",inputMethod:"select",options:a},{property:"col4Color",title:"Col 4 color",description:"Color for the 1st column",inputMethod:"select",options:a}],advanced:[]},saveOptions:{unsetAttributes:["__active-item","_colors","edit-mode"]}})},haxInsertContent:function(){this===window.HaxStore.instance.activeContainerNode&&(this.editMode=!1,setTimeout(()=>{this.editMode=!0,this.positionArrows(this.__activeItem),this.__activeItem.focus()},250))},_haxStorePropertyUpdated:function(a){a.detail&&typeof a.detail.value!=="undefined"&&a.detail.property&&("object"===typeof a.detail.value&&this.set(a.detail.property,null),this.set(a.detail.property,a.detail.value))}});export{GridPlate};