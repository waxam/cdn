/**
@license
Copyright (c) 2017 Vaadin Ltd.
This program is available under Apache License Version 2.0, available at https://vaadin.com/license/
*/
import{microTask as r}from"../../../@polymer/polymer/lib/utils/async.js";import{PolymerElement as t}from"../../../@polymer/polymer/polymer-element.js";export const SortMixin=e=>class SortMixin extends e{static get properties(){return{multiSort:{type:Boolean,value:!1},_sorters:{type:Array,value:function(){return[]}},_previousSorters:{type:Array,value:function(){return[]}}}}ready(){super.ready(),this.addEventListener("sorter-changed",this._onSorterChanged),window.ShadyDOM&&r.run(()=>{const r=this.querySelectorAll("vaadin-grid-sorter");Array.from(r).forEach(r=>{r instanceof t&&r.dispatchEvent(new CustomEvent("sorter-changed",{bubbles:!0,composed:!0}))})})}_onSorterChanged(r){const t=r.target;this._removeArrayItem(this._sorters,t),t._order=null,this.multiSort?(t.direction&&this._sorters.unshift(t),this._sorters.forEach((r,t)=>r._order=this._sorters.length>1?t:null,this)):t.direction&&(this._sorters.forEach(r=>{r._order=null,r.direction=null}),this._sorters=[t]),r.stopPropagation(),this.dataProvider&&JSON.stringify(this._previousSorters)!==JSON.stringify(this._mapSorters())&&this.clearCache(),this._a11yUpdateSorters(),this._previousSorters=this._mapSorters()}_mapSorters(){return this._sorters.map(r=>({path:r.path,direction:r.direction}))}_removeArrayItem(r,t){const e=r.indexOf(t);e>-1&&r.splice(e,1)}};